import{p as Rf}from"./vendor-CPbBpuJ6.js";var dl={},hs={};hs.byteLength=Pf;hs.toByteArray=kf;hs.fromByteArray=Of;var lt=[],Ye=[],Sf=typeof Uint8Array<"u"?Uint8Array:Array,to="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Fn=0,bf=to.length;Fn<bf;++Fn)lt[Fn]=to[Fn],Ye[to.charCodeAt(Fn)]=Fn;Ye[45]=62;Ye[95]=63;function fl(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var r=t===e?0:4-t%4;return[t,r]}function Pf(n){var e=fl(n),t=e[0],r=e[1];return(t+r)*3/4-r}function Cf(n,e,t){return(e+t)*3/4-t}function kf(n){var e,t=fl(n),r=t[0],i=t[1],s=new Sf(Cf(n,r,i)),a=0,c=i>0?r-4:r,h;for(h=0;h<c;h+=4)e=Ye[n.charCodeAt(h)]<<18|Ye[n.charCodeAt(h+1)]<<12|Ye[n.charCodeAt(h+2)]<<6|Ye[n.charCodeAt(h+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=e&255;return i===2&&(e=Ye[n.charCodeAt(h)]<<2|Ye[n.charCodeAt(h+1)]>>4,s[a++]=e&255),i===1&&(e=Ye[n.charCodeAt(h)]<<10|Ye[n.charCodeAt(h+1)]<<4|Ye[n.charCodeAt(h+2)]>>2,s[a++]=e>>8&255,s[a++]=e&255),s}function Nf(n){return lt[n>>18&63]+lt[n>>12&63]+lt[n>>6&63]+lt[n&63]}function Df(n,e,t){for(var r,i=[],s=e;s<t;s+=3)r=(n[s]<<16&16711680)+(n[s+1]<<8&65280)+(n[s+2]&255),i.push(Nf(r));return i.join("")}function Of(n){for(var e,t=n.length,r=t%3,i=[],s=16383,a=0,c=t-r;a<c;a+=s)i.push(Df(n,a,a+s>c?c:a+s));return r===1?(e=n[t-1],i.push(lt[e>>2]+lt[e<<4&63]+"==")):r===2&&(e=(n[t-2]<<8)+n[t-1],i.push(lt[e>>10]+lt[e>>4&63]+lt[e<<2&63]+"=")),i.join("")}var qo={};qo.read=function(n,e,t,r,i){var s,a,c=i*8-r-1,h=(1<<c)-1,m=h>>1,p=-7,v=t?i-1:0,I=t?-1:1,N=n[e+v];for(v+=I,s=N&(1<<-p)-1,N>>=-p,p+=c;p>0;s=s*256+n[e+v],v+=I,p-=8);for(a=s&(1<<-p)-1,s>>=-p,p+=r;p>0;a=a*256+n[e+v],v+=I,p-=8);if(s===0)s=1-m;else{if(s===h)return a?NaN:(N?-1:1)*(1/0);a=a+Math.pow(2,r),s=s-m}return(N?-1:1)*a*Math.pow(2,s-r)};qo.write=function(n,e,t,r,i,s){var a,c,h,m=s*8-i-1,p=(1<<m)-1,v=p>>1,I=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,N=r?0:s-1,L=r?1:-1,F=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,a=p):(a=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-a))<1&&(a--,h*=2),a+v>=1?e+=I/h:e+=I*Math.pow(2,1-v),e*h>=2&&(a++,h/=2),a+v>=p?(c=0,a=p):a+v>=1?(c=(e*h-1)*Math.pow(2,i),a=a+v):(c=e*Math.pow(2,v-1)*Math.pow(2,i),a=0));i>=8;n[t+N]=c&255,N+=L,c/=256,i-=8);for(a=a<<i|c,m+=i;m>0;n[t+N]=a&255,N+=L,a/=256,m-=8);n[t+N-L]|=F*128};(function(n){const e=hs,t=qo,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=p,n.SlowBuffer=Ae,n.INSPECT_MAX_BYTES=50;const i=2147483647;n.kMaxLength=i;const{Uint8Array:s,ArrayBuffer:a,SharedArrayBuffer:c}=globalThis;p.TYPED_ARRAY_SUPPORT=h(),!p.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function h(){try{const g=new s(1),l={foo:function(){return 42}};return Object.setPrototypeOf(l,s.prototype),Object.setPrototypeOf(g,l),g.foo()===42}catch{return!1}}Object.defineProperty(p.prototype,"parent",{enumerable:!0,get:function(){if(p.isBuffer(this))return this.buffer}}),Object.defineProperty(p.prototype,"offset",{enumerable:!0,get:function(){if(p.isBuffer(this))return this.byteOffset}});function m(g){if(g>i)throw new RangeError('The value "'+g+'" is invalid for option "size"');const l=new s(g);return Object.setPrototypeOf(l,p.prototype),l}function p(g,l,d){if(typeof g=="number"){if(typeof l=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return L(g)}return v(g,l,d)}p.poolSize=8192;function v(g,l,d){if(typeof g=="string")return F(g,l);if(a.isView(g))return Q(g);if(g==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g);if(We(g,a)||g&&We(g.buffer,a)||typeof c<"u"&&(We(g,c)||g&&We(g.buffer,c)))return q(g,l,d);if(typeof g=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const y=g.valueOf&&g.valueOf();if(y!=null&&y!==g)return p.from(y,l,d);const A=H(g);if(A)return A;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof g[Symbol.toPrimitive]=="function")return p.from(g[Symbol.toPrimitive]("string"),l,d);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g)}p.from=function(g,l,d){return v(g,l,d)},Object.setPrototypeOf(p.prototype,s.prototype),Object.setPrototypeOf(p,s);function I(g){if(typeof g!="number")throw new TypeError('"size" argument must be of type number');if(g<0)throw new RangeError('The value "'+g+'" is invalid for option "size"')}function N(g,l,d){return I(g),g<=0?m(g):l!==void 0?typeof d=="string"?m(g).fill(l,d):m(g).fill(l):m(g)}p.alloc=function(g,l,d){return N(g,l,d)};function L(g){return I(g),m(g<0?0:J(g)|0)}p.allocUnsafe=function(g){return L(g)},p.allocUnsafeSlow=function(g){return L(g)};function F(g,l){if((typeof l!="string"||l==="")&&(l="utf8"),!p.isEncoding(l))throw new TypeError("Unknown encoding: "+l);const d=se(g,l)|0;let y=m(d);const A=y.write(g,l);return A!==d&&(y=y.slice(0,A)),y}function x(g){const l=g.length<0?0:J(g.length)|0,d=m(l);for(let y=0;y<l;y+=1)d[y]=g[y]&255;return d}function Q(g){if(We(g,s)){const l=new s(g);return q(l.buffer,l.byteOffset,l.byteLength)}return x(g)}function q(g,l,d){if(l<0||g.byteLength<l)throw new RangeError('"offset" is outside of buffer bounds');if(g.byteLength<l+(d||0))throw new RangeError('"length" is outside of buffer bounds');let y;return l===void 0&&d===void 0?y=new s(g):d===void 0?y=new s(g,l):y=new s(g,l,d),Object.setPrototypeOf(y,p.prototype),y}function H(g){if(p.isBuffer(g)){const l=J(g.length)|0,d=m(l);return d.length===0||g.copy(d,0,0,l),d}if(g.length!==void 0)return typeof g.length!="number"||Te(g.length)?m(0):x(g);if(g.type==="Buffer"&&Array.isArray(g.data))return x(g.data)}function J(g){if(g>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return g|0}function Ae(g){return+g!=g&&(g=0),p.alloc(+g)}p.isBuffer=function(l){return l!=null&&l._isBuffer===!0&&l!==p.prototype},p.compare=function(l,d){if(We(l,s)&&(l=p.from(l,l.offset,l.byteLength)),We(d,s)&&(d=p.from(d,d.offset,d.byteLength)),!p.isBuffer(l)||!p.isBuffer(d))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(l===d)return 0;let y=l.length,A=d.length;for(let k=0,O=Math.min(y,A);k<O;++k)if(l[k]!==d[k]){y=l[k],A=d[k];break}return y<A?-1:A<y?1:0},p.isEncoding=function(l){switch(String(l).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},p.concat=function(l,d){if(!Array.isArray(l))throw new TypeError('"list" argument must be an Array of Buffers');if(l.length===0)return p.alloc(0);let y;if(d===void 0)for(d=0,y=0;y<l.length;++y)d+=l[y].length;const A=p.allocUnsafe(d);let k=0;for(y=0;y<l.length;++y){let O=l[y];if(We(O,s))k+O.length>A.length?(p.isBuffer(O)||(O=p.from(O)),O.copy(A,k)):s.prototype.set.call(A,O,k);else if(p.isBuffer(O))O.copy(A,k);else throw new TypeError('"list" argument must be an Array of Buffers');k+=O.length}return A};function se(g,l){if(p.isBuffer(g))return g.length;if(a.isView(g)||We(g,a))return g.byteLength;if(typeof g!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof g);const d=g.length,y=arguments.length>2&&arguments[2]===!0;if(!y&&d===0)return 0;let A=!1;for(;;)switch(l){case"ascii":case"latin1":case"binary":return d;case"utf8":case"utf-8":return pn(g).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return d*2;case"hex":return d>>>1;case"base64":return Vn(g).length;default:if(A)return y?-1:pn(g).length;l=(""+l).toLowerCase(),A=!0}}p.byteLength=se;function S(g,l,d){let y=!1;if((l===void 0||l<0)&&(l=0),l>this.length||((d===void 0||d>this.length)&&(d=this.length),d<=0)||(d>>>=0,l>>>=0,d<=l))return"";for(g||(g="utf8");;)switch(g){case"hex":return ct(this,l,d);case"utf8":case"utf-8":return Ot(this,l,d);case"ascii":return ri(this,l,d);case"latin1":case"binary":return Us(this,l,d);case"base64":return xs(this,l,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Pe(this,l,d);default:if(y)throw new TypeError("Unknown encoding: "+g);g=(g+"").toLowerCase(),y=!0}}p.prototype._isBuffer=!0;function E(g,l,d){const y=g[l];g[l]=g[d],g[d]=y}p.prototype.swap16=function(){const l=this.length;if(l%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let d=0;d<l;d+=2)E(this,d,d+1);return this},p.prototype.swap32=function(){const l=this.length;if(l%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let d=0;d<l;d+=4)E(this,d,d+3),E(this,d+1,d+2);return this},p.prototype.swap64=function(){const l=this.length;if(l%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let d=0;d<l;d+=8)E(this,d,d+7),E(this,d+1,d+6),E(this,d+2,d+5),E(this,d+3,d+4);return this},p.prototype.toString=function(){const l=this.length;return l===0?"":arguments.length===0?Ot(this,0,l):S.apply(this,arguments)},p.prototype.toLocaleString=p.prototype.toString,p.prototype.equals=function(l){if(!p.isBuffer(l))throw new TypeError("Argument must be a Buffer");return this===l?!0:p.compare(this,l)===0},p.prototype.inspect=function(){let l="";const d=n.INSPECT_MAX_BYTES;return l=this.toString("hex",0,d).replace(/(.{2})/g,"$1 ").trim(),this.length>d&&(l+=" ... "),"<Buffer "+l+">"},r&&(p.prototype[r]=p.prototype.inspect),p.prototype.compare=function(l,d,y,A,k){if(We(l,s)&&(l=p.from(l,l.offset,l.byteLength)),!p.isBuffer(l))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof l);if(d===void 0&&(d=0),y===void 0&&(y=l?l.length:0),A===void 0&&(A=0),k===void 0&&(k=this.length),d<0||y>l.length||A<0||k>this.length)throw new RangeError("out of range index");if(A>=k&&d>=y)return 0;if(A>=k)return-1;if(d>=y)return 1;if(d>>>=0,y>>>=0,A>>>=0,k>>>=0,this===l)return 0;let O=k-A,X=y-d;const ce=Math.min(O,X),oe=this.slice(A,k),ue=l.slice(d,y);for(let ne=0;ne<ce;++ne)if(oe[ne]!==ue[ne]){O=oe[ne],X=ue[ne];break}return O<X?-1:X<O?1:0};function T(g,l,d,y,A){if(g.length===0)return-1;if(typeof d=="string"?(y=d,d=0):d>2147483647?d=2147483647:d<-2147483648&&(d=-2147483648),d=+d,Te(d)&&(d=A?0:g.length-1),d<0&&(d=g.length+d),d>=g.length){if(A)return-1;d=g.length-1}else if(d<0)if(A)d=0;else return-1;if(typeof l=="string"&&(l=p.from(l,y)),p.isBuffer(l))return l.length===0?-1:R(g,l,d,y,A);if(typeof l=="number")return l=l&255,typeof s.prototype.indexOf=="function"?A?s.prototype.indexOf.call(g,l,d):s.prototype.lastIndexOf.call(g,l,d):R(g,[l],d,y,A);throw new TypeError("val must be string, number or Buffer")}function R(g,l,d,y,A){let k=1,O=g.length,X=l.length;if(y!==void 0&&(y=String(y).toLowerCase(),y==="ucs2"||y==="ucs-2"||y==="utf16le"||y==="utf-16le")){if(g.length<2||l.length<2)return-1;k=2,O/=2,X/=2,d/=2}function ce(ue,ne){return k===1?ue[ne]:ue.readUInt16BE(ne*k)}let oe;if(A){let ue=-1;for(oe=d;oe<O;oe++)if(ce(g,oe)===ce(l,ue===-1?0:oe-ue)){if(ue===-1&&(ue=oe),oe-ue+1===X)return ue*k}else ue!==-1&&(oe-=oe-ue),ue=-1}else for(d+X>O&&(d=O-X),oe=d;oe>=0;oe--){let ue=!0;for(let ne=0;ne<X;ne++)if(ce(g,oe+ne)!==ce(l,ne)){ue=!1;break}if(ue)return oe}return-1}p.prototype.includes=function(l,d,y){return this.indexOf(l,d,y)!==-1},p.prototype.indexOf=function(l,d,y){return T(this,l,d,y,!0)},p.prototype.lastIndexOf=function(l,d,y){return T(this,l,d,y,!1)};function b(g,l,d,y){d=Number(d)||0;const A=g.length-d;y?(y=Number(y),y>A&&(y=A)):y=A;const k=l.length;y>k/2&&(y=k/2);let O;for(O=0;O<y;++O){const X=parseInt(l.substr(O*2,2),16);if(Te(X))return O;g[d+O]=X}return O}function C(g,l,d,y){return Lt(pn(l,g.length-d),g,d,y)}function w(g,l,d,y){return Lt(ci(l),g,d,y)}function tt(g,l,d,y){return Lt(Vn(l),g,d,y)}function un(g,l,d,y){return Lt(Bs(l,g.length-d),g,d,y)}p.prototype.write=function(l,d,y,A){if(d===void 0)A="utf8",y=this.length,d=0;else if(y===void 0&&typeof d=="string")A=d,y=this.length,d=0;else if(isFinite(d))d=d>>>0,isFinite(y)?(y=y>>>0,A===void 0&&(A="utf8")):(A=y,y=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const k=this.length-d;if((y===void 0||y>k)&&(y=k),l.length>0&&(y<0||d<0)||d>this.length)throw new RangeError("Attempt to write outside buffer bounds");A||(A="utf8");let O=!1;for(;;)switch(A){case"hex":return b(this,l,d,y);case"utf8":case"utf-8":return C(this,l,d,y);case"ascii":case"latin1":case"binary":return w(this,l,d,y);case"base64":return tt(this,l,d,y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return un(this,l,d,y);default:if(O)throw new TypeError("Unknown encoding: "+A);A=(""+A).toLowerCase(),O=!0}},p.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function xs(g,l,d){return l===0&&d===g.length?e.fromByteArray(g):e.fromByteArray(g.slice(l,d))}function Ot(g,l,d){d=Math.min(g.length,d);const y=[];let A=l;for(;A<d;){const k=g[A];let O=null,X=k>239?4:k>223?3:k>191?2:1;if(A+X<=d){let ce,oe,ue,ne;switch(X){case 1:k<128&&(O=k);break;case 2:ce=g[A+1],(ce&192)===128&&(ne=(k&31)<<6|ce&63,ne>127&&(O=ne));break;case 3:ce=g[A+1],oe=g[A+2],(ce&192)===128&&(oe&192)===128&&(ne=(k&15)<<12|(ce&63)<<6|oe&63,ne>2047&&(ne<55296||ne>57343)&&(O=ne));break;case 4:ce=g[A+1],oe=g[A+2],ue=g[A+3],(ce&192)===128&&(oe&192)===128&&(ue&192)===128&&(ne=(k&15)<<18|(ce&63)<<12|(oe&63)<<6|ue&63,ne>65535&&ne<1114112&&(O=ne))}}O===null?(O=65533,X=1):O>65535&&(O-=65536,y.push(O>>>10&1023|55296),O=56320|O&1023),y.push(O),A+=X}return lr(y)}const Vt=4096;function lr(g){const l=g.length;if(l<=Vt)return String.fromCharCode.apply(String,g);let d="",y=0;for(;y<l;)d+=String.fromCharCode.apply(String,g.slice(y,y+=Vt));return d}function ri(g,l,d){let y="";d=Math.min(g.length,d);for(let A=l;A<d;++A)y+=String.fromCharCode(g[A]&127);return y}function Us(g,l,d){let y="";d=Math.min(g.length,d);for(let A=l;A<d;++A)y+=String.fromCharCode(g[A]);return y}function ct(g,l,d){const y=g.length;(!l||l<0)&&(l=0),(!d||d<0||d>y)&&(d=y);let A="";for(let k=l;k<d;++k)A+=ke[g[k]];return A}function Pe(g,l,d){const y=g.slice(l,d);let A="";for(let k=0;k<y.length-1;k+=2)A+=String.fromCharCode(y[k]+y[k+1]*256);return A}p.prototype.slice=function(l,d){const y=this.length;l=~~l,d=d===void 0?y:~~d,l<0?(l+=y,l<0&&(l=0)):l>y&&(l=y),d<0?(d+=y,d<0&&(d=0)):d>y&&(d=y),d<l&&(d=l);const A=this.subarray(l,d);return Object.setPrototypeOf(A,p.prototype),A};function Ee(g,l,d){if(g%1!==0||g<0)throw new RangeError("offset is not uint");if(g+l>d)throw new RangeError("Trying to access beyond buffer length")}p.prototype.readUintLE=p.prototype.readUIntLE=function(l,d,y){l=l>>>0,d=d>>>0,y||Ee(l,d,this.length);let A=this[l],k=1,O=0;for(;++O<d&&(k*=256);)A+=this[l+O]*k;return A},p.prototype.readUintBE=p.prototype.readUIntBE=function(l,d,y){l=l>>>0,d=d>>>0,y||Ee(l,d,this.length);let A=this[l+--d],k=1;for(;d>0&&(k*=256);)A+=this[l+--d]*k;return A},p.prototype.readUint8=p.prototype.readUInt8=function(l,d){return l=l>>>0,d||Ee(l,1,this.length),this[l]},p.prototype.readUint16LE=p.prototype.readUInt16LE=function(l,d){return l=l>>>0,d||Ee(l,2,this.length),this[l]|this[l+1]<<8},p.prototype.readUint16BE=p.prototype.readUInt16BE=function(l,d){return l=l>>>0,d||Ee(l,2,this.length),this[l]<<8|this[l+1]},p.prototype.readUint32LE=p.prototype.readUInt32LE=function(l,d){return l=l>>>0,d||Ee(l,4,this.length),(this[l]|this[l+1]<<8|this[l+2]<<16)+this[l+3]*16777216},p.prototype.readUint32BE=p.prototype.readUInt32BE=function(l,d){return l=l>>>0,d||Ee(l,4,this.length),this[l]*16777216+(this[l+1]<<16|this[l+2]<<8|this[l+3])},p.prototype.readBigUInt64LE=Ge(function(l){l=l>>>0,vt(l,"offset");const d=this[l],y=this[l+7];(d===void 0||y===void 0)&&fn(l,this.length-8);const A=d+this[++l]*2**8+this[++l]*2**16+this[++l]*2**24,k=this[++l]+this[++l]*2**8+this[++l]*2**16+y*2**24;return BigInt(A)+(BigInt(k)<<BigInt(32))}),p.prototype.readBigUInt64BE=Ge(function(l){l=l>>>0,vt(l,"offset");const d=this[l],y=this[l+7];(d===void 0||y===void 0)&&fn(l,this.length-8);const A=d*2**24+this[++l]*2**16+this[++l]*2**8+this[++l],k=this[++l]*2**24+this[++l]*2**16+this[++l]*2**8+y;return(BigInt(A)<<BigInt(32))+BigInt(k)}),p.prototype.readIntLE=function(l,d,y){l=l>>>0,d=d>>>0,y||Ee(l,d,this.length);let A=this[l],k=1,O=0;for(;++O<d&&(k*=256);)A+=this[l+O]*k;return k*=128,A>=k&&(A-=Math.pow(2,8*d)),A},p.prototype.readIntBE=function(l,d,y){l=l>>>0,d=d>>>0,y||Ee(l,d,this.length);let A=d,k=1,O=this[l+--A];for(;A>0&&(k*=256);)O+=this[l+--A]*k;return k*=128,O>=k&&(O-=Math.pow(2,8*d)),O},p.prototype.readInt8=function(l,d){return l=l>>>0,d||Ee(l,1,this.length),this[l]&128?(255-this[l]+1)*-1:this[l]},p.prototype.readInt16LE=function(l,d){l=l>>>0,d||Ee(l,2,this.length);const y=this[l]|this[l+1]<<8;return y&32768?y|4294901760:y},p.prototype.readInt16BE=function(l,d){l=l>>>0,d||Ee(l,2,this.length);const y=this[l+1]|this[l]<<8;return y&32768?y|4294901760:y},p.prototype.readInt32LE=function(l,d){return l=l>>>0,d||Ee(l,4,this.length),this[l]|this[l+1]<<8|this[l+2]<<16|this[l+3]<<24},p.prototype.readInt32BE=function(l,d){return l=l>>>0,d||Ee(l,4,this.length),this[l]<<24|this[l+1]<<16|this[l+2]<<8|this[l+3]},p.prototype.readBigInt64LE=Ge(function(l){l=l>>>0,vt(l,"offset");const d=this[l],y=this[l+7];(d===void 0||y===void 0)&&fn(l,this.length-8);const A=this[l+4]+this[l+5]*2**8+this[l+6]*2**16+(y<<24);return(BigInt(A)<<BigInt(32))+BigInt(d+this[++l]*2**8+this[++l]*2**16+this[++l]*2**24)}),p.prototype.readBigInt64BE=Ge(function(l){l=l>>>0,vt(l,"offset");const d=this[l],y=this[l+7];(d===void 0||y===void 0)&&fn(l,this.length-8);const A=(d<<24)+this[++l]*2**16+this[++l]*2**8+this[++l];return(BigInt(A)<<BigInt(32))+BigInt(this[++l]*2**24+this[++l]*2**16+this[++l]*2**8+y)}),p.prototype.readFloatLE=function(l,d){return l=l>>>0,d||Ee(l,4,this.length),t.read(this,l,!0,23,4)},p.prototype.readFloatBE=function(l,d){return l=l>>>0,d||Ee(l,4,this.length),t.read(this,l,!1,23,4)},p.prototype.readDoubleLE=function(l,d){return l=l>>>0,d||Ee(l,8,this.length),t.read(this,l,!0,52,8)},p.prototype.readDoubleBE=function(l,d){return l=l>>>0,d||Ee(l,8,this.length),t.read(this,l,!1,52,8)};function ve(g,l,d,y,A,k){if(!p.isBuffer(g))throw new TypeError('"buffer" argument must be a Buffer instance');if(l>A||l<k)throw new RangeError('"value" argument is out of bounds');if(d+y>g.length)throw new RangeError("Index out of range")}p.prototype.writeUintLE=p.prototype.writeUIntLE=function(l,d,y,A){if(l=+l,d=d>>>0,y=y>>>0,!A){const X=Math.pow(2,8*y)-1;ve(this,l,d,y,X,0)}let k=1,O=0;for(this[d]=l&255;++O<y&&(k*=256);)this[d+O]=l/k&255;return d+y},p.prototype.writeUintBE=p.prototype.writeUIntBE=function(l,d,y,A){if(l=+l,d=d>>>0,y=y>>>0,!A){const X=Math.pow(2,8*y)-1;ve(this,l,d,y,X,0)}let k=y-1,O=1;for(this[d+k]=l&255;--k>=0&&(O*=256);)this[d+k]=l/O&255;return d+y},p.prototype.writeUint8=p.prototype.writeUInt8=function(l,d,y){return l=+l,d=d>>>0,y||ve(this,l,d,1,255,0),this[d]=l&255,d+1},p.prototype.writeUint16LE=p.prototype.writeUInt16LE=function(l,d,y){return l=+l,d=d>>>0,y||ve(this,l,d,2,65535,0),this[d]=l&255,this[d+1]=l>>>8,d+2},p.prototype.writeUint16BE=p.prototype.writeUInt16BE=function(l,d,y){return l=+l,d=d>>>0,y||ve(this,l,d,2,65535,0),this[d]=l>>>8,this[d+1]=l&255,d+2},p.prototype.writeUint32LE=p.prototype.writeUInt32LE=function(l,d,y){return l=+l,d=d>>>0,y||ve(this,l,d,4,4294967295,0),this[d+3]=l>>>24,this[d+2]=l>>>16,this[d+1]=l>>>8,this[d]=l&255,d+4},p.prototype.writeUint32BE=p.prototype.writeUInt32BE=function(l,d,y){return l=+l,d=d>>>0,y||ve(this,l,d,4,4294967295,0),this[d]=l>>>24,this[d+1]=l>>>16,this[d+2]=l>>>8,this[d+3]=l&255,d+4};function ii(g,l,d,y,A){On(l,y,A,g,d,7);let k=Number(l&BigInt(4294967295));g[d++]=k,k=k>>8,g[d++]=k,k=k>>8,g[d++]=k,k=k>>8,g[d++]=k;let O=Number(l>>BigInt(32)&BigInt(4294967295));return g[d++]=O,O=O>>8,g[d++]=O,O=O>>8,g[d++]=O,O=O>>8,g[d++]=O,d}function ln(g,l,d,y,A){On(l,y,A,g,d,7);let k=Number(l&BigInt(4294967295));g[d+7]=k,k=k>>8,g[d+6]=k,k=k>>8,g[d+5]=k,k=k>>8,g[d+4]=k;let O=Number(l>>BigInt(32)&BigInt(4294967295));return g[d+3]=O,O=O>>8,g[d+2]=O,O=O>>8,g[d+1]=O,O=O>>8,g[d]=O,d+8}p.prototype.writeBigUInt64LE=Ge(function(l,d=0){return ii(this,l,d,BigInt(0),BigInt("0xffffffffffffffff"))}),p.prototype.writeBigUInt64BE=Ge(function(l,d=0){return ln(this,l,d,BigInt(0),BigInt("0xffffffffffffffff"))}),p.prototype.writeIntLE=function(l,d,y,A){if(l=+l,d=d>>>0,!A){const ce=Math.pow(2,8*y-1);ve(this,l,d,y,ce-1,-ce)}let k=0,O=1,X=0;for(this[d]=l&255;++k<y&&(O*=256);)l<0&&X===0&&this[d+k-1]!==0&&(X=1),this[d+k]=(l/O>>0)-X&255;return d+y},p.prototype.writeIntBE=function(l,d,y,A){if(l=+l,d=d>>>0,!A){const ce=Math.pow(2,8*y-1);ve(this,l,d,y,ce-1,-ce)}let k=y-1,O=1,X=0;for(this[d+k]=l&255;--k>=0&&(O*=256);)l<0&&X===0&&this[d+k+1]!==0&&(X=1),this[d+k]=(l/O>>0)-X&255;return d+y},p.prototype.writeInt8=function(l,d,y){return l=+l,d=d>>>0,y||ve(this,l,d,1,127,-128),l<0&&(l=255+l+1),this[d]=l&255,d+1},p.prototype.writeInt16LE=function(l,d,y){return l=+l,d=d>>>0,y||ve(this,l,d,2,32767,-32768),this[d]=l&255,this[d+1]=l>>>8,d+2},p.prototype.writeInt16BE=function(l,d,y){return l=+l,d=d>>>0,y||ve(this,l,d,2,32767,-32768),this[d]=l>>>8,this[d+1]=l&255,d+2},p.prototype.writeInt32LE=function(l,d,y){return l=+l,d=d>>>0,y||ve(this,l,d,4,2147483647,-2147483648),this[d]=l&255,this[d+1]=l>>>8,this[d+2]=l>>>16,this[d+3]=l>>>24,d+4},p.prototype.writeInt32BE=function(l,d,y){return l=+l,d=d>>>0,y||ve(this,l,d,4,2147483647,-2147483648),l<0&&(l=4294967295+l+1),this[d]=l>>>24,this[d+1]=l>>>16,this[d+2]=l>>>8,this[d+3]=l&255,d+4},p.prototype.writeBigInt64LE=Ge(function(l,d=0){return ii(this,l,d,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),p.prototype.writeBigInt64BE=Ge(function(l,d=0){return ln(this,l,d,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function si(g,l,d,y,A,k){if(d+y>g.length)throw new RangeError("Index out of range");if(d<0)throw new RangeError("Index out of range")}function oi(g,l,d,y,A){return l=+l,d=d>>>0,A||si(g,l,d,4),t.write(g,l,d,y,23,4),d+4}p.prototype.writeFloatLE=function(l,d,y){return oi(this,l,d,!0,y)},p.prototype.writeFloatBE=function(l,d,y){return oi(this,l,d,!1,y)};function hn(g,l,d,y,A){return l=+l,d=d>>>0,A||si(g,l,d,8),t.write(g,l,d,y,52,8),d+8}p.prototype.writeDoubleLE=function(l,d,y){return hn(this,l,d,!0,y)},p.prototype.writeDoubleBE=function(l,d,y){return hn(this,l,d,!1,y)},p.prototype.copy=function(l,d,y,A){if(!p.isBuffer(l))throw new TypeError("argument should be a Buffer");if(y||(y=0),!A&&A!==0&&(A=this.length),d>=l.length&&(d=l.length),d||(d=0),A>0&&A<y&&(A=y),A===y||l.length===0||this.length===0)return 0;if(d<0)throw new RangeError("targetStart out of bounds");if(y<0||y>=this.length)throw new RangeError("Index out of range");if(A<0)throw new RangeError("sourceEnd out of bounds");A>this.length&&(A=this.length),l.length-d<A-y&&(A=l.length-d+y);const k=A-y;return this===l&&typeof s.prototype.copyWithin=="function"?this.copyWithin(d,y,A):s.prototype.set.call(l,this.subarray(y,A),d),k},p.prototype.fill=function(l,d,y,A){if(typeof l=="string"){if(typeof d=="string"?(A=d,d=0,y=this.length):typeof y=="string"&&(A=y,y=this.length),A!==void 0&&typeof A!="string")throw new TypeError("encoding must be a string");if(typeof A=="string"&&!p.isEncoding(A))throw new TypeError("Unknown encoding: "+A);if(l.length===1){const O=l.charCodeAt(0);(A==="utf8"&&O<128||A==="latin1")&&(l=O)}}else typeof l=="number"?l=l&255:typeof l=="boolean"&&(l=Number(l));if(d<0||this.length<d||this.length<y)throw new RangeError("Out of range index");if(y<=d)return this;d=d>>>0,y=y===void 0?this.length:y>>>0,l||(l=0);let k;if(typeof l=="number")for(k=d;k<y;++k)this[k]=l;else{const O=p.isBuffer(l)?l:p.from(l,A),X=O.length;if(X===0)throw new TypeError('The value "'+l+'" is invalid for argument "value"');for(k=0;k<y-d;++k)this[k+d]=O[k%X]}return this};const nt={};function dn(g,l,d){nt[g]=class extends d{constructor(){super(),Object.defineProperty(this,"message",{value:l.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${g}]`,this.stack,delete this.name}get code(){return g}set code(A){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:A,writable:!0})}toString(){return`${this.name} [${g}]: ${this.message}`}}}dn("ERR_BUFFER_OUT_OF_BOUNDS",function(g){return g?`${g} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),dn("ERR_INVALID_ARG_TYPE",function(g,l){return`The "${g}" argument must be of type number. Received type ${typeof l}`},TypeError),dn("ERR_OUT_OF_RANGE",function(g,l,d){let y=`The value of "${g}" is out of range.`,A=d;return Number.isInteger(d)&&Math.abs(d)>2**32?A=Dn(String(d)):typeof d=="bigint"&&(A=String(d),(d>BigInt(2)**BigInt(32)||d<-(BigInt(2)**BigInt(32)))&&(A=Dn(A)),A+="n"),y+=` It must be ${l}. Received ${A}`,y},RangeError);function Dn(g){let l="",d=g.length;const y=g[0]==="-"?1:0;for(;d>=y+4;d-=3)l=`_${g.slice(d-3,d)}${l}`;return`${g.slice(0,d)}${l}`}function hr(g,l,d){vt(l,"offset"),(g[l]===void 0||g[l+d]===void 0)&&fn(l,g.length-(d+1))}function On(g,l,d,y,A,k){if(g>d||g<l){const O=typeof l=="bigint"?"n":"";let X;throw l===0||l===BigInt(0)?X=`>= 0${O} and < 2${O} ** ${(k+1)*8}${O}`:X=`>= -(2${O} ** ${(k+1)*8-1}${O}) and < 2 ** ${(k+1)*8-1}${O}`,new nt.ERR_OUT_OF_RANGE("value",X,g)}hr(y,A,k)}function vt(g,l){if(typeof g!="number")throw new nt.ERR_INVALID_ARG_TYPE(l,"number",g)}function fn(g,l,d){throw Math.floor(g)!==g?(vt(g,d),new nt.ERR_OUT_OF_RANGE("offset","an integer",g)):l<0?new nt.ERR_BUFFER_OUT_OF_BOUNDS:new nt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${l}`,g)}const Fs=/[^+/0-9A-Za-z-_]/g;function ai(g){if(g=g.split("=")[0],g=g.trim().replace(Fs,""),g.length<2)return"";for(;g.length%4!==0;)g=g+"=";return g}function pn(g,l){l=l||1/0;let d;const y=g.length;let A=null;const k=[];for(let O=0;O<y;++O){if(d=g.charCodeAt(O),d>55295&&d<57344){if(!A){if(d>56319){(l-=3)>-1&&k.push(239,191,189);continue}else if(O+1===y){(l-=3)>-1&&k.push(239,191,189);continue}A=d;continue}if(d<56320){(l-=3)>-1&&k.push(239,191,189),A=d;continue}d=(A-55296<<10|d-56320)+65536}else A&&(l-=3)>-1&&k.push(239,191,189);if(A=null,d<128){if((l-=1)<0)break;k.push(d)}else if(d<2048){if((l-=2)<0)break;k.push(d>>6|192,d&63|128)}else if(d<65536){if((l-=3)<0)break;k.push(d>>12|224,d>>6&63|128,d&63|128)}else if(d<1114112){if((l-=4)<0)break;k.push(d>>18|240,d>>12&63|128,d>>6&63|128,d&63|128)}else throw new Error("Invalid code point")}return k}function ci(g){const l=[];for(let d=0;d<g.length;++d)l.push(g.charCodeAt(d)&255);return l}function Bs(g,l){let d,y,A;const k=[];for(let O=0;O<g.length&&!((l-=2)<0);++O)d=g.charCodeAt(O),y=d>>8,A=d%256,k.push(A),k.push(y);return k}function Vn(g){return e.toByteArray(ai(g))}function Lt(g,l,d,y){let A;for(A=0;A<y&&!(A+d>=l.length||A>=g.length);++A)l[A+d]=g[A];return A}function We(g,l){return g instanceof l||g!=null&&g.constructor!=null&&g.constructor.name!=null&&g.constructor.name===l.name}function Te(g){return g!==g}const ke=(function(){const g="0123456789abcdef",l=new Array(256);for(let d=0;d<16;++d){const y=d*16;for(let A=0;A<16;++A)l[y+A]=g[d]+g[A]}return l})();function Ge(g){return typeof BigInt>"u"?ui:g}function ui(){throw new Error("BigInt not supported")}})(dl);const Vf=dl.Buffer;function Ho(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function _w(n,e,t,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(a=n[c])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}function yw(n,e,t,r){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(p){try{m(r.next(p))}catch(v){a(v)}}function h(p){try{m(r.throw(p))}catch(v){a(v)}}function m(p){p.done?s(p.value):i(p.value).then(c,h)}m((r=r.apply(n,e||[])).next())})}const Lf=()=>{};var kc={};const pl=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Mf=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],c=n[t++],h=((i&7)<<18|(s&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},ml={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,c=a?n[i+1]:0,h=i+2<n.length,m=h?n[i+2]:0,p=s>>2,v=(s&3)<<4|c>>4;let I=(c&15)<<2|m>>6,N=m&63;h||(N=64,a||(I=64)),r.push(t[p],t[v],t[I],t[N])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(pl(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Mf(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;const m=i<n.length?t[n.charAt(i)]:64;++i;const v=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||m==null||v==null)throw new xf;const I=s<<2|c>>4;if(r.push(I),m!==64){const N=c<<4&240|m>>2;if(r.push(N),v!==64){const L=m<<6&192|v;r.push(L)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class xf extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Uf=function(n){const e=pl(n);return ml.encodeByteArray(e,!0)},qi=function(n){return Uf(n).replace(/\./g,"")},gl=function(n){try{return ml.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Ff(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof globalThis<"u")return globalThis;throw new Error("Unable to locate global object.")}const Bf=()=>Ff().__FIREBASE_DEFAULTS__,jf=()=>{if(typeof Rf>"u"||typeof kc>"u")return;const n=kc.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},$f=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&gl(n[1]);return e&&JSON.parse(e)},ds=()=>{try{return Lf()||Bf()||jf()||$f()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},_l=n=>{var e,t;return(t=(e=ds())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},zo=n=>{const e=_l(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},yl=()=>{var n;return(n=ds())===null||n===void 0?void 0:n.config},El=n=>{var e;return(e=ds())===null||e===void 0?void 0:e[`_${n}`]};class qf{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Dt(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function fs(n){return(await fetch(n,{credentials:"include"})).ok}function vl(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[qi(JSON.stringify(t)),qi(JSON.stringify(a)),""].join(".")}const kr={};function Hf(){const n={prod:[],emulator:[]};for(const e of Object.keys(kr))kr[e]?n.emulator.push(e):n.prod.push(e);return n}function zf(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Nc=!1;function ps(n,e){if(typeof window>"u"||typeof document>"u"||!Dt(window.location.host)||kr[n]===e||kr[n]||Nc)return;kr[n]=e;function t(I){return`__firebase__banner__${I}`}const r="__firebase__banner",s=Hf().prod.length>0;function a(){const I=document.getElementById(r);I&&I.remove()}function c(I){I.style.display="flex",I.style.background="#7faaf0",I.style.position="fixed",I.style.bottom="5px",I.style.left="5px",I.style.padding=".5em",I.style.borderRadius="5px",I.style.alignItems="center"}function h(I,N){I.setAttribute("width","24"),I.setAttribute("id",N),I.setAttribute("height","24"),I.setAttribute("viewBox","0 0 24 24"),I.setAttribute("fill","none"),I.style.marginLeft="-6px"}function m(){const I=document.createElement("span");return I.style.cursor="pointer",I.style.marginLeft="16px",I.style.fontSize="24px",I.innerHTML=" &times;",I.onclick=()=>{Nc=!0,a()},I}function p(I,N){I.setAttribute("id",N),I.innerText="Learn more",I.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",I.setAttribute("target","__blank"),I.style.paddingLeft="5px",I.style.textDecoration="underline"}function v(){const I=zf(r),N=t("text"),L=document.getElementById(N)||document.createElement("span"),F=t("learnmore"),x=document.getElementById(F)||document.createElement("a"),Q=t("preprendIcon"),q=document.getElementById(Q)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(I.created){const H=I.element;c(H),p(x,F);const J=m();h(q,Q),H.append(q,L,x,J),document.body.appendChild(H)}s?(L.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,L.innerText="Preview backend running in this workspace."),L.setAttribute("id",N)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function Be(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Wf(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Be())}function Gf(){var n;const e=(n=ds())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(globalThis.process)==="[object process]"}catch{return!1}}function Kf(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Qf(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Jf(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Xf(){const n=Be();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Yf(){return!Gf()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Zf(){try{return typeof indexedDB=="object"}catch{return!1}}function ep(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}const tp="FirebaseError";class at extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=tp,Object.setPrototypeOf(this,at.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Wr.prototype.create)}}class Wr{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?np(s,r):"Error",c=`${this.serviceName}: ${a} (${i}).`;return new at(i,c,r)}}function np(n,e){return n.replace(rp,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const rp=/\{\$([^}]+)}/g;function ip(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function In(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(Dc(s)&&Dc(a)){if(!In(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function Dc(n){return n!==null&&typeof n=="object"}function Gr(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ar(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Rr(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function sp(n,e){const t=new op(n,e);return t.subscribe.bind(t)}class op{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");ap(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=no),i.error===void 0&&(i.error=no),i.complete===void 0&&(i.complete=no);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ap(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function no(){}function fe(n){return n&&n._delegate?n._delegate:n}class St{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const En="[DEFAULT]";class cp{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new qf;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lp(e))try{this.getOrInitializeService({instanceIdentifier:En})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=En){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=En){return this.instances.has(e)}getOptions(e=En){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(s);r===c&&a.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:up(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=En){return this.component?this.component.multipleInstances?e:En:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function up(n){return n===En?void 0:n}function lp(n){return n.instantiationMode==="EAGER"}class hp{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new cp(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Z;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Z||(Z={}));const dp={debug:Z.DEBUG,verbose:Z.VERBOSE,info:Z.INFO,warn:Z.WARN,error:Z.ERROR,silent:Z.SILENT},fp=Z.INFO,pp={[Z.DEBUG]:"log",[Z.VERBOSE]:"log",[Z.INFO]:"info",[Z.WARN]:"warn",[Z.ERROR]:"error"},mp=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=pp[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Wo{constructor(e){this.name=e,this._logLevel=fp,this._logHandler=mp,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Z))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?dp[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Z.DEBUG,...e),this._logHandler(this,Z.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Z.VERBOSE,...e),this._logHandler(this,Z.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Z.INFO,...e),this._logHandler(this,Z.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Z.WARN,...e),this._logHandler(this,Z.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Z.ERROR,...e),this._logHandler(this,Z.ERROR,...e)}}const gp=(n,e)=>e.some(t=>n instanceof t);let Oc,Vc;function _p(){return Oc||(Oc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yp(){return Vc||(Vc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Tl=new WeakMap,go=new WeakMap,wl=new WeakMap,ro=new WeakMap,Go=new WeakMap;function Ep(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Wt(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Tl.set(t,n)}).catch(()=>{}),Go.set(e,n),e}function vp(n){if(go.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});go.set(n,e)}let _o={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return go.get(n);if(e==="objectStoreNames")return n.objectStoreNames||wl.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Wt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Tp(n){_o=n(_o)}function wp(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(io(this),e,...t);return wl.set(r,e.sort?e.sort():[e]),Wt(r)}:yp().includes(n)?function(...e){return n.apply(io(this),e),Wt(Tl.get(this))}:function(...e){return Wt(n.apply(io(this),e))}}function Ip(n){return typeof n=="function"?wp(n):(n instanceof IDBTransaction&&vp(n),gp(n,_p())?new Proxy(n,_o):n)}function Wt(n){if(n instanceof IDBRequest)return Ep(n);if(ro.has(n))return ro.get(n);const e=Ip(n);return e!==n&&(ro.set(n,e),Go.set(e,n)),e}const io=n=>Go.get(n);function Ap(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),c=Wt(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Wt(a.result),h.oldVersion,h.newVersion,Wt(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),c.then(h=>{s&&h.addEventListener("close",()=>s()),i&&h.addEventListener("versionchange",m=>i(m.oldVersion,m.newVersion,m))}).catch(()=>{}),c}const Rp=["get","getKey","getAll","getAllKeys","count"],Sp=["put","add","delete","clear"],so=new Map;function Lc(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(so.get(e))return so.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=Sp.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Rp.includes(t)))return;const s=async function(a,...c){const h=this.transaction(a,i?"readwrite":"readonly");let m=h.store;return r&&(m=m.index(c.shift())),(await Promise.all([m[t](...c),i&&h.done]))[0]};return so.set(e,s),s}Tp(n=>({...n,get:(e,t,r)=>Lc(e,t)||n.get(e,t,r),has:(e,t)=>!!Lc(e,t)||n.has(e,t)}));class bp{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Pp(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Pp(n){const e=n.getComponent();return e?.type==="VERSION"}const yo="@firebase/app",Mc="0.13.2";const bt=new Wo("@firebase/app"),Cp="@firebase/app-compat",kp="@firebase/analytics-compat",Np="@firebase/analytics",Dp="@firebase/app-check-compat",Op="@firebase/app-check",Vp="@firebase/auth",Lp="@firebase/auth-compat",Mp="@firebase/database",xp="@firebase/data-connect",Up="@firebase/database-compat",Fp="@firebase/functions",Bp="@firebase/functions-compat",jp="@firebase/installations",$p="@firebase/installations-compat",qp="@firebase/messaging",Hp="@firebase/messaging-compat",zp="@firebase/performance",Wp="@firebase/performance-compat",Gp="@firebase/remote-config",Kp="@firebase/remote-config-compat",Qp="@firebase/storage",Jp="@firebase/storage-compat",Xp="@firebase/firestore",Yp="@firebase/ai",Zp="@firebase/firestore-compat",em="firebase",tm="11.10.0";const Eo="[DEFAULT]",nm={[yo]:"fire-core",[Cp]:"fire-core-compat",[Np]:"fire-analytics",[kp]:"fire-analytics-compat",[Op]:"fire-app-check",[Dp]:"fire-app-check-compat",[Vp]:"fire-auth",[Lp]:"fire-auth-compat",[Mp]:"fire-rtdb",[xp]:"fire-data-connect",[Up]:"fire-rtdb-compat",[Fp]:"fire-fn",[Bp]:"fire-fn-compat",[jp]:"fire-iid",[$p]:"fire-iid-compat",[qp]:"fire-fcm",[Hp]:"fire-fcm-compat",[zp]:"fire-perf",[Wp]:"fire-perf-compat",[Gp]:"fire-rc",[Kp]:"fire-rc-compat",[Qp]:"fire-gcs",[Jp]:"fire-gcs-compat",[Xp]:"fire-fst",[Zp]:"fire-fst-compat",[Yp]:"fire-vertex","fire-js":"fire-js",[em]:"fire-js-all"};const Hi=new Map,rm=new Map,vo=new Map;function xc(n,e){try{n.container.addComponent(e)}catch(t){bt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Xt(n){const e=n.name;if(vo.has(e))return bt.debug(`There were multiple attempts to register component ${e}.`),!1;vo.set(e,n);for(const t of Hi.values())xc(t,n);for(const t of rm.values())xc(t,n);return!0}function Kr(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Qe(n){return n==null?!1:n.settings!==void 0}const im={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Gt=new Wr("app","Firebase",im);class sm{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new St("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Gt.create("app-deleted",{appName:this._name})}}const Pn=tm;function om(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Eo,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw Gt.create("bad-app-name",{appName:String(i)});if(t||(t=yl()),!t)throw Gt.create("no-options");const s=Hi.get(i);if(s){if(In(t,s.options)&&In(r,s.config))return s;throw Gt.create("duplicate-app",{appName:i})}const a=new hp(i);for(const h of vo.values())a.addComponent(h);const c=new sm(t,r,a);return Hi.set(i,c),c}function ms(n=Eo){const e=Hi.get(n);if(!e&&n===Eo&&yl())return om();if(!e)throw Gt.create("no-app",{appName:n});return e}function et(n,e,t){var r;let i=(r=nm[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const c=[`Unable to register library "${i}" with version "${e}":`];s&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&c.push("and"),a&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),bt.warn(c.join(" "));return}Xt(new St(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const am="firebase-heartbeat-database",cm=1,xr="firebase-heartbeat-store";let oo=null;function Il(){return oo||(oo=Ap(am,cm,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(xr)}catch(t){console.warn(t)}}}}).catch(n=>{throw Gt.create("idb-open",{originalErrorMessage:n.message})})),oo}async function um(n){try{const t=(await Il()).transaction(xr),r=await t.objectStore(xr).get(Al(n));return await t.done,r}catch(e){if(e instanceof at)bt.warn(e.message);else{const t=Gt.create("idb-get",{originalErrorMessage:e?.message});bt.warn(t.message)}}}async function Uc(n,e){try{const r=(await Il()).transaction(xr,"readwrite");await r.objectStore(xr).put(e,Al(n)),await r.done}catch(t){if(t instanceof at)bt.warn(t.message);else{const r=Gt.create("idb-set",{originalErrorMessage:t?.message});bt.warn(r.message)}}}function Al(n){return`${n.name}!${n.options.appId}`}const lm=1024,hm=30;class dm{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new pm(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Fc();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>hm){const a=mm(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){bt.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Fc(),{heartbeatsToSend:r,unsentEntries:i}=fm(this._heartbeatsCache.heartbeats),s=qi(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return bt.warn(t),""}}}function Fc(){return new Date().toISOString().substring(0,10)}function fm(n,e=lm){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Bc(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Bc(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class pm{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Zf()?ep().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await um(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return Uc(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return Uc(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Bc(n){return qi(JSON.stringify({version:2,heartbeats:n})).length}function mm(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function gm(n){Xt(new St("platform-logger",e=>new bp(e),"PRIVATE")),Xt(new St("heartbeat",e=>new dm(e),"PRIVATE")),et(yo,Mc,n),et(yo,Mc,"esm2017"),et("fire-js","")}gm("");function Rl(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const _m=Rl,Sl=new Wr("auth","Firebase",Rl());const zi=new Wo("@firebase/auth");function ym(n,...e){zi.logLevel<=Z.WARN&&zi.warn(`Auth (${Pn}): ${n}`,...e)}function Oi(n,...e){zi.logLevel<=Z.ERROR&&zi.error(`Auth (${Pn}): ${n}`,...e)}function ot(n,...e){throw Ko(n,...e)}function dt(n,...e){return Ko(n,...e)}function bl(n,e,t){const r=Object.assign(Object.assign({},_m()),{[e]:t});return new Wr("auth","Firebase",r).create(e,{appName:n.name})}function Kt(n){return bl(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ko(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Sl.create(n,...e)}function z(n,e,...t){if(!n)throw Ko(e,...t)}function It(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Oi(e),new Error(e)}function Pt(n,e){n||It(e)}function To(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Em(){return jc()==="http:"||jc()==="https:"}function jc(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function vm(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Em()||Qf()||"connection"in navigator)?navigator.onLine:!0}function Tm(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Qr{constructor(e,t){this.shortDelay=e,this.longDelay=t,Pt(t>e,"Short delay should be less than long delay!"),this.isMobile=Wf()||Jf()}get(){return vm()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Qo(n,e){Pt(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Pl{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;It("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;It("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;It("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const wm={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Im=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Am=new Qr(3e4,6e4);function Cn(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function on(n,e,t,r,i={}){return Cl(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const c=Gr(Object.assign({key:n.config.apiKey},a)).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);const m=Object.assign({method:e,headers:h},s);return Kf()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&Dt(n.emulatorConfig.host)&&(m.credentials="include"),Pl.fetch()(await kl(n,n.config.apiHost,t,c),m)})}async function Cl(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},wm),e);try{const i=new Sm(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Ri(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const c=s.ok?a.errorMessage:a.error.message,[h,m]=c.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ri(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw Ri(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw Ri(n,"user-disabled",a);const p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw bl(n,p,m);ot(n,p)}}catch(i){if(i instanceof at)throw i;ot(n,"network-request-failed",{message:String(i)})}}async function gs(n,e,t,r,i={}){const s=await on(n,e,t,r,i);return"mfaPendingCredential"in s&&ot(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function kl(n,e,t,r){const i=`${e}${t}?${r}`,s=n,a=s.config.emulator?Qo(n.config,i):`${n.config.apiScheme}://${i}`;return Im.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}function Rm(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Sm{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(dt(this.auth,"network-request-failed")),Am.get())})}}function Ri(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=dt(n,e,r);return i.customData._tokenResponse=t,i}function $c(n){return n!==void 0&&n.enterprise!==void 0}class bm{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Rm(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Pm(n,e){return on(n,"GET","/v2/recaptchaConfig",Cn(n,e))}async function Cm(n,e){return on(n,"POST","/v1/accounts:delete",e)}async function Wi(n,e){return on(n,"POST","/v1/accounts:lookup",e)}function Nr(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function km(n,e=!1){const t=fe(n),r=await t.getIdToken(e),i=Jo(r);z(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:Nr(ao(i.auth_time)),issuedAtTime:Nr(ao(i.iat)),expirationTime:Nr(ao(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function ao(n){return Number(n)*1e3}function Jo(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Oi("JWT malformed, contained fewer than 3 sections"),null;try{const i=gl(t);return i?JSON.parse(i):(Oi("Failed to decode base64 JWT payload"),null)}catch(i){return Oi("Caught error parsing JWT payload as JSON",i?.toString()),null}}function qc(n){const e=Jo(n);return z(e,"internal-error"),z(typeof e.exp<"u","internal-error"),z(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Ur(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof at&&Nm(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function Nm({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class Dm{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class wo{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Nr(this.lastLoginAt),this.creationTime=Nr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Gi(n){var e;const t=n.auth,r=await n.getIdToken(),i=await Ur(n,Wi(t,{idToken:r}));z(i?.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Nl(s.providerUserInfo):[],c=Vm(n.providerData,a),h=n.isAnonymous,m=!(n.email&&s.passwordHash)&&!c?.length,p=h?m:!1,v={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new wo(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,v)}async function Om(n){const e=fe(n);await Gi(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Vm(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Nl(n){return n.map(e=>{var{providerId:t}=e,r=Ho(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function Lm(n,e){const t=await Cl(n,{},async()=>{const r=Gr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=await kl(n,i,"/v1/token",`key=${s}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:c,body:r};return n.emulatorConfig&&Dt(n.emulatorConfig.host)&&(h.credentials="include"),Pl.fetch()(a,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Mm(n,e){return on(n,"POST","/v2/accounts:revokeToken",Cn(n,e))}class zn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){z(e.idToken,"internal-error"),z(typeof e.idToken<"u","internal-error"),z(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):qc(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){z(e.length!==0,"internal-error");const t=qc(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(z(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await Lm(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new zn;return r&&(z(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(z(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(z(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new zn,this.toJSON())}_performRefresh(){return It("not implemented")}}function Ft(n,e){z(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class it{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Ho(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Dm(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new wo(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Ur(this,this.stsTokenManager.getToken(this.auth,e));return z(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return km(this,e)}reload(){return Om(this)}_assign(e){this!==e&&(z(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new it(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){z(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Gi(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qe(this.auth.app))return Promise.reject(Kt(this.auth));const e=await this.getIdToken();return await Ur(this,Cm(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,c,h,m,p;const v=(r=t.displayName)!==null&&r!==void 0?r:void 0,I=(i=t.email)!==null&&i!==void 0?i:void 0,N=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,L=(a=t.photoURL)!==null&&a!==void 0?a:void 0,F=(c=t.tenantId)!==null&&c!==void 0?c:void 0,x=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,Q=(m=t.createdAt)!==null&&m!==void 0?m:void 0,q=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:H,emailVerified:J,isAnonymous:Ae,providerData:se,stsTokenManager:S}=t;z(H&&S,e,"internal-error");const E=zn.fromJSON(this.name,S);z(typeof H=="string",e,"internal-error"),Ft(v,e.name),Ft(I,e.name),z(typeof J=="boolean",e,"internal-error"),z(typeof Ae=="boolean",e,"internal-error"),Ft(N,e.name),Ft(L,e.name),Ft(F,e.name),Ft(x,e.name),Ft(Q,e.name),Ft(q,e.name);const T=new it({uid:H,auth:e,email:I,emailVerified:J,displayName:v,isAnonymous:Ae,photoURL:L,phoneNumber:N,tenantId:F,stsTokenManager:E,createdAt:Q,lastLoginAt:q});return se&&Array.isArray(se)&&(T.providerData=se.map(R=>Object.assign({},R))),x&&(T._redirectEventId=x),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new zn;i.updateFromServerResponse(t);const s=new it({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Gi(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];z(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?Nl(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,c=new zn;c.updateFromIdToken(r);const h=new it({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:a}),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new wo(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(h,m),h}}const Hc=new Map;function At(n){Pt(n instanceof Function,"Expected a class definition");let e=Hc.get(n);return e?(Pt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Hc.set(n,e),e)}class Dl{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Dl.type="NONE";const zc=Dl;function Vi(n,e,t){return`firebase:${n}:${e}:${t}`}class Wn{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Vi(this.userKey,i.apiKey,s),this.fullPersistenceKey=Vi("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Wi(this.auth,{idToken:e}).catch(()=>{});return t?it._fromGetAccountInfoResponse(this.auth,t,e):null}return it._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Wn(At(zc),e,r);const i=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let s=i[0]||At(zc);const a=Vi(r,e.config.apiKey,e.name);let c=null;for(const m of t)try{const p=await m._get(a);if(p){let v;if(typeof p=="string"){const I=await Wi(e,{idToken:p}).catch(()=>{});if(!I)break;v=await it._fromGetAccountInfoResponse(e,I,p)}else v=it._fromJSON(e,p);m!==s&&(c=v),s=m;break}}catch{}const h=i.filter(m=>m._shouldAllowMigration);return!s._shouldAllowMigration||!h.length?new Wn(s,e,r):(s=h[0],c&&await s._set(a,c.toJSON()),await Promise.all(t.map(async m=>{if(m!==s)try{await m._remove(a)}catch{}})),new Wn(s,e,r))}}function Wc(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ml(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ol(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ul(e))return"Blackberry";if(Fl(e))return"Webos";if(Vl(e))return"Safari";if((e.includes("chrome/")||Ll(e))&&!e.includes("edge/"))return"Chrome";if(xl(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Ol(n=Be()){return/firefox\//i.test(n)}function Vl(n=Be()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ll(n=Be()){return/crios\//i.test(n)}function Ml(n=Be()){return/iemobile/i.test(n)}function xl(n=Be()){return/android/i.test(n)}function Ul(n=Be()){return/blackberry/i.test(n)}function Fl(n=Be()){return/webos/i.test(n)}function Xo(n=Be()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function xm(n=Be()){var e;return Xo(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Um(){return Xf()&&document.documentMode===10}function Bl(n=Be()){return Xo(n)||xl(n)||Fl(n)||Ul(n)||/windows phone/i.test(n)||Ml(n)}function jl(n,e=[]){let t;switch(n){case"Browser":t=Wc(Be());break;case"Worker":t=`${Wc(Be())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Pn}/${r}`}class Fm{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,c)=>{try{const h=e(s);a(h)}catch(h){c(h)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function Bm(n,e={}){return on(n,"GET","/v2/passwordPolicy",Cn(n,e))}const jm=6;class $m{constructor(e){var t,r,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:jm,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,c;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(s=h.containsUppercaseLetter)!==null&&s!==void 0?s:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(c=h.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),h}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class qm{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Gc(this),this.idTokenSubscription=new Gc(this),this.beforeStateQueue=new Fm(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Sl,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=At(t)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await Wn.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Wi(this,{idToken:e}),r=await it._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Qe(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=i?._redirectEventId,h=await this.tryRedirectSignIn(e);(!a||a===c)&&h?.user&&(i=h.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return z(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Gi(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Tm()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qe(this.app))return Promise.reject(Kt(this));const t=e?fe(e):null;return t&&z(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&z(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qe(this.app)?Promise.reject(Kt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qe(this.app)?Promise.reject(Kt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(At(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Bm(this),t=new $m(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Wr("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Mm(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&At(e)||this._popupRedirectResolver;z(t,this,"argument-error"),this.redirectPersistenceManager=await Wn.create(this,[At(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(z(c,this,"internal-error"),c.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{const h=e.addObserver(t);return()=>{a=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return z(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=jl(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;if(Qe(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&ym(`Error while retrieving App Check token: ${t.error}`),t?.token}}function rr(n){return fe(n)}class Gc{constructor(e){this.auth=e,this.observer=null,this.addObserver=sp(t=>this.observer=t)}get next(){return z(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let _s={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Hm(n){_s=n}function $l(n){return _s.loadJS(n)}function zm(){return _s.recaptchaEnterpriseScript}function Wm(){return _s.gapiScript}function Gm(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class Km{constructor(){this.enterprise=new Qm}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Qm{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Jm="recaptcha-enterprise",ql="NO_RECAPTCHA";class Xm{constructor(e){this.type=Jm,this.auth=rr(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,c)=>{Pm(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const m=new bm(h);return s.tenantId==null?s._agentRecaptchaConfig=m:s._tenantRecaptchaConfigs[s.tenantId]=m,a(m.siteKey)}}).catch(h=>{c(h)})})}function i(s,a,c){const h=window.grecaptcha;$c(h)?h.enterprise.ready(()=>{h.enterprise.execute(s,{action:e}).then(m=>{a(m)}).catch(()=>{a(ql)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Km().execute("siteKey",{action:"verify"}):new Promise((s,a)=>{r(this.auth).then(c=>{if(!t&&$c(window.grecaptcha))i(c,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let h=zm();h.length!==0&&(h+=c),$l(h).then(()=>{i(c,s,a)}).catch(m=>{a(m)})}}).catch(c=>{a(c)})})}}async function Kc(n,e,t,r=!1,i=!1){const s=new Xm(n);let a;if(i)a=ql;else try{a=await s.verify(t)}catch{a=await s.verify(t,!0)}const c=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const h=c.phoneEnrollmentInfo.phoneNumber,m=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:m,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const h=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:a}):Object.assign(c,{captchaResponse:a}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Qc(n,e,t,r,i){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Kc(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await Kc(n,e,t,t==="getOobCode");return r(n,c)}else return Promise.reject(a)})}function Ym(n,e){const t=Kr(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(In(s,e??{}))return i;ot(i,"already-initialized")}return t.initialize({options:e})}function Zm(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(At);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function eg(n,e,t){const r=rr(n);z(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=Hl(e),{host:a,port:c}=tg(e),h=c===null?"":`:${c}`,m={url:`${s}//${a}${h}/`},p=Object.freeze({host:a,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){z(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),z(In(m,r.config.emulator)&&In(p,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=m,r.emulatorConfig=p,r.settings.appVerificationDisabledForTesting=!0,Dt(a)?(fs(`${s}//${a}${h}`),ps("Auth",!0)):ng()}function Hl(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function tg(n){const e=Hl(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:Jc(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:Jc(a)}}}function Jc(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function ng(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Yo{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return It("not implemented")}_getIdTokenResponse(e){return It("not implemented")}_linkToIdToken(e,t){return It("not implemented")}_getReauthenticationResolver(e){return It("not implemented")}}async function rg(n,e){return on(n,"POST","/v1/accounts:signUp",e)}async function ig(n,e){return gs(n,"POST","/v1/accounts:signInWithPassword",Cn(n,e))}async function sg(n,e){return gs(n,"POST","/v1/accounts:signInWithEmailLink",Cn(n,e))}async function og(n,e){return gs(n,"POST","/v1/accounts:signInWithEmailLink",Cn(n,e))}class Fr extends Yo{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Fr(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Fr(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Qc(e,t,"signInWithPassword",ig);case"emailLink":return sg(e,{email:this._email,oobCode:this._password});default:ot(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Qc(e,r,"signUpPassword",rg);case"emailLink":return og(e,{idToken:t,email:this._email,oobCode:this._password});default:ot(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Gn(n,e){return gs(n,"POST","/v1/accounts:signInWithIdp",Cn(n,e))}const ag="http://localhost";class An extends Yo{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new An(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ot("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=Ho(t,["providerId","signInMethod"]);if(!r||!i)return null;const a=new An(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Gn(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Gn(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Gn(e,t)}buildRequest(){const e={requestUri:ag,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Gr(t)}return e}}function cg(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function ug(n){const e=Ar(Rr(n)).link,t=e?Ar(Rr(e)).deep_link_id:null,r=Ar(Rr(n)).deep_link_id;return(r?Ar(Rr(r)).link:null)||r||t||e||n}class Zo{constructor(e){var t,r,i,s,a,c;const h=Ar(Rr(e)),m=(t=h.apiKey)!==null&&t!==void 0?t:null,p=(r=h.oobCode)!==null&&r!==void 0?r:null,v=cg((i=h.mode)!==null&&i!==void 0?i:null);z(m&&p&&v,"argument-error"),this.apiKey=m,this.operation=v,this.code=p,this.continueUrl=(s=h.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=h.lang)!==null&&a!==void 0?a:null,this.tenantId=(c=h.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){const t=ug(e);try{return new Zo(t)}catch{return null}}}class ir{constructor(){this.providerId=ir.PROVIDER_ID}static credential(e,t){return Fr._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Zo.parseLink(t);return z(r,"argument-error"),Fr._fromEmailAndCode(e,r.code,r.tenantId)}}ir.PROVIDER_ID="password";ir.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ir.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class zl{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Jr extends zl{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Bt extends Jr{constructor(){super("facebook.com")}static credential(e){return An._fromParams({providerId:Bt.PROVIDER_ID,signInMethod:Bt.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bt.credentialFromTaggedObject(e)}static credentialFromError(e){return Bt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bt.credential(e.oauthAccessToken)}catch{return null}}}Bt.FACEBOOK_SIGN_IN_METHOD="facebook.com";Bt.PROVIDER_ID="facebook.com";class jt extends Jr{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return An._fromParams({providerId:jt.PROVIDER_ID,signInMethod:jt.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return jt.credentialFromTaggedObject(e)}static credentialFromError(e){return jt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return jt.credential(t,r)}catch{return null}}}jt.GOOGLE_SIGN_IN_METHOD="google.com";jt.PROVIDER_ID="google.com";class $t extends Jr{constructor(){super("github.com")}static credential(e){return An._fromParams({providerId:$t.PROVIDER_ID,signInMethod:$t.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $t.credentialFromTaggedObject(e)}static credentialFromError(e){return $t.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $t.credential(e.oauthAccessToken)}catch{return null}}}$t.GITHUB_SIGN_IN_METHOD="github.com";$t.PROVIDER_ID="github.com";class qt extends Jr{constructor(){super("twitter.com")}static credential(e,t){return An._fromParams({providerId:qt.PROVIDER_ID,signInMethod:qt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return qt.credentialFromTaggedObject(e)}static credentialFromError(e){return qt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return qt.credential(t,r)}catch{return null}}}qt.TWITTER_SIGN_IN_METHOD="twitter.com";qt.PROVIDER_ID="twitter.com";class Jn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await it._fromIdTokenResponse(e,r,i),a=Xc(r);return new Jn({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=Xc(r);return new Jn({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function Xc(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Ki extends at{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Ki.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new Ki(e,t,r,i)}}function Wl(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Ki._fromErrorAndOperation(n,s,e,r):s})}async function lg(n,e,t=!1){const r=await Ur(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Jn._forOperation(n,"link",r)}async function hg(n,e,t=!1){const{auth:r}=n;if(Qe(r.app))return Promise.reject(Kt(r));const i="reauthenticate";try{const s=await Ur(n,Wl(r,i,e,n),t);z(s.idToken,r,"internal-error");const a=Jo(s.idToken);z(a,r,"internal-error");const{sub:c}=a;return z(n.uid===c,r,"user-mismatch"),Jn._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&ot(r,"user-mismatch"),s}}async function Gl(n,e,t=!1){if(Qe(n.app))return Promise.reject(Kt(n));const r="signIn",i=await Wl(n,r,e),s=await Jn._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function dg(n,e){return Gl(rr(n),e)}async function fg(n){const e=rr(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function Ew(n,e,t){return Qe(n.app)?Promise.reject(Kt(n)):dg(fe(n),ir.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&fg(n),r})}function vw(n,e){return fe(n).setPersistence(e)}function pg(n,e,t,r){return fe(n).onIdTokenChanged(e,t,r)}function mg(n,e,t){return fe(n).beforeAuthStateChanged(e,t)}function Tw(n,e,t,r){return fe(n).onAuthStateChanged(e,t,r)}function ww(n){return fe(n).signOut()}const Qi="__sak";class Kl{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Qi,"1"),this.storage.removeItem(Qi),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const gg=1e3,_g=10;class Ql extends Kl{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Bl(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,c,h)=>{this.notifyListeners(a,h)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);Um()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,_g):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},gg)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ql.type="LOCAL";const yg=Ql;class Jl extends Kl{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Jl.type="SESSION";const Xl=Jl;function Eg(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class ys{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new ys(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(a).map(async m=>m(t.origin,s)),h=await Eg(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ys.receivers=[];function ea(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class vg{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((c,h)=>{const m=ea("",20);i.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(v){const I=v;if(I.data.eventId===m)switch(I.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(I.data.response);break;default:clearTimeout(p),clearTimeout(s),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function ft(){return window}function Tg(n){ft().location.href=n}function Yl(){return typeof ft().WorkerGlobalScope<"u"&&typeof ft().importScripts=="function"}async function wg(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Ig(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Ag(){return Yl()?self:null}const Zl="firebaseLocalStorageDb",Rg=1,Ji="firebaseLocalStorage",eh="fbase_key";class Xr{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Es(n,e){return n.transaction([Ji],e?"readwrite":"readonly").objectStore(Ji)}function Sg(){const n=indexedDB.deleteDatabase(Zl);return new Xr(n).toPromise()}function Io(){const n=indexedDB.open(Zl,Rg);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Ji,{keyPath:eh})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Ji)?e(r):(r.close(),await Sg(),e(await Io()))})})}async function Yc(n,e,t){const r=Es(n,!0).put({[eh]:e,value:t});return new Xr(r).toPromise()}async function bg(n,e){const t=Es(n,!1).get(e),r=await new Xr(t).toPromise();return r===void 0?null:r.value}function Zc(n,e){const t=Es(n,!0).delete(e);return new Xr(t).toPromise()}const Pg=800,Cg=3;class th{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Io(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>Cg)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Yl()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ys._getInstance(Ag()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await wg(),!this.activeServiceWorker)return;this.sender=new vg(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Ig()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Io();return await Yc(e,Qi,"1"),await Zc(e,Qi),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Yc(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>bg(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Zc(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Es(i,!1).getAll();return new Xr(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Pg)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}th.type="LOCAL";const kg=th;new Qr(3e4,6e4);function Ng(n,e){return e?At(e):(z(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class ta extends Yo{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Gn(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Gn(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Gn(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Dg(n){return Gl(n.auth,new ta(n),n.bypassAuthState)}function Og(n){const{auth:e,user:t}=n;return z(t,e,"internal-error"),hg(t,new ta(n),n.bypassAuthState)}async function Vg(n){const{auth:e,user:t}=n;return z(t,e,"internal-error"),lg(t,new ta(n),n.bypassAuthState)}class nh{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:c}=e;if(a){this.reject(a);return}const h={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(h))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Dg;case"linkViaPopup":case"linkViaRedirect":return Vg;case"reauthViaPopup":case"reauthViaRedirect":return Og;default:ot(this.auth,"internal-error")}}resolve(e){Pt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Pt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Lg=new Qr(2e3,1e4);class Hn extends nh{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Hn.currentPopupAction&&Hn.currentPopupAction.cancel(),Hn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return z(e,this.auth,"internal-error"),e}async onExecution(){Pt(this.filter.length===1,"Popup operations only handle one event");const e=ea();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(dt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(dt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Hn.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(dt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Lg.get())};e()}}Hn.currentPopupAction=null;const Mg="pendingRedirect",Li=new Map;class xg extends nh{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Li.get(this.auth._key());if(!e){try{const r=await Ug(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Li.set(this.auth._key(),e)}return this.bypassAuthState||Li.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Ug(n,e){const t=jg(e),r=Bg(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function Fg(n,e){Li.set(n._key(),e)}function Bg(n){return At(n._redirectPersistence)}function jg(n){return Vi(Mg,n.config.apiKey,n.name)}async function $g(n,e,t=!1){if(Qe(n.app))return Promise.reject(Kt(n));const r=rr(n),i=Ng(r,e),a=await new xg(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const qg=600*1e3;class Hg{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!zg(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!rh(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(dt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=qg&&this.cachedEventUids.clear(),this.cachedEventUids.has(eu(e))}saveEventToCache(e){this.cachedEventUids.add(eu(e)),this.lastProcessedEventTime=Date.now()}}function eu(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function rh({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function zg(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return rh(n);default:return!1}}async function Wg(n,e={}){return on(n,"GET","/v1/projects",e)}const Gg=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Kg=/^https?/;async function Qg(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Wg(n);for(const t of e)try{if(Jg(t))return}catch{}ot(n,"unauthorized-domain")}function Jg(n){const e=To(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!Kg.test(t))return!1;if(Gg.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Xg=new Qr(3e4,6e4);function tu(){const n=ft().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Yg(n){return new Promise((e,t)=>{var r,i,s;function a(){tu(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{tu(),t(dt(n,"network-request-failed"))},timeout:Xg.get()})}if(!((i=(r=ft().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ft().gapi)===null||s===void 0)&&s.load)a();else{const c=Gm("iframefcb");return ft()[c]=()=>{gapi.load?a():t(dt(n,"network-request-failed"))},$l(`${Wm()}?onload=${c}`).catch(h=>t(h))}}).catch(e=>{throw Mi=null,e})}let Mi=null;function Zg(n){return Mi=Mi||Yg(n),Mi}const e_=new Qr(5e3,15e3),t_="__/auth/iframe",n_="emulator/auth/iframe",r_={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},i_=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function s_(n){const e=n.config;z(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Qo(e,n_):`https://${n.config.authDomain}/${t_}`,r={apiKey:e.apiKey,appName:n.name,v:Pn},i=i_.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Gr(r).slice(1)}`}async function o_(n){const e=await Zg(n),t=ft().gapi;return z(t,n,"internal-error"),e.open({where:document.body,url:s_(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:r_,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=dt(n,"network-request-failed"),c=ft().setTimeout(()=>{s(a)},e_.get());function h(){ft().clearTimeout(c),i(r)}r.ping(h).then(h,()=>{s(a)})}))}const a_={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},c_=500,u_=600,l_="_blank",h_="http://localhost";class nu{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function d_(n,e,t,r=c_,i=u_){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const h=Object.assign(Object.assign({},a_),{width:r.toString(),height:i.toString(),top:s,left:a}),m=Be().toLowerCase();t&&(c=Ll(m)?l_:t),Ol(m)&&(e=e||h_,h.scrollbars="yes");const p=Object.entries(h).reduce((I,[N,L])=>`${I}${N}=${L},`,"");if(xm(m)&&c!=="_self")return f_(e||"",c),new nu(null);const v=window.open(e||"",c,p);z(v,n,"popup-blocked");try{v.focus()}catch{}return new nu(v)}function f_(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const p_="__/auth/handler",m_="emulator/auth/handler",g_=encodeURIComponent("fac");async function ru(n,e,t,r,i,s){z(n.config.authDomain,n,"auth-domain-config-required"),z(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Pn,eventId:i};if(e instanceof zl){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",ip(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,v]of Object.entries({}))a[p]=v}if(e instanceof Jr){const p=e.getScopes().filter(v=>v!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);const c=a;for(const p of Object.keys(c))c[p]===void 0&&delete c[p];const h=await n._getAppCheckToken(),m=h?`#${g_}=${encodeURIComponent(h)}`:"";return`${__(n)}?${Gr(c).slice(1)}${m}`}function __({config:n}){return n.emulator?Qo(n,m_):`https://${n.authDomain}/${p_}`}const co="webStorageSupport";class y_{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Xl,this._completeRedirectFn=$g,this._overrideRedirectResult=Fg}async _openPopup(e,t,r,i){var s;Pt((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await ru(e,t,r,To(),i);return d_(e,a,ea())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await ru(e,t,r,To(),i);return Tg(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Pt(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await o_(e),r=new Hg(e);return t.register("authEvent",i=>(z(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(co,{type:co},i=>{var s;const a=(s=i?.[0])===null||s===void 0?void 0:s[co];a!==void 0&&t(!!a),ot(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Qg(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Bl()||Vl()||Xo()}}const E_=y_;var iu="@firebase/auth",su="1.10.8";class v_{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){z(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function T_(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function w_(n){Xt(new St("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;z(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jl(n)},m=new qm(r,i,s,h);return Zm(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Xt(new St("auth-internal",e=>{const t=rr(e.getProvider("auth").getImmediate());return(r=>new v_(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),et(iu,su,T_(n)),et(iu,su,"esm2017")}const I_=300,A_=El("authIdTokenMaxAge")||I_;let ou=null;const R_=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>A_)return;const i=t?.token;ou!==i&&(ou=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Iw(n=ms()){const e=Kr(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Ym(n,{popupRedirectResolver:E_,persistence:[kg,yg,Xl]}),r=El("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const a=R_(s.toString());mg(t,a,()=>a(t.currentUser)),pg(t,c=>a(c))}}const i=_l("auth");return i&&eg(t,`http://${i}`),t}function S_(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}Hm({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=dt("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",S_().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});w_("Browser");var au=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};var Qt,ih;(function(){var n;function e(S,E){function T(){}T.prototype=E.prototype,S.D=E.prototype,S.prototype=new T,S.prototype.constructor=S,S.C=function(R,b,C){for(var w=Array(arguments.length-2),tt=2;tt<arguments.length;tt++)w[tt-2]=arguments[tt];return E.prototype[b].apply(R,w)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,E,T){T||(T=0);var R=Array(16);if(typeof E=="string")for(var b=0;16>b;++b)R[b]=E.charCodeAt(T++)|E.charCodeAt(T++)<<8|E.charCodeAt(T++)<<16|E.charCodeAt(T++)<<24;else for(b=0;16>b;++b)R[b]=E[T++]|E[T++]<<8|E[T++]<<16|E[T++]<<24;E=S.g[0],T=S.g[1],b=S.g[2];var C=S.g[3],w=E+(C^T&(b^C))+R[0]+3614090360&4294967295;E=T+(w<<7&4294967295|w>>>25),w=C+(b^E&(T^b))+R[1]+3905402710&4294967295,C=E+(w<<12&4294967295|w>>>20),w=b+(T^C&(E^T))+R[2]+606105819&4294967295,b=C+(w<<17&4294967295|w>>>15),w=T+(E^b&(C^E))+R[3]+3250441966&4294967295,T=b+(w<<22&4294967295|w>>>10),w=E+(C^T&(b^C))+R[4]+4118548399&4294967295,E=T+(w<<7&4294967295|w>>>25),w=C+(b^E&(T^b))+R[5]+1200080426&4294967295,C=E+(w<<12&4294967295|w>>>20),w=b+(T^C&(E^T))+R[6]+2821735955&4294967295,b=C+(w<<17&4294967295|w>>>15),w=T+(E^b&(C^E))+R[7]+4249261313&4294967295,T=b+(w<<22&4294967295|w>>>10),w=E+(C^T&(b^C))+R[8]+1770035416&4294967295,E=T+(w<<7&4294967295|w>>>25),w=C+(b^E&(T^b))+R[9]+2336552879&4294967295,C=E+(w<<12&4294967295|w>>>20),w=b+(T^C&(E^T))+R[10]+4294925233&4294967295,b=C+(w<<17&4294967295|w>>>15),w=T+(E^b&(C^E))+R[11]+2304563134&4294967295,T=b+(w<<22&4294967295|w>>>10),w=E+(C^T&(b^C))+R[12]+1804603682&4294967295,E=T+(w<<7&4294967295|w>>>25),w=C+(b^E&(T^b))+R[13]+4254626195&4294967295,C=E+(w<<12&4294967295|w>>>20),w=b+(T^C&(E^T))+R[14]+2792965006&4294967295,b=C+(w<<17&4294967295|w>>>15),w=T+(E^b&(C^E))+R[15]+1236535329&4294967295,T=b+(w<<22&4294967295|w>>>10),w=E+(b^C&(T^b))+R[1]+4129170786&4294967295,E=T+(w<<5&4294967295|w>>>27),w=C+(T^b&(E^T))+R[6]+3225465664&4294967295,C=E+(w<<9&4294967295|w>>>23),w=b+(E^T&(C^E))+R[11]+643717713&4294967295,b=C+(w<<14&4294967295|w>>>18),w=T+(C^E&(b^C))+R[0]+3921069994&4294967295,T=b+(w<<20&4294967295|w>>>12),w=E+(b^C&(T^b))+R[5]+3593408605&4294967295,E=T+(w<<5&4294967295|w>>>27),w=C+(T^b&(E^T))+R[10]+38016083&4294967295,C=E+(w<<9&4294967295|w>>>23),w=b+(E^T&(C^E))+R[15]+3634488961&4294967295,b=C+(w<<14&4294967295|w>>>18),w=T+(C^E&(b^C))+R[4]+3889429448&4294967295,T=b+(w<<20&4294967295|w>>>12),w=E+(b^C&(T^b))+R[9]+568446438&4294967295,E=T+(w<<5&4294967295|w>>>27),w=C+(T^b&(E^T))+R[14]+3275163606&4294967295,C=E+(w<<9&4294967295|w>>>23),w=b+(E^T&(C^E))+R[3]+4107603335&4294967295,b=C+(w<<14&4294967295|w>>>18),w=T+(C^E&(b^C))+R[8]+1163531501&4294967295,T=b+(w<<20&4294967295|w>>>12),w=E+(b^C&(T^b))+R[13]+2850285829&4294967295,E=T+(w<<5&4294967295|w>>>27),w=C+(T^b&(E^T))+R[2]+4243563512&4294967295,C=E+(w<<9&4294967295|w>>>23),w=b+(E^T&(C^E))+R[7]+1735328473&4294967295,b=C+(w<<14&4294967295|w>>>18),w=T+(C^E&(b^C))+R[12]+2368359562&4294967295,T=b+(w<<20&4294967295|w>>>12),w=E+(T^b^C)+R[5]+4294588738&4294967295,E=T+(w<<4&4294967295|w>>>28),w=C+(E^T^b)+R[8]+2272392833&4294967295,C=E+(w<<11&4294967295|w>>>21),w=b+(C^E^T)+R[11]+1839030562&4294967295,b=C+(w<<16&4294967295|w>>>16),w=T+(b^C^E)+R[14]+4259657740&4294967295,T=b+(w<<23&4294967295|w>>>9),w=E+(T^b^C)+R[1]+2763975236&4294967295,E=T+(w<<4&4294967295|w>>>28),w=C+(E^T^b)+R[4]+1272893353&4294967295,C=E+(w<<11&4294967295|w>>>21),w=b+(C^E^T)+R[7]+4139469664&4294967295,b=C+(w<<16&4294967295|w>>>16),w=T+(b^C^E)+R[10]+3200236656&4294967295,T=b+(w<<23&4294967295|w>>>9),w=E+(T^b^C)+R[13]+681279174&4294967295,E=T+(w<<4&4294967295|w>>>28),w=C+(E^T^b)+R[0]+3936430074&4294967295,C=E+(w<<11&4294967295|w>>>21),w=b+(C^E^T)+R[3]+3572445317&4294967295,b=C+(w<<16&4294967295|w>>>16),w=T+(b^C^E)+R[6]+76029189&4294967295,T=b+(w<<23&4294967295|w>>>9),w=E+(T^b^C)+R[9]+3654602809&4294967295,E=T+(w<<4&4294967295|w>>>28),w=C+(E^T^b)+R[12]+3873151461&4294967295,C=E+(w<<11&4294967295|w>>>21),w=b+(C^E^T)+R[15]+530742520&4294967295,b=C+(w<<16&4294967295|w>>>16),w=T+(b^C^E)+R[2]+3299628645&4294967295,T=b+(w<<23&4294967295|w>>>9),w=E+(b^(T|~C))+R[0]+4096336452&4294967295,E=T+(w<<6&4294967295|w>>>26),w=C+(T^(E|~b))+R[7]+1126891415&4294967295,C=E+(w<<10&4294967295|w>>>22),w=b+(E^(C|~T))+R[14]+2878612391&4294967295,b=C+(w<<15&4294967295|w>>>17),w=T+(C^(b|~E))+R[5]+4237533241&4294967295,T=b+(w<<21&4294967295|w>>>11),w=E+(b^(T|~C))+R[12]+1700485571&4294967295,E=T+(w<<6&4294967295|w>>>26),w=C+(T^(E|~b))+R[3]+2399980690&4294967295,C=E+(w<<10&4294967295|w>>>22),w=b+(E^(C|~T))+R[10]+4293915773&4294967295,b=C+(w<<15&4294967295|w>>>17),w=T+(C^(b|~E))+R[1]+2240044497&4294967295,T=b+(w<<21&4294967295|w>>>11),w=E+(b^(T|~C))+R[8]+1873313359&4294967295,E=T+(w<<6&4294967295|w>>>26),w=C+(T^(E|~b))+R[15]+4264355552&4294967295,C=E+(w<<10&4294967295|w>>>22),w=b+(E^(C|~T))+R[6]+2734768916&4294967295,b=C+(w<<15&4294967295|w>>>17),w=T+(C^(b|~E))+R[13]+1309151649&4294967295,T=b+(w<<21&4294967295|w>>>11),w=E+(b^(T|~C))+R[4]+4149444226&4294967295,E=T+(w<<6&4294967295|w>>>26),w=C+(T^(E|~b))+R[11]+3174756917&4294967295,C=E+(w<<10&4294967295|w>>>22),w=b+(E^(C|~T))+R[2]+718787259&4294967295,b=C+(w<<15&4294967295|w>>>17),w=T+(C^(b|~E))+R[9]+3951481745&4294967295,S.g[0]=S.g[0]+E&4294967295,S.g[1]=S.g[1]+(b+(w<<21&4294967295|w>>>11))&4294967295,S.g[2]=S.g[2]+b&4294967295,S.g[3]=S.g[3]+C&4294967295}r.prototype.u=function(S,E){E===void 0&&(E=S.length);for(var T=E-this.blockSize,R=this.B,b=this.h,C=0;C<E;){if(b==0)for(;C<=T;)i(this,S,C),C+=this.blockSize;if(typeof S=="string"){for(;C<E;)if(R[b++]=S.charCodeAt(C++),b==this.blockSize){i(this,R),b=0;break}}else for(;C<E;)if(R[b++]=S[C++],b==this.blockSize){i(this,R),b=0;break}}this.h=b,this.o+=E},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var E=1;E<S.length-8;++E)S[E]=0;var T=8*this.o;for(E=S.length-8;E<S.length;++E)S[E]=T&255,T/=256;for(this.u(S),S=Array(16),E=T=0;4>E;++E)for(var R=0;32>R;R+=8)S[T++]=this.g[E]>>>R&255;return S};function s(S,E){var T=c;return Object.prototype.hasOwnProperty.call(T,S)?T[S]:T[S]=E(S)}function a(S,E){this.h=E;for(var T=[],R=!0,b=S.length-1;0<=b;b--){var C=S[b]|0;R&&C==E||(T[b]=C,R=!1)}this.g=T}var c={};function h(S){return-128<=S&&128>S?s(S,function(E){return new a([E|0],0>E?-1:0)}):new a([S|0],0>S?-1:0)}function m(S){if(isNaN(S)||!isFinite(S))return v;if(0>S)return x(m(-S));for(var E=[],T=1,R=0;S>=T;R++)E[R]=S/T|0,T*=4294967296;return new a(E,0)}function p(S,E){if(S.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(S.charAt(0)=="-")return x(p(S.substring(1),E));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=m(Math.pow(E,8)),R=v,b=0;b<S.length;b+=8){var C=Math.min(8,S.length-b),w=parseInt(S.substring(b,b+C),E);8>C?(C=m(Math.pow(E,C)),R=R.j(C).add(m(w))):(R=R.j(T),R=R.add(m(w)))}return R}var v=h(0),I=h(1),N=h(16777216);n=a.prototype,n.m=function(){if(F(this))return-x(this).m();for(var S=0,E=1,T=0;T<this.g.length;T++){var R=this.i(T);S+=(0<=R?R:4294967296+R)*E,E*=4294967296}return S},n.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(L(this))return"0";if(F(this))return"-"+x(this).toString(S);for(var E=m(Math.pow(S,6)),T=this,R="";;){var b=J(T,E).g;T=Q(T,b.j(E));var C=((0<T.g.length?T.g[0]:T.h)>>>0).toString(S);if(T=b,L(T))return C+R;for(;6>C.length;)C="0"+C;R=C+R}},n.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function L(S){if(S.h!=0)return!1;for(var E=0;E<S.g.length;E++)if(S.g[E]!=0)return!1;return!0}function F(S){return S.h==-1}n.l=function(S){return S=Q(this,S),F(S)?-1:L(S)?0:1};function x(S){for(var E=S.g.length,T=[],R=0;R<E;R++)T[R]=~S.g[R];return new a(T,~S.h).add(I)}n.abs=function(){return F(this)?x(this):this},n.add=function(S){for(var E=Math.max(this.g.length,S.g.length),T=[],R=0,b=0;b<=E;b++){var C=R+(this.i(b)&65535)+(S.i(b)&65535),w=(C>>>16)+(this.i(b)>>>16)+(S.i(b)>>>16);R=w>>>16,C&=65535,w&=65535,T[b]=w<<16|C}return new a(T,T[T.length-1]&-2147483648?-1:0)};function Q(S,E){return S.add(x(E))}n.j=function(S){if(L(this)||L(S))return v;if(F(this))return F(S)?x(this).j(x(S)):x(x(this).j(S));if(F(S))return x(this.j(x(S)));if(0>this.l(N)&&0>S.l(N))return m(this.m()*S.m());for(var E=this.g.length+S.g.length,T=[],R=0;R<2*E;R++)T[R]=0;for(R=0;R<this.g.length;R++)for(var b=0;b<S.g.length;b++){var C=this.i(R)>>>16,w=this.i(R)&65535,tt=S.i(b)>>>16,un=S.i(b)&65535;T[2*R+2*b]+=w*un,q(T,2*R+2*b),T[2*R+2*b+1]+=C*un,q(T,2*R+2*b+1),T[2*R+2*b+1]+=w*tt,q(T,2*R+2*b+1),T[2*R+2*b+2]+=C*tt,q(T,2*R+2*b+2)}for(R=0;R<E;R++)T[R]=T[2*R+1]<<16|T[2*R];for(R=E;R<2*E;R++)T[R]=0;return new a(T,0)};function q(S,E){for(;(S[E]&65535)!=S[E];)S[E+1]+=S[E]>>>16,S[E]&=65535,E++}function H(S,E){this.g=S,this.h=E}function J(S,E){if(L(E))throw Error("division by zero");if(L(S))return new H(v,v);if(F(S))return E=J(x(S),E),new H(x(E.g),x(E.h));if(F(E))return E=J(S,x(E)),new H(x(E.g),E.h);if(30<S.g.length){if(F(S)||F(E))throw Error("slowDivide_ only works with positive integers.");for(var T=I,R=E;0>=R.l(S);)T=Ae(T),R=Ae(R);var b=se(T,1),C=se(R,1);for(R=se(R,2),T=se(T,2);!L(R);){var w=C.add(R);0>=w.l(S)&&(b=b.add(T),C=w),R=se(R,1),T=se(T,1)}return E=Q(S,b.j(E)),new H(b,E)}for(b=v;0<=S.l(E);){for(T=Math.max(1,Math.floor(S.m()/E.m())),R=Math.ceil(Math.log(T)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),C=m(T),w=C.j(E);F(w)||0<w.l(S);)T-=R,C=m(T),w=C.j(E);L(C)&&(C=I),b=b.add(C),S=Q(S,w)}return new H(b,S)}n.A=function(S){return J(this,S).h},n.and=function(S){for(var E=Math.max(this.g.length,S.g.length),T=[],R=0;R<E;R++)T[R]=this.i(R)&S.i(R);return new a(T,this.h&S.h)},n.or=function(S){for(var E=Math.max(this.g.length,S.g.length),T=[],R=0;R<E;R++)T[R]=this.i(R)|S.i(R);return new a(T,this.h|S.h)},n.xor=function(S){for(var E=Math.max(this.g.length,S.g.length),T=[],R=0;R<E;R++)T[R]=this.i(R)^S.i(R);return new a(T,this.h^S.h)};function Ae(S){for(var E=S.g.length+1,T=[],R=0;R<E;R++)T[R]=S.i(R)<<1|S.i(R-1)>>>31;return new a(T,S.h)}function se(S,E){var T=E>>5;E%=32;for(var R=S.g.length-T,b=[],C=0;C<R;C++)b[C]=0<E?S.i(C+T)>>>E|S.i(C+T+1)<<32-E:S.i(C+T);return new a(b,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,ih=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=m,a.fromString=p,Qt=a}).apply(typeof au<"u"?au:typeof self<"u"?self:typeof window<"u"?window:{});var Si=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};var sh,Sr,oh,xi,Ao,ah,ch,uh;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,u,f){return o==Array.prototype||o==Object.prototype||(o[u]=f.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Si=="object"&&Si];for(var u=0;u<o.length;++u){var f=o[u];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function i(o,u){if(u)e:{var f=r;o=o.split(".");for(var _=0;_<o.length-1;_++){var P=o[_];if(!(P in f))break e;f=f[P]}o=o[o.length-1],_=f[o],u=u(_),u!=_&&u!=null&&e(f,o,{configurable:!0,writable:!0,value:u})}}function s(o,u){o instanceof String&&(o+="");var f=0,_=!1,P={next:function(){if(!_&&f<o.length){var D=f++;return{value:u(D,o[D]),done:!1}}return _=!0,{done:!0,value:void 0}}};return P[Symbol.iterator]=function(){return P},P}i("Array.prototype.values",function(o){return o||function(){return s(this,function(u,f){return f})}});var a=a||{},c=this||self;function h(o){var u=typeof o;return u=u!="object"?u:o?Array.isArray(o)?"array":u:"null",u=="array"||u=="object"&&typeof o.length=="number"}function m(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function p(o,u,f){return o.call.apply(o.bind,arguments)}function v(o,u,f){if(!o)throw Error();if(2<arguments.length){var _=Array.prototype.slice.call(arguments,2);return function(){var P=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(P,_),o.apply(u,P)}}return function(){return o.apply(u,arguments)}}function I(o,u,f){return I=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:v,I.apply(null,arguments)}function N(o,u){var f=Array.prototype.slice.call(arguments,1);return function(){var _=f.slice();return _.push.apply(_,arguments),o.apply(this,_)}}function L(o,u){function f(){}f.prototype=u.prototype,o.aa=u.prototype,o.prototype=new f,o.prototype.constructor=o,o.Qb=function(_,P,D){for(var U=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)U[ae-2]=arguments[ae];return u.prototype[P].apply(_,U)}}function F(o){const u=o.length;if(0<u){const f=Array(u);for(let _=0;_<u;_++)f[_]=o[_];return f}return[]}function x(o,u){for(let f=1;f<arguments.length;f++){const _=arguments[f];if(h(_)){const P=o.length||0,D=_.length||0;o.length=P+D;for(let U=0;U<D;U++)o[P+U]=_[U]}else o.push(_)}}class Q{constructor(u,f){this.i=u,this.j=f,this.h=0,this.g=null}get(){let u;return 0<this.h?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function q(o){return/^[\s\xa0]*$/.test(o)}function H(){var o=c.navigator;return o&&(o=o.userAgent)?o:""}function J(o){return J[" "](o),o}J[" "]=function(){};var Ae=H().indexOf("Gecko")!=-1&&!(H().toLowerCase().indexOf("webkit")!=-1&&H().indexOf("Edge")==-1)&&!(H().indexOf("Trident")!=-1||H().indexOf("MSIE")!=-1)&&H().indexOf("Edge")==-1;function se(o,u,f){for(const _ in o)u.call(f,o[_],_,o)}function S(o,u){for(const f in o)u.call(void 0,o[f],f,o)}function E(o){const u={};for(const f in o)u[f]=o[f];return u}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(o,u){let f,_;for(let P=1;P<arguments.length;P++){_=arguments[P];for(f in _)o[f]=_[f];for(let D=0;D<T.length;D++)f=T[D],Object.prototype.hasOwnProperty.call(_,f)&&(o[f]=_[f])}}function b(o){var u=1;o=o.split(":");const f=[];for(;0<u&&o.length;)f.push(o.shift()),u--;return o.length&&f.push(o.join(":")),f}function C(o){c.setTimeout(()=>{throw o},0)}function w(){var o=lr;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class tt{constructor(){this.h=this.g=null}add(u,f){const _=un.get();_.set(u,f),this.h?this.h.next=_:this.g=_,this.h=_}}var un=new Q(()=>new xs,o=>o.reset());class xs{constructor(){this.next=this.g=this.h=null}set(u,f){this.h=u,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Ot,Vt=!1,lr=new tt,ri=()=>{const o=c.Promise.resolve(void 0);Ot=()=>{o.then(Us)}};var Us=()=>{for(var o;o=w();){try{o.h.call(o.g)}catch(f){C(f)}var u=un;u.j(o),100>u.h&&(u.h++,o.next=u.g,u.g=o)}Vt=!1};function ct(){this.s=this.s,this.C=this.C}ct.prototype.s=!1,ct.prototype.ma=function(){this.s||(this.s=!0,this.N())},ct.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Pe(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}Pe.prototype.h=function(){this.defaultPrevented=!0};var Ee=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};c.addEventListener("test",f,u),c.removeEventListener("test",f,u)}catch{}return o})();function ve(o,u){if(Pe.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var f=this.type=o.type,_=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget){if(Ae){e:{try{J(u.nodeName);var P=!0;break e}catch{}P=!1}P||(u=null)}}else f=="mouseover"?u=o.fromElement:f=="mouseout"&&(u=o.toElement);this.relatedTarget=u,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:ii[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&ve.aa.h.call(this)}}L(ve,Pe);var ii={2:"touch",3:"pen",4:"mouse"};ve.prototype.h=function(){ve.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var ln="closure_listenable_"+(1e6*Math.random()|0),si=0;function oi(o,u,f,_,P){this.listener=o,this.proxy=null,this.src=u,this.type=f,this.capture=!!_,this.ha=P,this.key=++si,this.da=this.fa=!1}function hn(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function nt(o){this.src=o,this.g={},this.h=0}nt.prototype.add=function(o,u,f,_,P){var D=o.toString();o=this.g[D],o||(o=this.g[D]=[],this.h++);var U=Dn(o,u,_,P);return-1<U?(u=o[U],f||(u.fa=!1)):(u=new oi(u,this.src,D,!!_,P),u.fa=f,o.push(u)),u};function dn(o,u){var f=u.type;if(f in o.g){var _=o.g[f],P=Array.prototype.indexOf.call(_,u,void 0),D;(D=0<=P)&&Array.prototype.splice.call(_,P,1),D&&(hn(u),o.g[f].length==0&&(delete o.g[f],o.h--))}}function Dn(o,u,f,_){for(var P=0;P<o.length;++P){var D=o[P];if(!D.da&&D.listener==u&&D.capture==!!f&&D.ha==_)return P}return-1}var hr="closure_lm_"+(1e6*Math.random()|0),On={};function vt(o,u,f,_,P){if(Array.isArray(u)){for(var D=0;D<u.length;D++)vt(o,u[D],f,_,P);return null}return f=We(f),o&&o[ln]?o.K(u,f,m(_)?!!_.capture:!1,P):fn(o,u,f,!1,_,P)}function fn(o,u,f,_,P,D){if(!u)throw Error("Invalid event type");var U=m(P)?!!P.capture:!!P,ae=Vn(o);if(ae||(o[hr]=ae=new nt(o)),f=ae.add(u,f,_,U,D),f.proxy)return f;if(_=Fs(),f.proxy=_,_.src=o,_.listener=f,o.addEventListener)Ee||(P=U),P===void 0&&(P=!1),o.addEventListener(u.toString(),_,P);else if(o.attachEvent)o.attachEvent(ci(u.toString()),_);else if(o.addListener&&o.removeListener)o.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return f}function Fs(){function o(f){return u.call(o.src,o.listener,f)}const u=Bs;return o}function ai(o,u,f,_,P){if(Array.isArray(u))for(var D=0;D<u.length;D++)ai(o,u[D],f,_,P);else _=m(_)?!!_.capture:!!_,f=We(f),o&&o[ln]?(o=o.i,u=String(u).toString(),u in o.g&&(D=o.g[u],f=Dn(D,f,_,P),-1<f&&(hn(D[f]),Array.prototype.splice.call(D,f,1),D.length==0&&(delete o.g[u],o.h--)))):o&&(o=Vn(o))&&(u=o.g[u.toString()],o=-1,u&&(o=Dn(u,f,_,P)),(f=-1<o?u[o]:null)&&pn(f))}function pn(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[ln])dn(u.i,o);else{var f=o.type,_=o.proxy;u.removeEventListener?u.removeEventListener(f,_,o.capture):u.detachEvent?u.detachEvent(ci(f),_):u.addListener&&u.removeListener&&u.removeListener(_),(f=Vn(u))?(dn(f,o),f.h==0&&(f.src=null,u[hr]=null)):hn(o)}}}function ci(o){return o in On?On[o]:On[o]="on"+o}function Bs(o,u){if(o.da)o=!0;else{u=new ve(u,this);var f=o.listener,_=o.ha||o.src;o.fa&&pn(o),o=f.call(_,u)}return o}function Vn(o){return o=o[hr],o instanceof nt?o:null}var Lt="__closure_events_fn_"+(1e9*Math.random()>>>0);function We(o){return typeof o=="function"?o:(o[Lt]||(o[Lt]=function(u){return o.handleEvent(u)}),o[Lt])}function Te(){ct.call(this),this.i=new nt(this),this.M=this,this.F=null}L(Te,ct),Te.prototype[ln]=!0,Te.prototype.removeEventListener=function(o,u,f,_){ai(this,o,u,f,_)};function ke(o,u){var f,_=o.F;if(_)for(f=[];_;_=_.F)f.push(_);if(o=o.M,_=u.type||u,typeof u=="string")u=new Pe(u,o);else if(u instanceof Pe)u.target=u.target||o;else{var P=u;u=new Pe(_,o),R(u,P)}if(P=!0,f)for(var D=f.length-1;0<=D;D--){var U=u.g=f[D];P=Ge(U,_,!0,u)&&P}if(U=u.g=o,P=Ge(U,_,!0,u)&&P,P=Ge(U,_,!1,u)&&P,f)for(D=0;D<f.length;D++)U=u.g=f[D],P=Ge(U,_,!1,u)&&P}Te.prototype.N=function(){if(Te.aa.N.call(this),this.i){var o=this.i,u;for(u in o.g){for(var f=o.g[u],_=0;_<f.length;_++)hn(f[_]);delete o.g[u],o.h--}}this.F=null},Te.prototype.K=function(o,u,f,_){return this.i.add(String(o),u,!1,f,_)},Te.prototype.L=function(o,u,f,_){return this.i.add(String(o),u,!0,f,_)};function Ge(o,u,f,_){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();for(var P=!0,D=0;D<u.length;++D){var U=u[D];if(U&&!U.da&&U.capture==f){var ae=U.listener,Ne=U.ha||U.src;U.fa&&dn(o.i,U),P=ae.call(Ne,_)!==!1&&P}}return P&&!_.defaultPrevented}function ui(o,u,f){if(typeof o=="function")f&&(o=I(o,f));else if(o&&typeof o.handleEvent=="function")o=I(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(u)?-1:c.setTimeout(o,u||0)}function g(o){o.g=ui(()=>{o.g=null,o.i&&(o.i=!1,g(o))},o.l);const u=o.h;o.h=null,o.m.apply(null,u)}class l extends ct{constructor(u,f){super(),this.m=u,this.l=f,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:g(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function d(o){ct.call(this),this.h=o,this.g={}}L(d,ct);var y=[];function A(o){se(o.g,function(u,f){this.g.hasOwnProperty(f)&&pn(u)},o),o.g={}}d.prototype.N=function(){d.aa.N.call(this),A(this)},d.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var k=c.JSON.stringify,O=c.JSON.parse,X=class{stringify(o){return c.JSON.stringify(o,void 0)}parse(o){return c.JSON.parse(o,void 0)}};function ce(){}ce.prototype.h=null;function oe(o){return o.h||(o.h=o.i())}function ue(){}var ne={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function js(){Pe.call(this,"d")}L(js,Pe);function $s(){Pe.call(this,"c")}L($s,Pe);var mn={},ja=null;function li(){return ja=ja||new Te}mn.La="serverreachability";function $a(o){Pe.call(this,mn.La,o)}L($a,Pe);function dr(o){const u=li();ke(u,new $a(u))}mn.STAT_EVENT="statevent";function qa(o,u){Pe.call(this,mn.STAT_EVENT,o),this.stat=u}L(qa,Pe);function je(o){const u=li();ke(u,new qa(u,o))}mn.Ma="timingevent";function Ha(o,u){Pe.call(this,mn.Ma,o),this.size=u}L(Ha,Pe);function fr(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){o()},u)}function pr(){this.g=!0}pr.prototype.xa=function(){this.g=!1};function tf(o,u,f,_,P,D){o.info(function(){if(o.g)if(D)for(var U="",ae=D.split("&"),Ne=0;Ne<ae.length;Ne++){var re=ae[Ne].split("=");if(1<re.length){var Le=re[0];re=re[1];var Me=Le.split("_");U=2<=Me.length&&Me[1]=="type"?U+(Le+"="+re+"&"):U+(Le+"=redacted&")}}else U=null;else U=D;return"XMLHTTP REQ ("+_+") [attempt "+P+"]: "+u+`
`+f+`
`+U})}function nf(o,u,f,_,P,D,U){o.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+P+"]: "+u+`
`+f+`
`+D+" "+U})}function Ln(o,u,f,_){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+sf(o,f)+(_?" "+_:"")})}function rf(o,u){o.info(function(){return"TIMEOUT: "+u})}pr.prototype.info=function(){};function sf(o,u){if(!o.g)return u;if(!u)return null;try{var f=JSON.parse(u);if(f){for(o=0;o<f.length;o++)if(Array.isArray(f[o])){var _=f[o];if(!(2>_.length)){var P=_[1];if(Array.isArray(P)&&!(1>P.length)){var D=P[0];if(D!="noop"&&D!="stop"&&D!="close")for(var U=1;U<P.length;U++)P[U]=""}}}}return k(f)}catch{return u}}var hi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},za={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},qs;function di(){}L(di,ce),di.prototype.g=function(){return new XMLHttpRequest},di.prototype.i=function(){return{}},qs=new di;function Mt(o,u,f,_){this.j=o,this.i=u,this.l=f,this.R=_||1,this.U=new d(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Wa}function Wa(){this.i=null,this.g="",this.h=!1}var Ga={},Hs={};function zs(o,u,f){o.L=1,o.v=gi(Tt(u)),o.m=f,o.P=!0,Ka(o,null)}function Ka(o,u){o.F=Date.now(),fi(o),o.A=Tt(o.v);var f=o.A,_=o.R;Array.isArray(_)||(_=[String(_)]),cc(f.i,"t",_),o.C=0,f=o.j.J,o.h=new Wa,o.g=Sc(o.j,f?u:null,!o.m),0<o.O&&(o.M=new l(I(o.Y,o,o.g),o.O)),u=o.U,f=o.g,_=o.ca;var P="readystatechange";Array.isArray(P)||(P&&(y[0]=P.toString()),P=y);for(var D=0;D<P.length;D++){var U=vt(f,P[D],_||u.handleEvent,!1,u.h||u);if(!U)break;u.g[U.key]=U}u=o.H?E(o.H):{},o.m?(o.u||(o.u="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,u)):(o.u="GET",o.g.ea(o.A,o.u,null,u)),dr(),tf(o.i,o.u,o.A,o.l,o.R,o.m)}Mt.prototype.ca=function(o){o=o.target;const u=this.M;u&&wt(o)==3?u.j():this.Y(o)},Mt.prototype.Y=function(o){try{if(o==this.g)e:{const Me=wt(this.g);var u=this.g.Ba();const Un=this.g.Z();if(!(3>Me)&&(Me!=3||this.g&&(this.h.h||this.g.oa()||mc(this.g)))){this.J||Me!=4||u==7||(u==8||0>=Un?dr(3):dr(2)),Ws(this);var f=this.g.Z();this.X=f;t:if(Qa(this)){var _=mc(this.g);o="";var P=_.length,D=wt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){gn(this),mr(this);var U="";break t}this.h.i=new c.TextDecoder}for(u=0;u<P;u++)this.h.h=!0,o+=this.h.i.decode(_[u],{stream:!(D&&u==P-1)});_.length=0,this.h.g+=o,this.C=0,U=this.h.g}else U=this.g.oa();if(this.o=f==200,nf(this.i,this.u,this.A,this.l,this.R,Me,f),this.o){if(this.T&&!this.K){t:{if(this.g){var ae,Ne=this.g;if((ae=Ne.g?Ne.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(ae)){var re=ae;break t}}re=null}if(f=re)Ln(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Gs(this,f);else{this.o=!1,this.s=3,je(12),gn(this),mr(this);break e}}if(this.P){f=!0;let rt;for(;!this.J&&this.C<U.length;)if(rt=of(this,U),rt==Hs){Me==4&&(this.s=4,je(14),f=!1),Ln(this.i,this.l,null,"[Incomplete Response]");break}else if(rt==Ga){this.s=4,je(15),Ln(this.i,this.l,U,"[Invalid Chunk]"),f=!1;break}else Ln(this.i,this.l,rt,null),Gs(this,rt);if(Qa(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Me!=4||U.length!=0||this.h.h||(this.s=1,je(16),f=!1),this.o=this.o&&f,!f)Ln(this.i,this.l,U,"[Invalid Chunked Response]"),gn(this),mr(this);else if(0<U.length&&!this.W){this.W=!0;var Le=this.j;Le.g==this&&Le.ba&&!Le.M&&(Le.j.info("Great, no buffering proxy detected. Bytes received: "+U.length),Zs(Le),Le.M=!0,je(11))}}else Ln(this.i,this.l,U,null),Gs(this,U);Me==4&&gn(this),this.o&&!this.J&&(Me==4?wc(this.j,this):(this.o=!1,fi(this)))}else If(this.g),f==400&&0<U.indexOf("Unknown SID")?(this.s=3,je(12)):(this.s=0,je(13)),gn(this),mr(this)}}}catch{}finally{}};function Qa(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function of(o,u){var f=o.C,_=u.indexOf(`
`,f);return _==-1?Hs:(f=Number(u.substring(f,_)),isNaN(f)?Ga:(_+=1,_+f>u.length?Hs:(u=u.slice(_,_+f),o.C=_+f,u)))}Mt.prototype.cancel=function(){this.J=!0,gn(this)};function fi(o){o.S=Date.now()+o.I,Ja(o,o.I)}function Ja(o,u){if(o.B!=null)throw Error("WatchDog timer not null");o.B=fr(I(o.ba,o),u)}function Ws(o){o.B&&(c.clearTimeout(o.B),o.B=null)}Mt.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(rf(this.i,this.A),this.L!=2&&(dr(),je(17)),gn(this),this.s=2,mr(this)):Ja(this,this.S-o)};function mr(o){o.j.G==0||o.J||wc(o.j,o)}function gn(o){Ws(o);var u=o.M;u&&typeof u.ma=="function"&&u.ma(),o.M=null,A(o.U),o.g&&(u=o.g,o.g=null,u.abort(),u.ma())}function Gs(o,u){try{var f=o.j;if(f.G!=0&&(f.g==o||Ks(f.h,o))){if(!o.K&&Ks(f.h,o)&&f.G==3){try{var _=f.Da.g.parse(u)}catch{_=null}if(Array.isArray(_)&&_.length==3){var P=_;if(P[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<o.F)wi(f),vi(f);else break e;Ys(f),je(18)}}else f.za=P[1],0<f.za-f.T&&37500>P[2]&&f.F&&f.v==0&&!f.C&&(f.C=fr(I(f.Za,f),6e3));if(1>=Za(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else yn(f,11)}else if((o.K||f.g==o)&&wi(f),!q(u))for(P=f.Da.g.parse(u),u=0;u<P.length;u++){let re=P[u];if(f.T=re[0],re=re[1],f.G==2)if(re[0]=="c"){f.K=re[1],f.ia=re[2];const Le=re[3];Le!=null&&(f.la=Le,f.j.info("VER="+f.la));const Me=re[4];Me!=null&&(f.Aa=Me,f.j.info("SVER="+f.Aa));const Un=re[5];Un!=null&&typeof Un=="number"&&0<Un&&(_=1.5*Un,f.L=_,f.j.info("backChannelRequestTimeoutMs_="+_)),_=f;const rt=o.g;if(rt){const Ai=rt.g?rt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ai){var D=_.h;D.g||Ai.indexOf("spdy")==-1&&Ai.indexOf("quic")==-1&&Ai.indexOf("h2")==-1||(D.j=D.l,D.g=new Set,D.h&&(Qs(D,D.h),D.h=null))}if(_.D){const eo=rt.g?rt.g.getResponseHeader("X-HTTP-Session-Id"):null;eo&&(_.ya=eo,le(_.I,_.D,eo))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-o.F,f.j.info("Handshake RTT: "+f.R+"ms")),_=f;var U=o;if(_.qa=Rc(_,_.J?_.ia:null,_.W),U.K){ec(_.h,U);var ae=U,Ne=_.L;Ne&&(ae.I=Ne),ae.B&&(Ws(ae),fi(ae)),_.g=U}else vc(_);0<f.i.length&&Ti(f)}else re[0]!="stop"&&re[0]!="close"||yn(f,7);else f.G==3&&(re[0]=="stop"||re[0]=="close"?re[0]=="stop"?yn(f,7):Xs(f):re[0]!="noop"&&f.l&&f.l.ta(re),f.v=0)}}dr(4)}catch{}}var af=class{constructor(o,u){this.g=o,this.map=u}};function Xa(o){this.l=o||10,c.PerformanceNavigationTiming?(o=c.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ya(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Za(o){return o.h?1:o.g?o.g.size:0}function Ks(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function Qs(o,u){o.g?o.g.add(u):o.h=u}function ec(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}Xa.prototype.cancel=function(){if(this.i=tc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function tc(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let u=o.i;for(const f of o.g.values())u=u.concat(f.D);return u}return F(o.i)}function cf(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(h(o)){for(var u=[],f=o.length,_=0;_<f;_++)u.push(o[_]);return u}u=[],f=0;for(_ in o)u[f++]=o[_];return u}function uf(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(h(o)||typeof o=="string"){var u=[];o=o.length;for(var f=0;f<o;f++)u.push(f);return u}u=[],f=0;for(const _ in o)u[f++]=_;return u}}}function nc(o,u){if(o.forEach&&typeof o.forEach=="function")o.forEach(u,void 0);else if(h(o)||typeof o=="string")Array.prototype.forEach.call(o,u,void 0);else for(var f=uf(o),_=cf(o),P=_.length,D=0;D<P;D++)u.call(void 0,_[D],f&&f[D],o)}var rc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function lf(o,u){if(o){o=o.split("&");for(var f=0;f<o.length;f++){var _=o[f].indexOf("="),P=null;if(0<=_){var D=o[f].substring(0,_);P=o[f].substring(_+1)}else D=o[f];u(D,P?decodeURIComponent(P.replace(/\+/g," ")):"")}}}function _n(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof _n){this.h=o.h,pi(this,o.j),this.o=o.o,this.g=o.g,mi(this,o.s),this.l=o.l;var u=o.i,f=new yr;f.i=u.i,u.g&&(f.g=new Map(u.g),f.h=u.h),ic(this,f),this.m=o.m}else o&&(u=String(o).match(rc))?(this.h=!1,pi(this,u[1]||"",!0),this.o=gr(u[2]||""),this.g=gr(u[3]||"",!0),mi(this,u[4]),this.l=gr(u[5]||"",!0),ic(this,u[6]||"",!0),this.m=gr(u[7]||"")):(this.h=!1,this.i=new yr(null,this.h))}_n.prototype.toString=function(){var o=[],u=this.j;u&&o.push(_r(u,sc,!0),":");var f=this.g;return(f||u=="file")&&(o.push("//"),(u=this.o)&&o.push(_r(u,sc,!0),"@"),o.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&o.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(_r(f,f.charAt(0)=="/"?ff:df,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",_r(f,mf)),o.join("")};function Tt(o){return new _n(o)}function pi(o,u,f){o.j=f?gr(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function mi(o,u){if(u){if(u=Number(u),isNaN(u)||0>u)throw Error("Bad port number "+u);o.s=u}else o.s=null}function ic(o,u,f){u instanceof yr?(o.i=u,gf(o.i,o.h)):(f||(u=_r(u,pf)),o.i=new yr(u,o.h))}function le(o,u,f){o.i.set(u,f)}function gi(o){return le(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function gr(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function _r(o,u,f){return typeof o=="string"?(o=encodeURI(o).replace(u,hf),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function hf(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var sc=/[#\/\?@]/g,df=/[#\?:]/g,ff=/[#\?]/g,pf=/[#\?@]/g,mf=/#/g;function yr(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function xt(o){o.g||(o.g=new Map,o.h=0,o.i&&lf(o.i,function(u,f){o.add(decodeURIComponent(u.replace(/\+/g," ")),f)}))}n=yr.prototype,n.add=function(o,u){xt(this),this.i=null,o=Mn(this,o);var f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(u),this.h+=1,this};function oc(o,u){xt(o),u=Mn(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function ac(o,u){return xt(o),u=Mn(o,u),o.g.has(u)}n.forEach=function(o,u){xt(this),this.g.forEach(function(f,_){f.forEach(function(P){o.call(u,P,_,this)},this)},this)},n.na=function(){xt(this);const o=Array.from(this.g.values()),u=Array.from(this.g.keys()),f=[];for(let _=0;_<u.length;_++){const P=o[_];for(let D=0;D<P.length;D++)f.push(u[_])}return f},n.V=function(o){xt(this);let u=[];if(typeof o=="string")ac(this,o)&&(u=u.concat(this.g.get(Mn(this,o))));else{o=Array.from(this.g.values());for(let f=0;f<o.length;f++)u=u.concat(o[f])}return u},n.set=function(o,u){return xt(this),this.i=null,o=Mn(this,o),ac(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},n.get=function(o,u){return o?(o=this.V(o),0<o.length?String(o[0]):u):u};function cc(o,u,f){oc(o,u),0<f.length&&(o.i=null,o.g.set(Mn(o,u),F(f)),o.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],u=Array.from(this.g.keys());for(var f=0;f<u.length;f++){var _=u[f];const D=encodeURIComponent(String(_)),U=this.V(_);for(_=0;_<U.length;_++){var P=D;U[_]!==""&&(P+="="+encodeURIComponent(String(U[_]))),o.push(P)}}return this.i=o.join("&")};function Mn(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function gf(o,u){u&&!o.j&&(xt(o),o.i=null,o.g.forEach(function(f,_){var P=_.toLowerCase();_!=P&&(oc(this,_),cc(this,P,f))},o)),o.j=u}function _f(o,u){const f=new pr;if(c.Image){const _=new Image;_.onload=N(Ut,f,"TestLoadImage: loaded",!0,u,_),_.onerror=N(Ut,f,"TestLoadImage: error",!1,u,_),_.onabort=N(Ut,f,"TestLoadImage: abort",!1,u,_),_.ontimeout=N(Ut,f,"TestLoadImage: timeout",!1,u,_),c.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=o}else u(!1)}function yf(o,u){const f=new pr,_=new AbortController,P=setTimeout(()=>{_.abort(),Ut(f,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:_.signal}).then(D=>{clearTimeout(P),D.ok?Ut(f,"TestPingServer: ok",!0,u):Ut(f,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(P),Ut(f,"TestPingServer: error",!1,u)})}function Ut(o,u,f,_,P){try{P&&(P.onload=null,P.onerror=null,P.onabort=null,P.ontimeout=null),_(f)}catch{}}function Ef(){this.g=new X}function vf(o,u,f){const _=f||"";try{nc(o,function(P,D){let U=P;m(P)&&(U=k(P)),u.push(_+D+"="+encodeURIComponent(U))})}catch(P){throw u.push(_+"type="+encodeURIComponent("_badmap")),P}}function _i(o){this.l=o.Ub||null,this.j=o.eb||!1}L(_i,ce),_i.prototype.g=function(){return new yi(this.l,this.j)},_i.prototype.i=(function(o){return function(){return o}})({});function yi(o,u){Te.call(this),this.D=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}L(yi,Te),n=yi.prototype,n.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=u,this.readyState=1,vr(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const u={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(u.body=o),(this.D||c).fetch(new Request(this.A,u)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Er(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,vr(this)),this.g&&(this.readyState=3,vr(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;uc(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function uc(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.v.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?Er(this):vr(this),this.readyState==3&&uc(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,Er(this))},n.Qa=function(o){this.g&&(this.response=o,Er(this))},n.ga=function(){this.g&&Er(this)};function Er(o){o.readyState=4,o.l=null,o.j=null,o.v=null,vr(o)}n.setRequestHeader=function(o,u){this.u.append(o,u)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],u=this.h.entries();for(var f=u.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=u.next();return o.join(`\r
`)};function vr(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(yi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function lc(o){let u="";return se(o,function(f,_){u+=_,u+=":",u+=f,u+=`\r
`}),u}function Js(o,u,f){e:{for(_ in f){var _=!1;break e}_=!0}_||(f=lc(f),typeof o=="string"?f!=null&&encodeURIComponent(String(f)):le(o,u,f))}function me(o){Te.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}L(me,Te);var Tf=/^https?$/i,wf=["POST","PUT"];n=me.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,u,f,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():qs.g(),this.v=this.o?oe(this.o):oe(qs),this.g.onreadystatechange=I(this.Ea,this);try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(D){hc(this,D);return}if(o=f||"",f=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var P in _)f.set(P,_[P]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const D of _.keys())f.set(D,_.get(D));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(f.keys()).find(D=>D.toLowerCase()=="content-type"),P=c.FormData&&o instanceof c.FormData,!(0<=Array.prototype.indexOf.call(wf,u,void 0))||_||P||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[D,U]of f)this.g.setRequestHeader(D,U);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{pc(this),this.u=!0,this.g.send(o),this.u=!1}catch(D){hc(this,D)}};function hc(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.m=5,dc(o),Ei(o)}function dc(o){o.A||(o.A=!0,ke(o,"complete"),ke(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,ke(this,"complete"),ke(this,"abort"),Ei(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ei(this,!0)),me.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?fc(this):this.bb())},n.bb=function(){fc(this)};function fc(o){if(o.h&&typeof a<"u"&&(!o.v[1]||wt(o)!=4||o.Z()!=2)){if(o.u&&wt(o)==4)ui(o.Ea,0,o);else if(ke(o,"readystatechange"),wt(o)==4){o.h=!1;try{const U=o.Z();e:switch(U){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var f;if(!(f=u)){var _;if(_=U===0){var P=String(o.D).match(rc)[1]||null;!P&&c.self&&c.self.location&&(P=c.self.location.protocol.slice(0,-1)),_=!Tf.test(P?P.toLowerCase():"")}f=_}if(f)ke(o,"complete"),ke(o,"success");else{o.m=6;try{var D=2<wt(o)?o.g.statusText:""}catch{D=""}o.l=D+" ["+o.Z()+"]",dc(o)}}finally{Ei(o)}}}}function Ei(o,u){if(o.g){pc(o);const f=o.g,_=o.v[0]?()=>{}:null;o.g=null,o.v=null,u||ke(o,"ready");try{f.onreadystatechange=_}catch{}}}function pc(o){o.I&&(c.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function wt(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<wt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),O(u)}};function mc(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function If(o){const u={};o=(o.g&&2<=wt(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<o.length;_++){if(q(o[_]))continue;var f=b(o[_]);const P=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const D=u[P]||[];u[P]=D,D.push(f)}S(u,function(_){return _.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Tr(o,u,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||u}function gc(o){this.Aa=0,this.i=[],this.j=new pr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Tr("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Tr("baseRetryDelayMs",5e3,o),this.cb=Tr("retryDelaySeedMs",1e4,o),this.Wa=Tr("forwardChannelMaxRetries",2,o),this.wa=Tr("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Xa(o&&o.concurrentRequestLimit),this.Da=new Ef,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=gc.prototype,n.la=8,n.G=1,n.connect=function(o,u,f,_){je(0),this.W=o,this.H=u||{},f&&_!==void 0&&(this.H.OSID=f,this.H.OAID=_),this.F=this.X,this.I=Rc(this,null,this.W),Ti(this)};function Xs(o){if(_c(o),o.G==3){var u=o.U++,f=Tt(o.I);if(le(f,"SID",o.K),le(f,"RID",u),le(f,"TYPE","terminate"),wr(o,f),u=new Mt(o,o.j,u),u.L=2,u.v=gi(Tt(f)),f=!1,c.navigator&&c.navigator.sendBeacon)try{f=c.navigator.sendBeacon(u.v.toString(),"")}catch{}!f&&c.Image&&(new Image().src=u.v,f=!0),f||(u.g=Sc(u.j,null),u.g.ea(u.v)),u.F=Date.now(),fi(u)}Ac(o)}function vi(o){o.g&&(Zs(o),o.g.cancel(),o.g=null)}function _c(o){vi(o),o.u&&(c.clearTimeout(o.u),o.u=null),wi(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&c.clearTimeout(o.s),o.s=null)}function Ti(o){if(!Ya(o.h)&&!o.s){o.s=!0;var u=o.Ga;Ot||ri(),Vt||(Ot(),Vt=!0),lr.add(u,o),o.B=0}}function Af(o,u){return Za(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=u.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=fr(I(o.Ga,o,u),Ic(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const P=new Mt(this,this.j,o);let D=this.o;if(this.S&&(D?(D=E(D),R(D,this.S)):D=this.S),this.m!==null||this.O||(P.H=D,D=null),this.P)e:{for(var u=0,f=0;f<this.i.length;f++){t:{var _=this.i[f];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(u+=_,4096<u){u=f;break e}if(u===4096||f===this.i.length-1){u=f+1;break e}}u=1e3}else u=1e3;u=Ec(this,P,u),f=Tt(this.I),le(f,"RID",o),le(f,"CVER",22),this.D&&le(f,"X-HTTP-Session-Id",this.D),wr(this,f),D&&(this.O?u="headers="+encodeURIComponent(String(lc(D)))+"&"+u:this.m&&Js(f,this.m,D)),Qs(this.h,P),this.Ua&&le(f,"TYPE","init"),this.P?(le(f,"$req",u),le(f,"SID","null"),P.T=!0,zs(P,f,null)):zs(P,f,u),this.G=2}}else this.G==3&&(o?yc(this,o):this.i.length==0||Ya(this.h)||yc(this))};function yc(o,u){var f;u?f=u.l:f=o.U++;const _=Tt(o.I);le(_,"SID",o.K),le(_,"RID",f),le(_,"AID",o.T),wr(o,_),o.m&&o.o&&Js(_,o.m,o.o),f=new Mt(o,o.j,f,o.B+1),o.m===null&&(f.H=o.o),u&&(o.i=u.D.concat(o.i)),u=Ec(o,f,1e3),f.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),Qs(o.h,f),zs(f,_,u)}function wr(o,u){o.H&&se(o.H,function(f,_){le(u,_,f)}),o.l&&nc({},function(f,_){le(u,_,f)})}function Ec(o,u,f){f=Math.min(o.i.length,f);var _=o.l?I(o.l.Na,o.l,o):null;e:{var P=o.i;let D=-1;for(;;){const U=["count="+f];D==-1?0<f?(D=P[0].g,U.push("ofs="+D)):D=0:U.push("ofs="+D);let ae=!0;for(let Ne=0;Ne<f;Ne++){let re=P[Ne].g;const Le=P[Ne].map;if(re-=D,0>re)D=Math.max(0,P[Ne].g-100),ae=!1;else try{vf(Le,U,"req"+re+"_")}catch{_&&_(Le)}}if(ae){_=U.join("&");break e}}}return o=o.i.splice(0,f),u.D=o,_}function vc(o){if(!o.g&&!o.u){o.Y=1;var u=o.Fa;Ot||ri(),Vt||(Ot(),Vt=!0),lr.add(u,o),o.v=0}}function Ys(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=fr(I(o.Fa,o),Ic(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,Tc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=fr(I(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,je(10),vi(this),Tc(this))};function Zs(o){o.A!=null&&(c.clearTimeout(o.A),o.A=null)}function Tc(o){o.g=new Mt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var u=Tt(o.qa);le(u,"RID","rpc"),le(u,"SID",o.K),le(u,"AID",o.T),le(u,"CI",o.F?"0":"1"),!o.F&&o.ja&&le(u,"TO",o.ja),le(u,"TYPE","xmlhttp"),wr(o,u),o.m&&o.o&&Js(u,o.m,o.o),o.L&&(o.g.I=o.L);var f=o.g;o=o.ia,f.L=1,f.v=gi(Tt(u)),f.m=null,f.P=!0,Ka(f,o)}n.Za=function(){this.C!=null&&(this.C=null,vi(this),Ys(this),je(19))};function wi(o){o.C!=null&&(c.clearTimeout(o.C),o.C=null)}function wc(o,u){var f=null;if(o.g==u){wi(o),Zs(o),o.g=null;var _=2}else if(Ks(o.h,u))f=u.D,ec(o.h,u),_=1;else return;if(o.G!=0){if(u.o)if(_==1){f=u.m?u.m.length:0,u=Date.now()-u.F;var P=o.B;_=li(),ke(_,new Ha(_,f)),Ti(o)}else vc(o);else if(P=u.s,P==3||P==0&&0<u.X||!(_==1&&Af(o,u)||_==2&&Ys(o)))switch(f&&0<f.length&&(u=o.h,u.i=u.i.concat(f)),P){case 1:yn(o,5);break;case 4:yn(o,10);break;case 3:yn(o,6);break;default:yn(o,2)}}}function Ic(o,u){let f=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(f*=2),f*u}function yn(o,u){if(o.j.info("Error code "+u),u==2){var f=I(o.fb,o),_=o.Xa;const P=!_;_=new _n(_||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||pi(_,"https"),gi(_),P?_f(_.toString(),f):yf(_.toString(),f)}else je(2);o.G=0,o.l&&o.l.sa(u),Ac(o),_c(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),je(2)):(this.j.info("Failed to ping google.com"),je(1))};function Ac(o){if(o.G=0,o.ka=[],o.l){const u=tc(o.h);(u.length!=0||o.i.length!=0)&&(x(o.ka,u),x(o.ka,o.i),o.h.i.length=0,F(o.i),o.i.length=0),o.l.ra()}}function Rc(o,u,f){var _=f instanceof _n?Tt(f):new _n(f);if(_.g!="")u&&(_.g=u+"."+_.g),mi(_,_.s);else{var P=c.location;_=P.protocol,u=u?u+"."+P.hostname:P.hostname,P=+P.port;var D=new _n(null);_&&pi(D,_),u&&(D.g=u),P&&mi(D,P),f&&(D.l=f),_=D}return f=o.D,u=o.ya,f&&u&&le(_,f,u),le(_,"VER",o.la),wr(o,_),_}function Sc(o,u,f){if(u&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Ca&&!o.pa?new me(new _i({eb:f})):new me(o.pa),u.Ha(o.J),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function bc(){}n=bc.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ii(){}Ii.prototype.g=function(o,u){return new Ke(o,u)};function Ke(o,u){Te.call(this),this.g=new gc(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.va&&(o?o["X-WebChannel-Client-Profile"]=u.va:o={"X-WebChannel-Client-Profile":u.va}),this.g.S=o,(o=u&&u.Sb)&&!q(o)&&(this.g.m=o),this.v=u&&u.supportsCrossDomainXhr||!1,this.u=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!q(u)&&(this.g.D=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new xn(this)}L(Ke,Te),Ke.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ke.prototype.close=function(){Xs(this.g)},Ke.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.u&&(f={},f.__data__=k(o),o=f);u.i.push(new af(u.Ya++,o)),u.G==3&&Ti(u)},Ke.prototype.N=function(){this.g.l=null,delete this.j,Xs(this.g),delete this.g,Ke.aa.N.call(this)};function Pc(o){js.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(const f in u){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}L(Pc,js);function Cc(){$s.call(this),this.status=1}L(Cc,$s);function xn(o){this.g=o}L(xn,bc),xn.prototype.ua=function(){ke(this.g,"a")},xn.prototype.ta=function(o){ke(this.g,new Pc(o))},xn.prototype.sa=function(o){ke(this.g,new Cc)},xn.prototype.ra=function(){ke(this.g,"b")},Ii.prototype.createWebChannel=Ii.prototype.g,Ke.prototype.send=Ke.prototype.o,Ke.prototype.open=Ke.prototype.m,Ke.prototype.close=Ke.prototype.close,uh=function(){return new Ii},ch=function(){return li()},ah=mn,Ao={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},hi.NO_ERROR=0,hi.TIMEOUT=8,hi.HTTP_ERROR=6,xi=hi,za.COMPLETE="complete",oh=za,ue.EventType=ne,ne.OPEN="a",ne.CLOSE="b",ne.ERROR="c",ne.MESSAGE="d",Te.prototype.listen=Te.prototype.K,Sr=ue,me.prototype.listenOnce=me.prototype.L,me.prototype.getLastError=me.prototype.Ka,me.prototype.getLastErrorCode=me.prototype.Ba,me.prototype.getStatus=me.prototype.Z,me.prototype.getResponseJson=me.prototype.Oa,me.prototype.getResponseText=me.prototype.oa,me.prototype.send=me.prototype.ea,me.prototype.setWithCredentials=me.prototype.Ha,sh=me}).apply(typeof Si<"u"?Si:typeof self<"u"?self:typeof window<"u"?window:{});const cu="@firebase/firestore",uu="4.8.0";class Ue{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ue.UNAUTHENTICATED=new Ue(null),Ue.GOOGLE_CREDENTIALS=new Ue("google-credentials-uid"),Ue.FIRST_PARTY=new Ue("first-party-uid"),Ue.MOCK_USER=new Ue("mock-user");let sr="11.10.0";const Rn=new Wo("@firebase/firestore");function Bn(){return Rn.logLevel}function B(n,...e){if(Rn.logLevel<=Z.DEBUG){const t=e.map(na);Rn.debug(`Firestore (${sr}): ${n}`,...t)}}function Ct(n,...e){if(Rn.logLevel<=Z.ERROR){const t=e.map(na);Rn.error(`Firestore (${sr}): ${n}`,...t)}}function Yt(n,...e){if(Rn.logLevel<=Z.WARN){const t=e.map(na);Rn.warn(`Firestore (${sr}): ${n}`,...t)}}function na(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function W(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,lh(n,r,t)}function lh(n,e,t){let r=`FIRESTORE (${sr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Ct(r),new Error(r)}function ie(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||lh(e,i,r)}function K(n,e){return n}const M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class j extends at{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Rt{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class hh{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class b_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ue.UNAUTHENTICATED)))}shutdown(){}}class P_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class C_{constructor(e){this.t=e,this.currentUser=Ue.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ie(this.o===void 0,42304);let r=this.i;const i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let s=new Rt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Rt,e.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const h=s;e.enqueueRetryable((async()=>{await h.promise,await i(this.currentUser)}))},c=h=>{B("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((h=>c(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?c(h):(B("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Rt)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(B("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ie(typeof r.accessToken=="string",31837,{l:r}),new hh(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ie(e===null||typeof e=="string",2055,{h:e}),new Ue(e)}}class k_{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ue.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class N_{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new k_(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ue.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class lu{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class D_{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Qe(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ie(this.o===void 0,3512);const r=s=>{s.error!=null&&B("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,B("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{B("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):B("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new lu(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ie(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new lu(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function O_(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function dh(){return new TextEncoder}class ra{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=O_(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function Y(n,e){return n<e?-1:n>e?1:0}function Ro(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return Y(r,i);{const s=dh(),a=V_(s.encode(hu(n,t)),s.encode(hu(e,t)));return a!==0?a:Y(r,i)}}t+=r>65535?2:1}return Y(n.length,e.length)}function hu(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function V_(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Y(n[t],e[t]);return Y(n.length,e.length)}function Xn(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}const du="__name__";class ut{constructor(e,t,r){t===void 0?t=0:t>e.length&&W(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&W(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return ut.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ut?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=ut.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return Y(e.length,t.length)}static compareSegments(e,t){const r=ut.isNumericId(e),i=ut.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?ut.extractNumericId(e).compare(ut.extractNumericId(t)):Ro(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Qt.fromString(e.substring(4,e.length-2))}}class he extends ut{construct(e,t,r){return new he(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new j(M.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new he(t)}static emptyPath(){return new he([])}}const L_=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Oe extends ut{construct(e,t,r){return new Oe(e,t,r)}static isValidIdentifier(e){return L_.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Oe.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===du}static keyField(){return new Oe([du])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new j(M.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new j(M.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new j(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else c==="`"?(a=!a,i++):c!=="."||a?(r+=c,i++):(s(),i++)}if(s(),a)throw new j(M.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Oe(t)}static emptyPath(){return new Oe([])}}class ${constructor(e){this.path=e}static fromPath(e){return new $(he.fromString(e))}static fromName(e){return new $(he.fromString(e).popFirst(5))}static empty(){return new $(he.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&he.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return he.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $(new he(e.slice()))}}function fh(n,e,t){if(!t)throw new j(M.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function M_(n,e,t,r){if(e===!0&&r===!0)throw new j(M.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function fu(n){if(!$.isDocumentKey(n))throw new j(M.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function pu(n){if($.isDocumentKey(n))throw new j(M.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ph(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ia(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":W(12329,{type:typeof n})}function kt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new j(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ia(n);throw new j(M.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Ie(n,e){const t={typeString:n};return e&&(t.value=e),t}function Yr(n,e){if(!ph(n))throw new j(M.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new j(M.INVALID_ARGUMENT,t);return!0}const mu=-62135596800,gu=1e6;class de{static now(){return de.fromMillis(Date.now())}static fromDate(e){return de.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*gu);return new de(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new j(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new j(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<mu)throw new j(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new j(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/gu}_compareTo(e){return this.seconds===e.seconds?Y(this.nanoseconds,e.nanoseconds):Y(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:de._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Yr(e,de._jsonSchema))return new de(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-mu;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}de._jsonSchemaVersion="firestore/timestamp/1.0",de._jsonSchema={type:Ie("string",de._jsonSchemaVersion),seconds:Ie("number"),nanoseconds:Ie("number")};class G{static fromTimestamp(e){return new G(e)}static min(){return new G(new de(0,0))}static max(){return new G(new de(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Br=-1;function x_(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=G.fromTimestamp(r===1e9?new de(t+1,0):new de(t,r));return new Zt(i,$.empty(),e)}function U_(n){return new Zt(n.readTime,n.key,Br)}class Zt{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Zt(G.min(),$.empty(),Br)}static max(){return new Zt(G.max(),$.empty(),Br)}}function F_(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=$.comparator(n.documentKey,e.documentKey),t!==0?t:Y(n.largestBatchId,e.largestBatchId))}const B_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class j_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function or(n){if(n.code!==M.FAILED_PRECONDITION||n.message!==B_)throw n;B("LocalStore","Unexpectedly lost primary lease")}class V{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&W(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new V(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof V?t:V.resolve(t)}catch(t){return V.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):V.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):V.reject(t)}static resolve(e){return new V(((t,r)=>{t(e)}))}static reject(e){return new V(((t,r)=>{r(e)}))}static waitFor(e){return new V(((t,r)=>{let i=0,s=0,a=!1;e.forEach((c=>{++i,c.next((()=>{++s,a&&s===i&&t()}),(h=>r(h)))})),a=!0,s===i&&t()}))}static or(e){let t=V.resolve(!1);for(const r of e)t=t.next((i=>i?V.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new V(((r,i)=>{const s=e.length,a=new Array(s);let c=0;for(let h=0;h<s;h++){const m=h;t(e[m]).next((p=>{a[m]=p,++c,c===s&&r(a)}),(p=>i(p)))}}))}static doWhile(e,t){return new V(((r,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}}function $_(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ar(n){return n.name==="IndexedDbTransactionError"}class vs{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this._e(r),this.ae=r=>t.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}vs.ue=-1;const sa=-1;function Ts(n){return n==null}function Xi(n){return n===0&&1/n==-1/0}function q_(n){return typeof n=="number"&&Number.isInteger(n)&&!Xi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const mh="";function H_(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=_u(e)),e=z_(n.get(t),e);return _u(e)}function z_(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case mh:t+="";break;default:t+=s}}return t}function _u(n){return n+mh+""}function yu(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function an(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function gh(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class pe{constructor(e,t){this.comparator=e,this.root=t||De.EMPTY}insert(e,t){return new pe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,De.BLACK,null,null))}remove(e){return new pe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,De.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new bi(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new bi(this.root,e,this.comparator,!1)}getReverseIterator(){return new bi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new bi(this.root,e,this.comparator,!0)}}class bi{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class De{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??De.RED,this.left=i??De.EMPTY,this.right=s??De.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new De(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return De.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return De.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,De.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,De.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw W(43730,{key:this.key,value:this.value});if(this.right.isRed())throw W(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw W(27949);return e+(this.isRed()?0:1)}}De.EMPTY=null,De.RED=!0,De.BLACK=!1;De.EMPTY=new class{constructor(){this.size=0}get key(){throw W(57766)}get value(){throw W(16141)}get color(){throw W(16727)}get left(){throw W(29726)}get right(){throw W(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new De(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class be{constructor(e){this.comparator=e,this.data=new pe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Eu(this.data.getIterator())}getIteratorFrom(e){return new Eu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof be)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new be(this.comparator);return t.data=e,t}}class Eu{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Je{constructor(e){this.fields=e,e.sort(Oe.comparator)}static empty(){return new Je([])}unionWith(e){let t=new be(Oe.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Je(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xn(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class _h extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ve{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new _h("Invalid base64 string: "+s):s}})(e);return new Ve(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s})(e);return new Ve(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Y(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ve.EMPTY_BYTE_STRING=new Ve("");const W_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function en(n){if(ie(!!n,39018),typeof n=="string"){let e=0;const t=W_.exec(n);if(ie(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ye(n.seconds),nanos:ye(n.nanos)}}function ye(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function tn(n){return typeof n=="string"?Ve.fromBase64String(n):Ve.fromUint8Array(n)}const yh="server_timestamp",Eh="__type__",vh="__previous_value__",Th="__local_write_time__";function oa(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Eh])===null||t===void 0?void 0:t.stringValue)===yh}function ws(n){const e=n.mapValue.fields[vh];return oa(e)?ws(e):e}function jr(n){const e=en(n.mapValue.fields[Th].timestampValue);return new de(e.seconds,e.nanos)}class G_{constructor(e,t,r,i,s,a,c,h,m,p){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=h,this.useFetchStreams=m,this.isUsingEmulator=p}}const Yi="(default)";class $r{constructor(e,t){this.projectId=e,this.database=t||Yi}static empty(){return new $r("","")}get isDefaultDatabase(){return this.database===Yi}isEqual(e){return e instanceof $r&&e.projectId===this.projectId&&e.database===this.database}}const wh="__type__",K_="__max__",Pi={mapValue:{}},Ih="__vector__",Zi="value";function nn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?oa(n)?4:J_(n)?9007199254740991:Q_(n)?10:11:W(28295,{value:n})}function yt(n,e){if(n===e)return!0;const t=nn(n);if(t!==nn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return jr(n).isEqual(jr(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=en(i.timestampValue),c=en(s.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return tn(i.bytesValue).isEqual(tn(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return ye(i.geoPointValue.latitude)===ye(s.geoPointValue.latitude)&&ye(i.geoPointValue.longitude)===ye(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return ye(i.integerValue)===ye(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=ye(i.doubleValue),c=ye(s.doubleValue);return a===c?Xi(a)===Xi(c):isNaN(a)&&isNaN(c)}return!1})(n,e);case 9:return Xn(n.arrayValue.values||[],e.arrayValue.values||[],yt);case 10:case 11:return(function(i,s){const a=i.mapValue.fields||{},c=s.mapValue.fields||{};if(yu(a)!==yu(c))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(c[h]===void 0||!yt(a[h],c[h])))return!1;return!0})(n,e);default:return W(52216,{left:n})}}function qr(n,e){return(n.values||[]).find((t=>yt(t,e)))!==void 0}function Yn(n,e){if(n===e)return 0;const t=nn(n),r=nn(e);if(t!==r)return Y(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Y(n.booleanValue,e.booleanValue);case 2:return(function(s,a){const c=ye(s.integerValue||s.doubleValue),h=ye(a.integerValue||a.doubleValue);return c<h?-1:c>h?1:c===h?0:isNaN(c)?isNaN(h)?0:-1:1})(n,e);case 3:return vu(n.timestampValue,e.timestampValue);case 4:return vu(jr(n),jr(e));case 5:return Ro(n.stringValue,e.stringValue);case 6:return(function(s,a){const c=tn(s),h=tn(a);return c.compareTo(h)})(n.bytesValue,e.bytesValue);case 7:return(function(s,a){const c=s.split("/"),h=a.split("/");for(let m=0;m<c.length&&m<h.length;m++){const p=Y(c[m],h[m]);if(p!==0)return p}return Y(c.length,h.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,a){const c=Y(ye(s.latitude),ye(a.latitude));return c!==0?c:Y(ye(s.longitude),ye(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Tu(n.arrayValue,e.arrayValue);case 10:return(function(s,a){var c,h,m,p;const v=s.fields||{},I=a.fields||{},N=(c=v[Zi])===null||c===void 0?void 0:c.arrayValue,L=(h=I[Zi])===null||h===void 0?void 0:h.arrayValue,F=Y(((m=N?.values)===null||m===void 0?void 0:m.length)||0,((p=L?.values)===null||p===void 0?void 0:p.length)||0);return F!==0?F:Tu(N,L)})(n.mapValue,e.mapValue);case 11:return(function(s,a){if(s===Pi.mapValue&&a===Pi.mapValue)return 0;if(s===Pi.mapValue)return 1;if(a===Pi.mapValue)return-1;const c=s.fields||{},h=Object.keys(c),m=a.fields||{},p=Object.keys(m);h.sort(),p.sort();for(let v=0;v<h.length&&v<p.length;++v){const I=Ro(h[v],p[v]);if(I!==0)return I;const N=Yn(c[h[v]],m[p[v]]);if(N!==0)return N}return Y(h.length,p.length)})(n.mapValue,e.mapValue);default:throw W(23264,{le:t})}}function vu(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Y(n,e);const t=en(n),r=en(e),i=Y(t.seconds,r.seconds);return i!==0?i:Y(t.nanos,r.nanos)}function Tu(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Yn(t[i],r[i]);if(s)return s}return Y(t.length,r.length)}function Zn(n){return So(n)}function So(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=en(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return tn(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return $.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=So(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${So(t.fields[a])}`;return i+"}"})(n.mapValue):W(61005,{value:n})}function Ui(n){switch(nn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ws(n);return e?16+Ui(e):16;case 5:return 2*n.stringValue.length;case 6:return tn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+Ui(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return an(r.fields,((s,a)=>{i+=s.length+Ui(a)})),i})(n.mapValue);default:throw W(13486,{value:n})}}function bo(n){return!!n&&"integerValue"in n}function aa(n){return!!n&&"arrayValue"in n}function wu(n){return!!n&&"nullValue"in n}function Iu(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Fi(n){return!!n&&"mapValue"in n}function Q_(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[wh])===null||t===void 0?void 0:t.stringValue)===Ih}function Dr(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return an(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Dr(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Dr(n.arrayValue.values[t]);return e}return Object.assign({},n)}function J_(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===K_}class He{constructor(e){this.value=e}static empty(){return new He({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Fi(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Dr(t)}setAll(e){let t=Oe.emptyPath(),r={},i=[];e.forEach(((a,c)=>{if(!t.isImmediateParentOf(c)){const h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=c.popLast()}a?r[c.lastSegment()]=Dr(a):i.push(c.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());Fi(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return yt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Fi(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){an(t,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new He(Dr(this.value))}}function Ah(n){const e=[];return an(n.fields,((t,r)=>{const i=new Oe([t]);if(Fi(r)){const s=Ah(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)})),new Je(e)}class Fe{constructor(e,t,r,i,s,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Fe(e,0,G.min(),G.min(),G.min(),He.empty(),0)}static newFoundDocument(e,t,r,i){return new Fe(e,1,t,G.min(),r,i,0)}static newNoDocument(e,t){return new Fe(e,2,t,G.min(),G.min(),He.empty(),0)}static newUnknownDocument(e,t){return new Fe(e,3,t,G.min(),G.min(),He.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(G.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=He.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=He.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=G.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Fe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Fe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class es{constructor(e,t){this.position=e,this.inclusive=t}}function Au(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=$.comparator($.fromName(a.referenceValue),t.key):r=Yn(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ru(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!yt(n.position[t],e.position[t]))return!1;return!0}class ts{constructor(e,t="asc"){this.field=e,this.dir=t}}function X_(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Rh{}class Re extends Rh{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Z_(e,t,r):t==="array-contains"?new ny(e,r):t==="in"?new ry(e,r):t==="not-in"?new iy(e,r):t==="array-contains-any"?new sy(e,r):new Re(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new ey(e,r):new ty(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Yn(t,this.value)):t!==null&&nn(this.value)===nn(t)&&this.matchesComparison(Yn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return W(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Et extends Rh{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new Et(e,t)}matches(e){return Sh(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function Sh(n){return n.op==="and"}function bh(n){return Y_(n)&&Sh(n)}function Y_(n){for(const e of n.filters)if(e instanceof Et)return!1;return!0}function Po(n){if(n instanceof Re)return n.field.canonicalString()+n.op.toString()+Zn(n.value);if(bh(n))return n.filters.map((e=>Po(e))).join(",");{const e=n.filters.map((t=>Po(t))).join(",");return`${n.op}(${e})`}}function Ph(n,e){return n instanceof Re?(function(r,i){return i instanceof Re&&r.op===i.op&&r.field.isEqual(i.field)&&yt(r.value,i.value)})(n,e):n instanceof Et?(function(r,i){return i instanceof Et&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,a,c)=>s&&Ph(a,i.filters[c])),!0):!1})(n,e):void W(19439)}function Ch(n){return n instanceof Re?(function(t){return`${t.field.canonicalString()} ${t.op} ${Zn(t.value)}`})(n):n instanceof Et?(function(t){return t.op.toString()+" {"+t.getFilters().map(Ch).join(" ,")+"}"})(n):"Filter"}class Z_ extends Re{constructor(e,t,r){super(e,t,r),this.key=$.fromName(r.referenceValue)}matches(e){const t=$.comparator(e.key,this.key);return this.matchesComparison(t)}}class ey extends Re{constructor(e,t){super(e,"in",t),this.keys=kh("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class ty extends Re{constructor(e,t){super(e,"not-in",t),this.keys=kh("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function kh(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((r=>$.fromName(r.referenceValue)))}class ny extends Re{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return aa(t)&&qr(t.arrayValue,this.value)}}class ry extends Re{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&qr(this.value.arrayValue,t)}}class iy extends Re{constructor(e,t){super(e,"not-in",t)}matches(e){if(qr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!qr(this.value.arrayValue,t)}}class sy extends Re{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!aa(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>qr(this.value.arrayValue,r)))}}class oy{constructor(e,t=null,r=[],i=[],s=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=c,this.Pe=null}}function Su(n,e=null,t=[],r=[],i=null,s=null,a=null){return new oy(n,e,t,r,i,s,a)}function ca(n){const e=K(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Po(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),Ts(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Zn(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Zn(r))).join(",")),e.Pe=t}return e.Pe}function ua(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!X_(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Ph(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ru(n.startAt,e.startAt)&&Ru(n.endAt,e.endAt)}function Co(n){return $.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Is{constructor(e,t=null,r=[],i=[],s=null,a="F",c=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=c,this.endAt=h,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function ay(n,e,t,r,i,s,a,c){return new Is(n,e,t,r,i,s,a,c)}function la(n){return new Is(n)}function bu(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function cy(n){return n.collectionGroup!==null}function Or(n){const e=K(n);if(e.Te===null){e.Te=[];const t=new Set;for(const s of e.explicitOrderBy)e.Te.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new be(Oe.comparator);return a.filters.forEach((h=>{h.getFlattenedFilters().forEach((m=>{m.isInequality()&&(c=c.add(m.field))}))})),c})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Te.push(new ts(s,r))})),t.has(Oe.keyField().canonicalString())||e.Te.push(new ts(Oe.keyField(),r))}return e.Te}function pt(n){const e=K(n);return e.Ie||(e.Ie=uy(e,Or(n))),e.Ie}function uy(n,e){if(n.limitType==="F")return Su(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new ts(i.field,s)}));const t=n.endAt?new es(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new es(n.startAt.position,n.startAt.inclusive):null;return Su(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function ko(n,e,t){return new Is(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function As(n,e){return ua(pt(n),pt(e))&&n.limitType===e.limitType}function Nh(n){return`${ca(pt(n))}|lt:${n.limitType}`}function jn(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>Ch(i))).join(", ")}]`),Ts(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>Zn(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>Zn(i))).join(",")),`Target(${r})`})(pt(n))}; limitType=${n.limitType})`}function Rs(n,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):$.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(const s of Or(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,c,h){const m=Au(a,c,h);return a.inclusive?m<=0:m<0})(r.startAt,Or(r),i)||r.endAt&&!(function(a,c,h){const m=Au(a,c,h);return a.inclusive?m>=0:m>0})(r.endAt,Or(r),i))})(n,e)}function ly(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Dh(n){return(e,t)=>{let r=!1;for(const i of Or(n)){const s=hy(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function hy(n,e,t){const r=n.field.isKeyField()?$.comparator(e.key,t.key):(function(s,a,c){const h=a.data.field(s),m=c.data.field(s);return h!==null&&m!==null?Yn(h,m):W(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return W(19790,{direction:n.dir})}}class kn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){an(this.inner,((t,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return gh(this.inner)}size(){return this.innerSize}}const dy=new pe($.comparator);function Nt(){return dy}const Oh=new pe($.comparator);function br(...n){let e=Oh;for(const t of n)e=e.insert(t.key,t);return e}function Vh(n){let e=Oh;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function vn(){return Vr()}function Lh(){return Vr()}function Vr(){return new kn((n=>n.toString()),((n,e)=>n.isEqual(e)))}const fy=new pe($.comparator),py=new be($.comparator);function ee(...n){let e=py;for(const t of n)e=e.add(t);return e}const my=new be(Y);function gy(){return my}function ha(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xi(e)?"-0":e}}function Mh(n){return{integerValue:""+n}}function _y(n,e){return q_(e)?Mh(e):ha(n,e)}class Ss{constructor(){this._=void 0}}function yy(n,e,t){return n instanceof ns?(function(i,s){const a={fields:{[Eh]:{stringValue:yh},[Th]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&oa(s)&&(s=ws(s)),s&&(a.fields[vh]=s),{mapValue:a}})(t,e):n instanceof Hr?Uh(n,e):n instanceof zr?Fh(n,e):(function(i,s){const a=xh(i,s),c=Pu(a)+Pu(i.Ee);return bo(a)&&bo(i.Ee)?Mh(c):ha(i.serializer,c)})(n,e)}function Ey(n,e,t){return n instanceof Hr?Uh(n,e):n instanceof zr?Fh(n,e):t}function xh(n,e){return n instanceof rs?(function(r){return bo(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class ns extends Ss{}class Hr extends Ss{constructor(e){super(),this.elements=e}}function Uh(n,e){const t=Bh(e);for(const r of n.elements)t.some((i=>yt(i,r)))||t.push(r);return{arrayValue:{values:t}}}class zr extends Ss{constructor(e){super(),this.elements=e}}function Fh(n,e){let t=Bh(e);for(const r of n.elements)t=t.filter((i=>!yt(i,r)));return{arrayValue:{values:t}}}class rs extends Ss{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function Pu(n){return ye(n.integerValue||n.doubleValue)}function Bh(n){return aa(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function vy(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Hr&&i instanceof Hr||r instanceof zr&&i instanceof zr?Xn(r.elements,i.elements,yt):r instanceof rs&&i instanceof rs?yt(r.Ee,i.Ee):r instanceof ns&&i instanceof ns})(n.transform,e.transform)}class Ty{constructor(e,t){this.version=e,this.transformResults=t}}class st{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new st}static exists(e){return new st(void 0,e)}static updateTime(e){return new st(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bi(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class bs{}function jh(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new da(n.key,st.none()):new Zr(n.key,n.data,st.none());{const t=n.data,r=He.empty();let i=new be(Oe.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new cn(n.key,r,new Je(i.toArray()),st.none())}}function wy(n,e,t){n instanceof Zr?(function(i,s,a){const c=i.value.clone(),h=ku(i.fieldTransforms,s,a.transformResults);c.setAll(h),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()})(n,e,t):n instanceof cn?(function(i,s,a){if(!Bi(i.precondition,s))return void s.convertToUnknownDocument(a.version);const c=ku(i.fieldTransforms,s,a.transformResults),h=s.data;h.setAll($h(i)),h.setAll(c),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()})(n,e,t):(function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Lr(n,e,t,r){return n instanceof Zr?(function(s,a,c,h){if(!Bi(s.precondition,a))return c;const m=s.value.clone(),p=Nu(s.fieldTransforms,h,a);return m.setAll(p),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),null})(n,e,t,r):n instanceof cn?(function(s,a,c,h){if(!Bi(s.precondition,a))return c;const m=Nu(s.fieldTransforms,h,a),p=a.data;return p.setAll($h(s)),p.setAll(m),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((v=>v.field)))})(n,e,t,r):(function(s,a,c){return Bi(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c})(n,e,t)}function Iy(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=xh(r.transform,i||null);s!=null&&(t===null&&(t=He.empty()),t.set(r.field,s))}return t||null}function Cu(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Xn(r,i,((s,a)=>vy(s,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Zr extends bs{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class cn extends bs{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function $h(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function ku(n,e,t){const r=new Map;ie(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,c=e.data.field(s.field);r.set(s.field,Ey(a,c,t[i]))}return r}function Nu(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,yy(s,a,e))}return r}class da extends bs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ay extends bs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ry{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&wy(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Lr(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Lr(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Lh();return this.mutations.forEach((i=>{const s=e.get(i.key),a=s.overlayedDocument;let c=this.applyToLocalView(a,s.mutatedFields);c=t.has(i.key)?null:c;const h=jh(a,c);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(G.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ee())}isEqual(e){return this.batchId===e.batchId&&Xn(this.mutations,e.mutations,((t,r)=>Cu(t,r)))&&Xn(this.baseMutations,e.baseMutations,((t,r)=>Cu(t,r)))}}class fa{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ie(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let i=(function(){return fy})();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new fa(e,t,r,i)}}class Sy{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class by{constructor(e,t){this.count=e,this.unchangedNames=t}}var we,te;function Py(n){switch(n){case M.OK:return W(64938);case M.CANCELLED:case M.UNKNOWN:case M.DEADLINE_EXCEEDED:case M.RESOURCE_EXHAUSTED:case M.INTERNAL:case M.UNAVAILABLE:case M.UNAUTHENTICATED:return!1;case M.INVALID_ARGUMENT:case M.NOT_FOUND:case M.ALREADY_EXISTS:case M.PERMISSION_DENIED:case M.FAILED_PRECONDITION:case M.ABORTED:case M.OUT_OF_RANGE:case M.UNIMPLEMENTED:case M.DATA_LOSS:return!0;default:return W(15467,{code:n})}}function qh(n){if(n===void 0)return Ct("GRPC error has no .code"),M.UNKNOWN;switch(n){case we.OK:return M.OK;case we.CANCELLED:return M.CANCELLED;case we.UNKNOWN:return M.UNKNOWN;case we.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case we.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case we.INTERNAL:return M.INTERNAL;case we.UNAVAILABLE:return M.UNAVAILABLE;case we.UNAUTHENTICATED:return M.UNAUTHENTICATED;case we.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case we.NOT_FOUND:return M.NOT_FOUND;case we.ALREADY_EXISTS:return M.ALREADY_EXISTS;case we.PERMISSION_DENIED:return M.PERMISSION_DENIED;case we.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case we.ABORTED:return M.ABORTED;case we.OUT_OF_RANGE:return M.OUT_OF_RANGE;case we.UNIMPLEMENTED:return M.UNIMPLEMENTED;case we.DATA_LOSS:return M.DATA_LOSS;default:return W(39323,{code:n})}}(te=we||(we={}))[te.OK=0]="OK",te[te.CANCELLED=1]="CANCELLED",te[te.UNKNOWN=2]="UNKNOWN",te[te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",te[te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",te[te.NOT_FOUND=5]="NOT_FOUND",te[te.ALREADY_EXISTS=6]="ALREADY_EXISTS",te[te.PERMISSION_DENIED=7]="PERMISSION_DENIED",te[te.UNAUTHENTICATED=16]="UNAUTHENTICATED",te[te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",te[te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",te[te.ABORTED=10]="ABORTED",te[te.OUT_OF_RANGE=11]="OUT_OF_RANGE",te[te.UNIMPLEMENTED=12]="UNIMPLEMENTED",te[te.INTERNAL=13]="INTERNAL",te[te.UNAVAILABLE=14]="UNAVAILABLE",te[te.DATA_LOSS=15]="DATA_LOSS";const Cy=new Qt([4294967295,4294967295],0);function Du(n){const e=dh().encode(n),t=new ih;return t.update(e),new Uint8Array(t.digest())}function Ou(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Qt([t,r],0),new Qt([i,s],0)]}class pa{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Pr(`Invalid padding: ${t}`);if(r<0)throw new Pr(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Pr(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Pr(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Qt.fromNumber(this.fe)}pe(e,t,r){let i=e.add(t.multiply(Qt.fromNumber(r)));return i.compare(Cy)===1&&(i=new Qt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=Du(e),[r,i]=Ou(t);for(let s=0;s<this.hashCount;s++){const a=this.pe(r,i,s);if(!this.ye(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new pa(s,i,t);return r.forEach((c=>a.insert(c))),a}insert(e){if(this.fe===0)return;const t=Du(e),[r,i]=Ou(t);for(let s=0;s<this.hashCount;s++){const a=this.pe(r,i,s);this.we(a)}}we(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Pr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Ps{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,ei.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Ps(G.min(),i,new pe(Y),Nt(),ee())}}class ei{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new ei(r,t,ee(),ee(),ee())}}class ji{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=i}}class Hh{constructor(e,t){this.targetId=e,this.De=t}}class zh{constructor(e,t,r=Ve.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Vu{constructor(){this.ve=0,this.Ce=Lu(),this.Fe=Ve.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=ee(),t=ee(),r=ee();return this.Ce.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:W(38017,{changeType:s})}})),new ei(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=Lu()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,ie(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class ky{constructor(e){this.We=e,this.Ge=new Map,this.ze=Nt(),this.je=Ci(),this.Je=Ci(),this.He=new pe(Y)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:W(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((r,i)=>{this.nt(i)&&t(i)}))}it(e){const t=e.targetId,r=e.De.count,i=this.st(t);if(i){const s=i.target;if(Co(s))if(r===0){const a=new $(s.path);this.Xe(t,a,Fe.newNoDocument(a,G.min()))}else ie(r===1,20013,{expectedCount:r});else{const a=this.ot(t);if(a!==r){const c=this._t(e),h=c?this.ut(c,e,a):1;if(h!==0){this.rt(t);const m=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,m)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,c;try{a=tn(r).toUint8Array()}catch(h){if(h instanceof _h)return Yt("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{c=new pa(a,i,s)}catch(h){return Yt(h instanceof Pr?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return c.fe===0?null:c}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){const r=this.We.getRemoteKeysForTarget(t);let i=0;return r.forEach((s=>{const a=this.We.lt(),c=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.Xe(t,s,null),i++)})),i}Pt(e){const t=new Map;this.Ge.forEach(((s,a)=>{const c=this.st(a);if(c){if(s.current&&Co(c.target)){const h=new $(c.target.path);this.Tt(h).has(a)||this.It(a,h)||this.Xe(a,h,Fe.newNoDocument(h,e))}s.Ne&&(t.set(a,s.Le()),s.ke())}}));let r=ee();this.Je.forEach(((s,a)=>{let c=!0;a.forEachWhile((h=>{const m=this.st(h);return!m||m.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(s))})),this.ze.forEach(((s,a)=>a.setReadTime(e)));const i=new Ps(e,t,this.He,this.ze,r);return this.ze=Nt(),this.je=Ci(),this.Je=Ci(),this.He=new pe(Y),i}Ze(e,t){if(!this.nt(e))return;const r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;const i=this.tt(e);this.It(e,t)?i.qe(t,1):i.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Vu,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new be(Y),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new be(Y),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||B("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Vu),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function Ci(){return new pe($.comparator)}function Lu(){return new pe($.comparator)}const Ny={asc:"ASCENDING",desc:"DESCENDING"},Dy={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Oy={and:"AND",or:"OR"};class Vy{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function No(n,e){return n.useProto3Json||Ts(e)?e:{value:e}}function is(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Wh(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Ly(n,e){return is(n,e.toTimestamp())}function mt(n){return ie(!!n,49232),G.fromTimestamp((function(t){const r=en(t);return new de(r.seconds,r.nanos)})(n))}function ma(n,e){return Do(n,e).canonicalString()}function Do(n,e){const t=(function(i){return new he(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Gh(n){const e=he.fromString(n);return ie(Yh(e),10190,{key:e.toString()}),e}function Oo(n,e){return ma(n.databaseId,e.path)}function uo(n,e){const t=Gh(e);if(t.get(1)!==n.databaseId.projectId)throw new j(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new j(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new $(Qh(t))}function Kh(n,e){return ma(n.databaseId,e)}function My(n){const e=Gh(n);return e.length===4?he.emptyPath():Qh(e)}function Vo(n){return new he(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Qh(n){return ie(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Mu(n,e,t){return{name:Oo(n,e),fields:t.value.mapValue.fields}}function xy(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:W(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(m,p){return m.useProto3Json?(ie(p===void 0||typeof p=="string",58123),Ve.fromBase64String(p||"")):(ie(p===void 0||p instanceof Vf||p instanceof Uint8Array,16193),Ve.fromUint8Array(p||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&(function(m){const p=m.code===void 0?M.UNKNOWN:qh(m.code);return new j(p,m.message||"")})(a);t=new zh(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=uo(n,r.document.name),s=mt(r.document.updateTime),a=r.document.createTime?mt(r.document.createTime):G.min(),c=new He({mapValue:{fields:r.document.fields}}),h=Fe.newFoundDocument(i,s,a,c),m=r.targetIds||[],p=r.removedTargetIds||[];t=new ji(m,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=uo(n,r.document),s=r.readTime?mt(r.readTime):G.min(),a=Fe.newNoDocument(i,s),c=r.removedTargetIds||[];t=new ji([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=uo(n,r.document),s=r.removedTargetIds||[];t=new ji([],s,i,null)}else{if(!("filter"in e))return W(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new by(i,s),c=r.targetId;t=new Hh(c,a)}}return t}function Uy(n,e){let t;if(e instanceof Zr)t={update:Mu(n,e.key,e.value)};else if(e instanceof da)t={delete:Oo(n,e.key)};else if(e instanceof cn)t={update:Mu(n,e.key,e.data),updateMask:Gy(e.fieldMask)};else{if(!(e instanceof Ay))return W(16599,{Rt:e.type});t={verify:Oo(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,a){const c=a.transform;if(c instanceof ns)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Hr)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof zr)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof rs)return{fieldPath:a.field.canonicalString(),increment:c.Ee};throw W(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:Ly(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:W(27497)})(n,e.precondition)),t}function Fy(n,e){return n&&n.length>0?(ie(e!==void 0,14353),n.map((t=>(function(i,s){let a=i.updateTime?mt(i.updateTime):mt(s);return a.isEqual(G.min())&&(a=mt(s)),new Ty(a,i.transformResults||[])})(t,e)))):[]}function By(n,e){return{documents:[Kh(n,e.path)]}}function jy(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Kh(n,i);const s=(function(m){if(m.length!==0)return Xh(Et.create(m,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const a=(function(m){if(m.length!==0)return m.map((p=>(function(I){return{field:$n(I.field),direction:Hy(I.dir)}})(p)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const c=No(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{Vt:t,parent:i}}function $y(n){let e=My(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){ie(r===1,65062);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=(function(v){const I=Jh(v);return I instanceof Et&&bh(I)?I.getFilters():[I]})(t.where));let a=[];t.orderBy&&(a=(function(v){return v.map((I=>(function(L){return new ts(qn(L.field),(function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(L.direction))})(I)))})(t.orderBy));let c=null;t.limit&&(c=(function(v){let I;return I=typeof v=="object"?v.value:v,Ts(I)?null:I})(t.limit));let h=null;t.startAt&&(h=(function(v){const I=!!v.before,N=v.values||[];return new es(N,I)})(t.startAt));let m=null;return t.endAt&&(m=(function(v){const I=!v.before,N=v.values||[];return new es(N,I)})(t.endAt)),ay(e,i,a,s,c,"F",h,m)}function qy(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return W(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Jh(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=qn(t.unaryFilter.field);return Re.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=qn(t.unaryFilter.field);return Re.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=qn(t.unaryFilter.field);return Re.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=qn(t.unaryFilter.field);return Re.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return W(61313);default:return W(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Re.create(qn(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return W(58110);default:return W(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Et.create(t.compositeFilter.filters.map((r=>Jh(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return W(1026)}})(t.compositeFilter.op))})(n):W(30097,{filter:n})}function Hy(n){return Ny[n]}function zy(n){return Dy[n]}function Wy(n){return Oy[n]}function $n(n){return{fieldPath:n.canonicalString()}}function qn(n){return Oe.fromServerFormat(n.fieldPath)}function Xh(n){return n instanceof Re?(function(t){if(t.op==="=="){if(Iu(t.value))return{unaryFilter:{field:$n(t.field),op:"IS_NAN"}};if(wu(t.value))return{unaryFilter:{field:$n(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Iu(t.value))return{unaryFilter:{field:$n(t.field),op:"IS_NOT_NAN"}};if(wu(t.value))return{unaryFilter:{field:$n(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$n(t.field),op:zy(t.op),value:t.value}}})(n):n instanceof Et?(function(t){const r=t.getFilters().map((i=>Xh(i)));return r.length===1?r[0]:{compositeFilter:{op:Wy(t.op),filters:r}}})(n):W(54877,{filter:n})}function Gy(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Yh(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class zt{constructor(e,t,r,i,s=G.min(),a=G.min(),c=Ve.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=h}withSequenceNumber(e){return new zt(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new zt(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new zt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new zt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Ky{constructor(e){this.gt=e}}function Qy(n){const e=$y({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ko(e,e.limit,"L"):e}class Jy{constructor(){this.Dn=new Xy}addToCollectionParentIndex(e,t){return this.Dn.add(t),V.resolve()}getCollectionParents(e,t){return V.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return V.resolve()}deleteFieldIndex(e,t){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,t){return V.resolve()}getDocumentsMatchingTarget(e,t){return V.resolve(null)}getIndexType(e,t){return V.resolve(0)}getFieldIndexes(e,t){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,t){return V.resolve(Zt.min())}getMinOffsetFromCollectionGroup(e,t){return V.resolve(Zt.min())}updateCollectionGroup(e,t,r){return V.resolve()}updateIndexEntries(e,t){return V.resolve()}}class Xy{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new be(he.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new be(he.comparator)).toArray()}}const xu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Zh=41943040;class qe{static withCacheSize(e){return new qe(e,qe.DEFAULT_COLLECTION_PERCENTILE,qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}qe.DEFAULT_COLLECTION_PERCENTILE=10,qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qe.DEFAULT=new qe(Zh,qe.DEFAULT_COLLECTION_PERCENTILE,qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qe.DISABLED=new qe(-1,0,0);class er{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new er(0)}static ur(){return new er(-1)}}const Uu="LruGarbageCollector",Yy=1048576;function Fu([n,e],[t,r]){const i=Y(n,t);return i===0?Y(e,r):i}class Zy{constructor(e){this.Tr=e,this.buffer=new be(Fu),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Fu(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class eE{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){B(Uu,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ar(t)?B(Uu,"Ignoring IndexedDB error during garbage collection: ",t):await or(t)}await this.Rr(3e5)}))}}class tE{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return V.resolve(vs.ue);const r=new Zy(t);return this.Vr.forEachTarget(e,(i=>r.Er(i.sequenceNumber))).next((()=>this.Vr.gr(e,(i=>r.Er(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(B("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(xu)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(B("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),xu):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,i,s,a,c,h,m;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(B("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),i=this.params.maximumSequenceNumbersToCollect):i=v,a=Date.now(),this.nthSequenceNumber(e,i)))).next((v=>(r=v,c=Date.now(),this.removeTargets(e,r,t)))).next((v=>(s=v,h=Date.now(),this.removeOrphanedDocuments(e,r)))).next((v=>(m=Date.now(),Bn()<=Z.DEBUG&&B("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${i} in `+(c-a)+`ms
	Removed ${s} targets in `+(h-c)+`ms
	Removed ${v} documents in `+(m-h)+`ms
Total Duration: ${m-p}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:v}))))}}function nE(n,e){return new tE(n,e)}class rE{constructor(){this.changes=new kn((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Fe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?V.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class iE{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class sE{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Lr(r.mutation,i,Je.empty(),de.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,ee()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=ee()){const i=vn();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let a=br();return s.forEach(((c,h)=>{a=a.insert(c,h.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=vn();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,ee())))}populateOverlays(e,t,r){const i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((a,c)=>{t.set(a,c)}))}))}computeViews(e,t,r,i){let s=Nt();const a=Vr(),c=(function(){return Vr()})();return t.forEach(((h,m)=>{const p=r.get(m.key);i.has(m.key)&&(p===void 0||p.mutation instanceof cn)?s=s.insert(m.key,m):p!==void 0?(a.set(m.key,p.mutation.getFieldMask()),Lr(p.mutation,m,p.mutation.getFieldMask(),de.now())):a.set(m.key,Je.empty())})),this.recalculateAndSaveOverlays(e,s).next((h=>(h.forEach(((m,p)=>a.set(m,p))),t.forEach(((m,p)=>{var v;return c.set(m,new iE(p,(v=a.get(m))!==null&&v!==void 0?v:null))})),c)))}recalculateAndSaveOverlays(e,t){const r=Vr();let i=new pe(((a,c)=>a-c)),s=ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const c of a)c.keys().forEach((h=>{const m=t.get(h);if(m===null)return;let p=r.get(h)||Je.empty();p=c.applyToLocalView(m,p),r.set(h,p);const v=(i.get(c.batchId)||ee()).add(h);i=i.insert(c.batchId,v)}))})).next((()=>{const a=[],c=i.getReverseIterator();for(;c.hasNext();){const h=c.getNext(),m=h.key,p=h.value,v=Lh();p.forEach((I=>{if(!s.has(I)){const N=jh(t.get(I),r.get(I));N!==null&&v.set(I,N),s=s.add(I)}})),a.push(this.documentOverlayCache.saveOverlays(e,m,v))}return V.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return $.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):cy(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):V.resolve(vn());let c=Br,h=s;return a.next((m=>V.forEach(m,((p,v)=>(c<v.largestBatchId&&(c=v.largestBatchId),s.get(p)?V.resolve():this.remoteDocumentCache.getEntry(e,p).next((I=>{h=h.insert(p,I)}))))).next((()=>this.populateOverlays(e,m,s))).next((()=>this.computeViews(e,h,m,ee()))).next((p=>({batchId:c,changes:Vh(p)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $(t)).next((r=>{let i=br();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=br();return this.indexManager.getCollectionParents(e,s).next((c=>V.forEach(c,(h=>{const m=(function(v,I){return new Is(I,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(t,h.child(s));return this.getDocumentsMatchingCollectionQuery(e,m,r,i).next((p=>{p.forEach(((v,I)=>{a=a.insert(v,I)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((a=>{s.forEach(((h,m)=>{const p=m.getKey();a.get(p)===null&&(a=a.insert(p,Fe.newInvalidDocument(p)))}));let c=br();return a.forEach(((h,m)=>{const p=s.get(h);p!==void 0&&Lr(p.mutation,m,Je.empty(),de.now()),Rs(t,m)&&(c=c.insert(h,m))})),c}))}}class oE{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return V.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:mt(i.createTime)}})(t)),V.resolve()}getNamedQuery(e,t){return V.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(i){return{name:i.name,query:Qy(i.bundledQuery),readTime:mt(i.readTime)}})(t)),V.resolve()}}class aE{constructor(){this.overlays=new pe($.comparator),this.kr=new Map}getOverlay(e,t){return V.resolve(this.overlays.get(t))}getOverlays(e,t){const r=vn();return V.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.wt(e,t,s)})),V.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.kr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.kr.delete(r)),V.resolve()}getOverlaysForCollection(e,t,r){const i=vn(),s=t.length+1,a=new $(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const h=c.getNext().value,m=h.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===s&&h.largestBatchId>r&&i.set(h.getKey(),h)}return V.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new pe(((m,p)=>m-p));const a=this.overlays.getIterator();for(;a.hasNext();){const m=a.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let p=s.get(m.largestBatchId);p===null&&(p=vn(),s=s.insert(m.largestBatchId,p)),p.set(m.getKey(),m)}}const c=vn(),h=s.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((m,p)=>c.set(m,p))),!(c.size()>=i)););return V.resolve(c)}wt(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Sy(t,r));let s=this.kr.get(t);s===void 0&&(s=ee(),this.kr.set(t,s)),this.kr.set(t,s.add(r.key))}}class cE{constructor(){this.sessionToken=Ve.EMPTY_BYTE_STRING}getSessionToken(e){return V.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,V.resolve()}}class ga{constructor(){this.qr=new be(Ce.Qr),this.$r=new be(Ce.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const r=new Ce(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Wr(new Ce(e,t))}Gr(e,t){e.forEach((r=>this.removeReference(r,t)))}zr(e){const t=new $(new he([])),r=new Ce(t,e),i=new Ce(t,e+1),s=[];return this.$r.forEachInRange([r,i],(a=>{this.Wr(a),s.push(a.key)})),s}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new $(new he([])),r=new Ce(t,e),i=new Ce(t,e+1);let s=ee();return this.$r.forEachInRange([r,i],(a=>{s=s.add(a.key)})),s}containsKey(e){const t=new Ce(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Ce{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return $.comparator(e.key,t.key)||Y(e.Hr,t.Hr)}static Ur(e,t){return Y(e.Hr,t.Hr)||$.comparator(e.key,t.key)}}class uE{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new be(Ce.Qr)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Ry(s,t,r,i);this.mutationQueue.push(a);for(const c of i)this.Yr=this.Yr.add(new Ce(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return V.resolve(a)}lookupMutationBatch(e,t){return V.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.Xr(r),s=i<0?0:i;return V.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?sa:this.er-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ce(t,0),i=new Ce(t,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],(a=>{const c=this.Zr(a.Hr);s.push(c)})),V.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new be(Y);return t.forEach((i=>{const s=new Ce(i,0),a=new Ce(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,a],(c=>{r=r.add(c.Hr)}))})),V.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;$.isDocumentKey(s)||(s=s.child(""));const a=new Ce(new $(s),0);let c=new be(Y);return this.Yr.forEachWhile((h=>{const m=h.key.path;return!!r.isPrefixOf(m)&&(m.length===i&&(c=c.add(h.Hr)),!0)}),a),V.resolve(this.ei(c))}ei(e){const t=[];return e.forEach((r=>{const i=this.Zr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){ie(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return V.forEach(t.mutations,(i=>{const s=new Ce(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Yr=r}))}rr(e){}containsKey(e,t){const r=new Ce(t,0),i=this.Yr.firstAfterOrEqual(r);return V.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class lE{constructor(e){this.ni=e,this.docs=(function(){return new pe($.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return V.resolve(r?r.document.mutableCopy():Fe.newInvalidDocument(t))}getEntries(e,t){let r=Nt();return t.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Fe.newInvalidDocument(i))})),V.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Nt();const a=t.path,c=new $(a.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(c);for(;h.hasNext();){const{key:m,value:{document:p}}=h.getNext();if(!a.isPrefixOf(m.path))break;m.path.length>a.length+1||F_(U_(p),r)<=0||(i.has(p.key)||Rs(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return V.resolve(s)}getAllFromCollectionGroup(e,t,r,i){W(9500)}ri(e,t){return V.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new hE(this)}getSize(e){return V.resolve(this.size)}}class hE extends rE{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)})),V.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}class dE{constructor(e){this.persistence=e,this.ii=new kn((t=>ca(t)),ua),this.lastRemoteSnapshotVersion=G.min(),this.highestTargetId=0,this.si=0,this.oi=new ga,this.targetCount=0,this._i=er.ar()}forEachTarget(e,t){return this.ii.forEach(((r,i)=>t(i))),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),V.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new er(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,V.resolve()}updateTargetData(e,t){return this.hr(t),V.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.ii.forEach(((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.ii.delete(a),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),V.waitFor(s).next((()=>i))}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,t){const r=this.ii.get(t)||null;return V.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),V.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((a=>{s.push(i.markPotentiallyOrphaned(e,a))})),V.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),V.resolve()}getMatchingKeysForTargetId(e,t){const r=this.oi.Jr(t);return V.resolve(r)}containsKey(e,t){return V.resolve(this.oi.containsKey(t))}}class ed{constructor(e,t){this.ai={},this.overlays={},this.ui=new vs(0),this.ci=!1,this.ci=!0,this.li=new cE,this.referenceDelegate=e(this),this.hi=new dE(this),this.indexManager=new Jy,this.remoteDocumentCache=(function(i){return new lE(i)})((r=>this.referenceDelegate.Pi(r))),this.serializer=new Ky(t),this.Ti=new oE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new aE,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new uE(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){B("MemoryPersistence","Starting transaction:",e);const i=new fE(this.ui.next());return this.referenceDelegate.Ii(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ei(e,t){return V.or(Object.values(this.ai).map((r=>()=>r.containsKey(e,t))))}}class fE extends j_{constructor(e){super(),this.currentSequenceNumber=e}}class _a{constructor(e){this.persistence=e,this.Ai=new ga,this.Ri=null}static Vi(e){return new _a(e)}get mi(){if(this.Ri)return this.Ri;throw W(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),V.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),V.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((i=>this.mi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.mi.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.mi,(r=>{const i=$.fromPath(r);return this.fi(e,i).next((s=>{s||t.removeEntry(i,G.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return V.or([()=>V.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class ss{constructor(e,t){this.persistence=e,this.gi=new kn((r=>H_(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=nE(this,t)}static Vi(e,t){return new ss(e,t)}Ii(){}di(e){return V.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}yr(e){let t=0;return this.gr(e,(r=>{t++})).next((()=>t))}gr(e,t){return V.forEach(this.gi,((r,i)=>this.Sr(e,r,i).next((s=>s?V.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(e,(a=>this.Sr(e,a,t).next((c=>{c||(r++,s.removeEntry(a,G.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),V.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),V.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),V.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),V.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ui(e.data.value)),t}Sr(e,t,r){return V.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.gi.get(t);return V.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ya{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=i}static Es(e,t){let r=ee(),i=ee();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new ya(e,t.fromCache,r,i)}}class pE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class mE{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return Yf()?8:$_(Be())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ps(e,t).next((a=>{s.result=a})).next((()=>{if(!s.result)return this.ys(e,t,i,r).next((a=>{s.result=a}))})).next((()=>{if(s.result)return;const a=new pE;return this.ws(e,t,a).next((c=>{if(s.result=c,this.Rs)return this.Ss(e,t,a,c.size)}))})).next((()=>s.result))}Ss(e,t,r,i){return r.documentReadCount<this.Vs?(Bn()<=Z.DEBUG&&B("QueryEngine","SDK will not create cache indexes for query:",jn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),V.resolve()):(Bn()<=Z.DEBUG&&B("QueryEngine","Query:",jn(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(Bn()<=Z.DEBUG&&B("QueryEngine","The SDK decides to create cache indexes for query:",jn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pt(t))):V.resolve())}ps(e,t){if(bu(t))return V.resolve(null);let r=pt(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=ko(t,null,"F"),r=pt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const a=ee(...s);return this.gs.getDocuments(e,a).next((c=>this.indexManager.getMinOffset(e,r).next((h=>{const m=this.bs(t,c);return this.Ds(t,m,a,h.readTime)?this.ps(e,ko(t,null,"F")):this.vs(e,m,t,h)}))))})))))}ys(e,t,r,i){return bu(t)||i.isEqual(G.min())?V.resolve(null):this.gs.getDocuments(e,r).next((s=>{const a=this.bs(t,s);return this.Ds(t,a,r,i)?V.resolve(null):(Bn()<=Z.DEBUG&&B("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),jn(t)),this.vs(e,a,t,x_(i,Br)).next((c=>c)))}))}bs(e,t){let r=new be(Dh(e));return t.forEach(((i,s)=>{Rs(e,s)&&(r=r.add(s))})),r}Ds(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(e,t,r){return Bn()<=Z.DEBUG&&B("QueryEngine","Using full collection scan to execute query:",jn(t)),this.gs.getDocumentsMatchingQuery(e,t,Zt.min(),r)}vs(e,t,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((a=>{s=s.insert(a.key,a)})),s)))}}const Ea="LocalStore",gE=3e8;class _E{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new pe(Y),this.Ms=new kn((s=>ca(s)),ua),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sE(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function yE(n,e,t,r){return new _E(n,e,t,r)}async function td(n,e){const t=K(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Ns(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{const a=[],c=[];let h=ee();for(const m of i){a.push(m.batchId);for(const p of m.mutations)h=h.add(p.key)}for(const m of s){c.push(m.batchId);for(const p of m.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next((m=>({Bs:m,removedBatchIds:a,addedBatchIds:c})))}))}))}function EE(n,e){const t=K(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=t.Os.newChangeBuffer({trackRemovals:!0});return(function(c,h,m,p){const v=m.batch,I=v.keys();let N=V.resolve();return I.forEach((L=>{N=N.next((()=>p.getEntry(h,L))).next((F=>{const x=m.docVersions.get(L);ie(x!==null,48541),F.version.compareTo(x)<0&&(v.applyToRemoteDocument(F,m),F.isValidDocument()&&(F.setReadTime(m.commitVersion),p.addEntry(F)))}))})),N.next((()=>c.mutationQueue.removeMutationBatch(h,v)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let h=ee();for(let m=0;m<c.mutationResults.length;++m)c.mutationResults[m].transformResults.length>0&&(h=h.add(c.batch.mutations[m].key));return h})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function nd(n){const e=K(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function vE(n,e){const t=K(n),r=e.snapshotVersion;let i=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const a=t.Os.newChangeBuffer({trackRemovals:!0});i=t.Fs;const c=[];e.targetChanges.forEach(((p,v)=>{const I=i.get(v);if(!I)return;c.push(t.hi.removeMatchingKeys(s,p.removedDocuments,v).next((()=>t.hi.addMatchingKeys(s,p.addedDocuments,v))));let N=I.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(v)!==null?N=N.withResumeToken(Ve.EMPTY_BYTE_STRING,G.min()).withLastLimboFreeSnapshotVersion(G.min()):p.resumeToken.approximateByteSize()>0&&(N=N.withResumeToken(p.resumeToken,r)),i=i.insert(v,N),(function(F,x,Q){return F.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=gE?!0:Q.addedDocuments.size+Q.modifiedDocuments.size+Q.removedDocuments.size>0})(I,N,p)&&c.push(t.hi.updateTargetData(s,N))}));let h=Nt(),m=ee();if(e.documentUpdates.forEach((p=>{e.resolvedLimboDocuments.has(p)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))})),c.push(TE(s,a,e.documentUpdates).next((p=>{h=p.Ls,m=p.ks}))),!r.isEqual(G.min())){const p=t.hi.getLastRemoteSnapshotVersion(s).next((v=>t.hi.setTargetsMetadata(s,s.currentSequenceNumber,r)));c.push(p)}return V.waitFor(c).next((()=>a.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,h,m))).next((()=>h))})).then((s=>(t.Fs=i,s)))}function TE(n,e,t){let r=ee(),i=ee();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let a=Nt();return t.forEach(((c,h)=>{const m=s.get(c);h.isFoundDocument()!==m.isFoundDocument()&&(i=i.add(c)),h.isNoDocument()&&h.version.isEqual(G.min())?(e.removeEntry(c,h.readTime),a=a.insert(c,h)):!m.isValidDocument()||h.version.compareTo(m.version)>0||h.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(h),a=a.insert(c,h)):B(Ea,"Ignoring outdated watch update for ",c,". Current version:",m.version," Watch version:",h.version)})),{Ls:a,ks:i}}))}function wE(n,e){const t=K(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=sa),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function IE(n,e){const t=K(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.hi.getTargetData(r,e).next((s=>s?(i=s,V.resolve(i)):t.hi.allocateTargetId(r).next((a=>(i=new zt(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r}))}async function Lo(n,e,t){const r=K(n),i=r.Fs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!ar(a))throw a;B(Ea,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)}function Bu(n,e,t){const r=K(n);let i=G.min(),s=ee();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(h,m,p){const v=K(h),I=v.Ms.get(p);return I!==void 0?V.resolve(v.Fs.get(I)):v.hi.getTargetData(m,p)})(r,a,pt(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(a,c.targetId).next((h=>{s=h}))})).next((()=>r.Cs.getDocumentsMatchingQuery(a,e,t?i:G.min(),t?s:ee()))).next((c=>(AE(r,ly(e),c),{documents:c,qs:s})))))}function AE(n,e,t){let r=n.xs.get(e)||G.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.xs.set(e,r)}class ju{constructor(){this.activeTargetIds=gy()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class RE{constructor(){this.Fo=new ju,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new ju,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class SE{xo(e){}shutdown(){}}const $u="ConnectivityMonitor";class qu{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){B($u,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){B($u,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ki=null;function Mo(){return ki===null?ki=(function(){return 268435456+Math.round(2147483648*Math.random())})():ki++,"0x"+ki.toString(16)}const lo="RestConnection",bE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class PE{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===Yi?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,s){const a=Mo(),c=this.Go(e,t.toUriEncodedString());B(lo,`Sending RPC '${e}' ${a}:`,c,r);const h={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(h,i,s);const{host:m}=new URL(c),p=Dt(m);return this.jo(e,c,h,r,p).then((v=>(B(lo,`Received RPC '${e}' ${a}: `,v),v)),(v=>{throw Yt(lo,`RPC '${e}' ${a} failed with error: `,v,"url: ",c,"request:",r),v}))}Jo(e,t,r,i,s,a){return this.Wo(e,t,r,i,s)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+sr})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}Go(e,t){const r=bE[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}}class CE{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}const xe="WebChannelConnection";class kE extends PE{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,i,s){const a=Mo();return new Promise(((c,h)=>{const m=new sh;m.setWithCredentials(!0),m.listenOnce(oh.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case xi.NO_ERROR:const v=m.getResponseJson();B(xe,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(v)),c(v);break;case xi.TIMEOUT:B(xe,`RPC '${e}' ${a} timed out`),h(new j(M.DEADLINE_EXCEEDED,"Request time out"));break;case xi.HTTP_ERROR:const I=m.getStatus();if(B(xe,`RPC '${e}' ${a} failed with status:`,I,"response text:",m.getResponseText()),I>0){let N=m.getResponseJson();Array.isArray(N)&&(N=N[0]);const L=N?.error;if(L&&L.status&&L.message){const F=(function(Q){const q=Q.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(q)>=0?q:M.UNKNOWN})(L.status);h(new j(F,L.message))}else h(new j(M.UNKNOWN,"Server responded with status "+m.getStatus()))}else h(new j(M.UNAVAILABLE,"Connection failed."));break;default:W(9055,{c_:e,streamId:a,l_:m.getLastErrorCode(),h_:m.getLastError()})}}finally{B(xe,`RPC '${e}' ${a} completed.`)}}));const p=JSON.stringify(i);B(xe,`RPC '${e}' ${a} sending request:`,i),m.send(t,"POST",p,r,15)}))}P_(e,t,r){const i=Mo(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=uh(),c=ch(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(h.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(h.useFetchStreams=!0),this.zo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const p=s.join("");B(xe,`Creating RPC '${e}' stream ${i}: ${p}`,h);const v=a.createWebChannel(p,h);this.T_(v);let I=!1,N=!1;const L=new CE({Ho:x=>{N?B(xe,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(I||(B(xe,`Opening RPC '${e}' stream ${i} transport.`),v.open(),I=!0),B(xe,`RPC '${e}' stream ${i} sending:`,x),v.send(x))},Yo:()=>v.close()}),F=(x,Q,q)=>{x.listen(Q,(H=>{try{q(H)}catch(J){setTimeout((()=>{throw J}),0)}}))};return F(v,Sr.EventType.OPEN,(()=>{N||(B(xe,`RPC '${e}' stream ${i} transport opened.`),L.s_())})),F(v,Sr.EventType.CLOSE,(()=>{N||(N=!0,B(xe,`RPC '${e}' stream ${i} transport closed`),L.__(),this.I_(v))})),F(v,Sr.EventType.ERROR,(x=>{N||(N=!0,Yt(xe,`RPC '${e}' stream ${i} transport errored. Name:`,x.name,"Message:",x.message),L.__(new j(M.UNAVAILABLE,"The operation could not be completed")))})),F(v,Sr.EventType.MESSAGE,(x=>{var Q;if(!N){const q=x.data[0];ie(!!q,16349);const H=q,J=H?.error||((Q=H[0])===null||Q===void 0?void 0:Q.error);if(J){B(xe,`RPC '${e}' stream ${i} received error:`,J);const Ae=J.status;let se=(function(T){const R=we[T];if(R!==void 0)return qh(R)})(Ae),S=J.message;se===void 0&&(se=M.INTERNAL,S="Unknown error status: "+Ae+" with message "+J.message),N=!0,L.__(new j(se,S)),v.close()}else B(xe,`RPC '${e}' stream ${i} received:`,q),L.a_(q)}})),F(c,ah.STAT_EVENT,(x=>{x.stat===Ao.PROXY?B(xe,`RPC '${e}' stream ${i} detected buffering proxy`):x.stat===Ao.NOPROXY&&B(xe,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{L.o_()}),0),L}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function ho(){return typeof document<"u"?document:null}function Cs(n){return new Vy(n,!0)}class rd{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-r);i>0&&B("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}const Hu="PersistentStream";class id{constructor(e,t,r,i,s,a,c,h){this.Fi=e,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=h,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new rd(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===M.RESOURCE_EXHAUSTED?(Ct(t.toString()),Ct("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===M.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.b_===t&&this.W_(r,i)}),(r=>{e((()=>{const i=new j(M.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)}))}))}W_(e,t){const r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.e_((()=>{r((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((i=>{r((()=>this.G_(i)))})),this.stream.onMessage((i=>{r((()=>++this.C_==1?this.j_(i):this.onNext(i)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return B(Hu,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(B(Hu,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class NE extends id{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=xy(this.serializer,e),r=(function(s){if(!("targetChange"in s))return G.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?G.min():a.readTime?mt(a.readTime):G.min()})(e);return this.listener.J_(t,r)}H_(e){const t={};t.database=Vo(this.serializer),t.addTarget=(function(s,a){let c;const h=a.target;if(c=Co(h)?{documents:By(s,h)}:{query:jy(s,h).Vt},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Wh(s,a.resumeToken);const m=No(s,a.expectedCount);m!==null&&(c.expectedCount=m)}else if(a.snapshotVersion.compareTo(G.min())>0){c.readTime=is(s,a.snapshotVersion.toTimestamp());const m=No(s,a.expectedCount);m!==null&&(c.expectedCount=m)}return c})(this.serializer,e);const r=qy(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){const t={};t.database=Vo(this.serializer),t.removeTarget=e,this.k_(t)}}class DE extends id{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return ie(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ie(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){ie(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=Fy(e.writeResults,e.commitTime),r=mt(e.commitTime);return this.listener.ta(r,t)}na(){const e={};e.database=Vo(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Uy(this.serializer,r)))};this.k_(t)}}class OE{}class VE extends OE{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new j(M.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,a])=>this.connection.Wo(e,Do(t,r),i,s,a))).catch((s=>{throw s.name==="FirebaseError"?(s.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new j(M.UNKNOWN,s.toString())}))}Jo(e,t,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,c])=>this.connection.Jo(e,Do(t,r),i,a,c,s))).catch((a=>{throw a.name==="FirebaseError"?(a.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new j(M.UNKNOWN,a.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class LE{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Ct(t),this._a=!1):B("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}const Sn="RemoteStore";class ME{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo((a=>{r.enqueueAndForget((async()=>{Nn(this)&&(B(Sn,"Restarting streams for network reachability change."),await(async function(h){const m=K(h);m.Ia.add(4),await ti(m),m.Aa.set("Unknown"),m.Ia.delete(4),await ks(m)})(this))}))})),this.Aa=new LE(r,i)}}async function ks(n){if(Nn(n))for(const e of n.da)await e(!0)}async function ti(n){for(const e of n.da)await e(!1)}function sd(n,e){const t=K(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),Ia(t)?wa(t):cr(t).x_()&&Ta(t,e))}function va(n,e){const t=K(n),r=cr(t);t.Ta.delete(e),r.x_()&&od(t,e),t.Ta.size===0&&(r.x_()?r.B_():Nn(t)&&t.Aa.set("Unknown"))}function Ta(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(G.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}cr(n).H_(e)}function od(n,e){n.Ra.$e(e),cr(n).Y_(e)}function wa(n){n.Ra=new ky({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),cr(n).start(),n.Aa.aa()}function Ia(n){return Nn(n)&&!cr(n).M_()&&n.Ta.size>0}function Nn(n){return K(n).Ia.size===0}function ad(n){n.Ra=void 0}async function xE(n){n.Aa.set("Online")}async function UE(n){n.Ta.forEach(((e,t)=>{Ta(n,e)}))}async function FE(n,e){ad(n),Ia(n)?(n.Aa.la(e),wa(n)):n.Aa.set("Unknown")}async function BE(n,e,t){if(n.Aa.set("Online"),e instanceof zh&&e.state===2&&e.cause)try{await(async function(i,s){const a=s.cause;for(const c of s.targetIds)i.Ta.has(c)&&(await i.remoteSyncer.rejectListen(c,a),i.Ta.delete(c),i.Ra.removeTarget(c))})(n,e)}catch(r){B(Sn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await os(n,r)}else if(e instanceof ji?n.Ra.Ye(e):e instanceof Hh?n.Ra.it(e):n.Ra.et(e),!t.isEqual(G.min()))try{const r=await nd(n.localStore);t.compareTo(r)>=0&&await(function(s,a){const c=s.Ra.Pt(a);return c.targetChanges.forEach(((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const p=s.Ta.get(m);p&&s.Ta.set(m,p.withResumeToken(h.resumeToken,a))}})),c.targetMismatches.forEach(((h,m)=>{const p=s.Ta.get(h);if(!p)return;s.Ta.set(h,p.withResumeToken(Ve.EMPTY_BYTE_STRING,p.snapshotVersion)),od(s,h);const v=new zt(p.target,h,m,p.sequenceNumber);Ta(s,v)})),s.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){B(Sn,"Failed to raise snapshot:",r),await os(n,r)}}async function os(n,e,t){if(!ar(e))throw e;n.Ia.add(1),await ti(n),n.Aa.set("Offline"),t||(t=()=>nd(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{B(Sn,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await ks(n)}))}function cd(n,e){return e().catch((t=>os(n,t,e)))}async function Ns(n){const e=K(n),t=rn(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:sa;for(;jE(e);)try{const i=await wE(e.localStore,r);if(i===null){e.Pa.length===0&&t.B_();break}r=i.batchId,$E(e,i)}catch(i){await os(e,i)}ud(e)&&ld(e)}function jE(n){return Nn(n)&&n.Pa.length<10}function $E(n,e){n.Pa.push(e);const t=rn(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function ud(n){return Nn(n)&&!rn(n).M_()&&n.Pa.length>0}function ld(n){rn(n).start()}async function qE(n){rn(n).na()}async function HE(n){const e=rn(n);for(const t of n.Pa)e.X_(t.mutations)}async function zE(n,e,t){const r=n.Pa.shift(),i=fa.from(r,e,t);await cd(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Ns(n)}async function WE(n,e){e&&rn(n).Z_&&await(async function(r,i){if((function(a){return Py(a)&&a!==M.ABORTED})(i.code)){const s=r.Pa.shift();rn(r).N_(),await cd(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await Ns(r)}})(n,e),ud(n)&&ld(n)}async function zu(n,e){const t=K(n);t.asyncQueue.verifyOperationInProgress(),B(Sn,"RemoteStore received new credentials");const r=Nn(t);t.Ia.add(3),await ti(t),r&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await ks(t)}async function GE(n,e){const t=K(n);e?(t.Ia.delete(2),await ks(t)):e||(t.Ia.add(2),await ti(t),t.Aa.set("Unknown"))}function cr(n){return n.Va||(n.Va=(function(t,r,i){const s=K(t);return s.ia(),new NE(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:xE.bind(null,n),e_:UE.bind(null,n),n_:FE.bind(null,n),J_:BE.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),Ia(n)?wa(n):n.Aa.set("Unknown")):(await n.Va.stop(),ad(n))}))),n.Va}function rn(n){return n.ma||(n.ma=(function(t,r,i){const s=K(t);return s.ia(),new DE(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:qE.bind(null,n),n_:WE.bind(null,n),ea:HE.bind(null,n),ta:zE.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await Ns(n)):(await n.ma.stop(),n.Pa.length>0&&(B(Sn,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}class Aa{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Rt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,c=new Aa(e,t,a,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new j(M.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ra(n,e){if(Ct("AsyncQueue",`${e}: ${n}`),ar(n))return new j(M.UNAVAILABLE,`${e}: ${n}`);throw n}class Kn{static emptySet(e){return new Kn(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||$.comparator(t.key,r.key):(t,r)=>$.comparator(t.key,r.key),this.keyedMap=br(),this.sortedSet=new pe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Kn)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Kn;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Wu{constructor(){this.fa=new pe($.comparator)}track(e){const t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):W(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,r)=>{e.push(r)})),e}}class tr{constructor(e,t,r,i,s,a,c,h,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=h,this.hasCachedResults=m}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach((c=>{a.push({type:0,doc:c})})),new tr(e,t,Kn.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&As(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class KE{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class QE{constructor(){this.queries=Gu(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){const i=K(t),s=i.queries;i.queries=Gu(),s.forEach(((a,c)=>{for(const h of c.wa)h.onError(r)}))})(this,new j(M.ABORTED,"Firestore shutting down"))}}function Gu(){return new kn((n=>Nh(n)),As)}async function hd(n,e){const t=K(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.Sa()&&e.ba()&&(r=2):(s=new KE,r=e.ba()?0:1);try{switch(r){case 0:s.ya=await t.onListen(i,!0);break;case 1:s.ya=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const c=Ra(a,`Initialization of query '${jn(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,s),s.wa.push(e),e.va(t.onlineState),s.ya&&e.Ca(s.ya)&&Sa(t)}async function dd(n,e){const t=K(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const a=s.wa.indexOf(e);a>=0&&(s.wa.splice(a,1),s.wa.length===0?i=e.ba()?0:1:!s.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function JE(n,e){const t=K(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const c of a.wa)c.Ca(i)&&(r=!0);a.ya=i}}r&&Sa(t)}function XE(n,e,t){const r=K(n),i=r.queries.get(e);if(i)for(const s of i.wa)s.onError(t);r.queries.delete(e)}function Sa(n){n.Da.forEach((e=>{e.next()}))}var xo,Ku;(Ku=xo||(xo={})).Fa="default",Ku.Cache="cache";class fd{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new tr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=tr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==xo.Cache}}class pd{constructor(e){this.key=e}}class md{constructor(e){this.key=e}}class YE{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=ee(),this.mutatedKeys=ee(),this.Xa=Dh(e),this.eu=new Kn(this.Xa)}get tu(){return this.Ha}nu(e,t){const r=t?t.ru:new Wu,i=t?t.eu:this.eu;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,c=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,m=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((p,v)=>{const I=i.get(p),N=Rs(this.query,v)?v:null,L=!!I&&this.mutatedKeys.has(I.key),F=!!N&&(N.hasLocalMutations||this.mutatedKeys.has(N.key)&&N.hasCommittedMutations);let x=!1;I&&N?I.data.isEqual(N.data)?L!==F&&(r.track({type:3,doc:N}),x=!0):this.iu(I,N)||(r.track({type:2,doc:N}),x=!0,(h&&this.Xa(N,h)>0||m&&this.Xa(N,m)<0)&&(c=!0)):!I&&N?(r.track({type:0,doc:N}),x=!0):I&&!N&&(r.track({type:1,doc:I}),x=!0,(h||m)&&(c=!0)),x&&(N?(a=a.add(N),s=F?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{eu:a,ru:r,Ds:c,mutatedKeys:s}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const a=e.ru.pa();a.sort(((p,v)=>(function(N,L){const F=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W(20277,{At:x})}};return F(N)-F(L)})(p.type,v.type)||this.Xa(p.doc,v.doc))),this.su(r),i=i!=null&&i;const c=t&&!i?this.ou():[],h=this.Za.size===0&&this.current&&!i?1:0,m=h!==this.Ya;return this.Ya=h,a.length!==0||m?{snapshot:new tr(this.query,e.eu,s,a,e.mutatedKeys,h===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:c}:{_u:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Wu,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=ee(),this.eu.forEach((r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))}));const t=[];return e.forEach((r=>{this.Za.has(r)||t.push(new md(r))})),this.Za.forEach((r=>{e.has(r)||t.push(new pd(r))})),t}uu(e){this.Ha=e.qs,this.Za=ee();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return tr.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const ba="SyncEngine";class ZE{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class ev{constructor(e){this.key=e,this.lu=!1}}class tv{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.hu={},this.Pu=new kn((c=>Nh(c)),As),this.Tu=new Map,this.Iu=new Set,this.du=new pe($.comparator),this.Eu=new Map,this.Au=new ga,this.Ru={},this.Vu=new Map,this.mu=er.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function nv(n,e,t=!0){const r=Td(n);let i;const s=r.Pu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await gd(r,e,t,!0),i}async function rv(n,e){const t=Td(n);await gd(t,e,!0,!1)}async function gd(n,e,t,r){const i=await IE(n.localStore,pt(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t);let c;return r&&(c=await iv(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&sd(n.remoteStore,i),c}async function iv(n,e,t,r,i){n.gu=(v,I,N)=>(async function(F,x,Q,q){let H=x.view.nu(Q);H.Ds&&(H=await Bu(F.localStore,x.query,!1).then((({documents:S})=>x.view.nu(S,H))));const J=q&&q.targetChanges.get(x.targetId),Ae=q&&q.targetMismatches.get(x.targetId)!=null,se=x.view.applyChanges(H,F.isPrimaryClient,J,Ae);return Ju(F,x.targetId,se._u),se.snapshot})(n,v,I,N);const s=await Bu(n.localStore,e,!0),a=new YE(e,s.qs),c=a.nu(s.documents),h=ei.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),m=a.applyChanges(c,n.isPrimaryClient,h);Ju(n,t,m._u);const p=new ZE(e,t,a);return n.Pu.set(e,p),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),m.snapshot}async function sv(n,e,t){const r=K(n),i=r.Pu.get(e),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter((a=>!As(a,e)))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Lo(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&va(r.remoteStore,i.targetId),Uo(r,i.targetId)})).catch(or)):(Uo(r,i.targetId),await Lo(r.localStore,i.targetId,!0))}async function ov(n,e){const t=K(n),r=t.Pu.get(e),i=t.Tu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),va(t.remoteStore,r.targetId))}async function av(n,e,t){const r=pv(n);try{const i=await(function(a,c){const h=K(a),m=de.now(),p=c.reduce(((N,L)=>N.add(L.key)),ee());let v,I;return h.persistence.runTransaction("Locally write mutations","readwrite",(N=>{let L=Nt(),F=ee();return h.Os.getEntries(N,p).next((x=>{L=x,L.forEach(((Q,q)=>{q.isValidDocument()||(F=F.add(Q))}))})).next((()=>h.localDocuments.getOverlayedDocuments(N,L))).next((x=>{v=x;const Q=[];for(const q of c){const H=Iy(q,v.get(q.key).overlayedDocument);H!=null&&Q.push(new cn(q.key,H,Ah(H.value.mapValue),st.exists(!0)))}return h.mutationQueue.addMutationBatch(N,m,Q,c)})).next((x=>{I=x;const Q=x.applyToLocalDocumentSet(v,F);return h.documentOverlayCache.saveOverlays(N,x.batchId,Q)}))})).then((()=>({batchId:I.batchId,changes:Vh(v)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,c,h){let m=a.Ru[a.currentUser.toKey()];m||(m=new pe(Y)),m=m.insert(c,h),a.Ru[a.currentUser.toKey()]=m})(r,i.batchId,t),await ni(r,i.changes),await Ns(r.remoteStore)}catch(i){const s=Ra(i,"Failed to persist write");t.reject(s)}}async function _d(n,e){const t=K(n);try{const r=await vE(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const a=t.Eu.get(s);a&&(ie(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.lu=!0:i.modifiedDocuments.size>0?ie(a.lu,14607):i.removedDocuments.size>0&&(ie(a.lu,42227),a.lu=!1))})),await ni(t,r,e)}catch(r){await or(r)}}function Qu(n,e,t){const r=K(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Pu.forEach(((s,a)=>{const c=a.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(a,c){const h=K(a);h.onlineState=c;let m=!1;h.queries.forEach(((p,v)=>{for(const I of v.wa)I.va(c)&&(m=!0)})),m&&Sa(h)})(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function cv(n,e,t){const r=K(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Eu.get(e),s=i&&i.key;if(s){let a=new pe($.comparator);a=a.insert(s,Fe.newNoDocument(s,G.min()));const c=ee().add(s),h=new Ps(G.min(),new Map,new pe(Y),a,c);await _d(r,h),r.du=r.du.remove(s),r.Eu.delete(e),Pa(r)}else await Lo(r.localStore,e,!1).then((()=>Uo(r,e,t))).catch(or)}async function uv(n,e){const t=K(n),r=e.batch.batchId;try{const i=await EE(t.localStore,e);Ed(t,r,null),yd(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await ni(t,i)}catch(i){await or(i)}}async function lv(n,e,t){const r=K(n);try{const i=await(function(a,c){const h=K(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let p;return h.mutationQueue.lookupMutationBatch(m,c).next((v=>(ie(v!==null,37113),p=v.keys(),h.mutationQueue.removeMutationBatch(m,v)))).next((()=>h.mutationQueue.performConsistencyCheck(m))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(m,p,c))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,p))).next((()=>h.localDocuments.getDocuments(m,p)))}))})(r.localStore,e);Ed(r,e,t),yd(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await ni(r,i)}catch(i){await or(i)}}function yd(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function Ed(n,e,t){const r=K(n);let i=r.Ru[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ru[r.currentUser.toKey()]=i}}function Uo(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((r=>{n.Au.containsKey(r)||vd(n,r)}))}function vd(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(va(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Pa(n))}function Ju(n,e,t){for(const r of t)r instanceof pd?(n.Au.addReference(r.key,e),hv(n,r)):r instanceof md?(B(ba,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||vd(n,r.key)):W(19791,{yu:r})}function hv(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(B(ba,"New document in limbo: "+t),n.Iu.add(r),Pa(n))}function Pa(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new $(he.fromString(e)),r=n.mu.next();n.Eu.set(r,new ev(t)),n.du=n.du.insert(t,r),sd(n.remoteStore,new zt(pt(la(t.path)),r,"TargetPurposeLimboResolution",vs.ue))}}async function ni(n,e,t){const r=K(n),i=[],s=[],a=[];r.Pu.isEmpty()||(r.Pu.forEach(((c,h)=>{a.push(r.gu(h,e,t).then((m=>{var p;if((m||t)&&r.isPrimaryClient){const v=m?!m.fromCache:(p=t?.targetChanges.get(h.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(h.targetId,v?"current":"not-current")}if(m){i.push(m);const v=ya.Es(h.targetId,m);s.push(v)}})))})),await Promise.all(a),r.hu.J_(i),await(async function(h,m){const p=K(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>V.forEach(m,(I=>V.forEach(I.Is,(N=>p.persistence.referenceDelegate.addReference(v,I.targetId,N))).next((()=>V.forEach(I.ds,(N=>p.persistence.referenceDelegate.removeReference(v,I.targetId,N)))))))))}catch(v){if(!ar(v))throw v;B(Ea,"Failed to update sequence numbers: "+v)}for(const v of m){const I=v.targetId;if(!v.fromCache){const N=p.Fs.get(I),L=N.snapshotVersion,F=N.withLastLimboFreeSnapshotVersion(L);p.Fs=p.Fs.insert(I,F)}}})(r.localStore,s))}async function dv(n,e){const t=K(n);if(!t.currentUser.isEqual(e)){B(ba,"User change. New user:",e.toKey());const r=await td(t.localStore,e);t.currentUser=e,(function(s,a){s.Vu.forEach((c=>{c.forEach((h=>{h.reject(new j(M.CANCELLED,a))}))})),s.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ni(t,r.Bs)}}function fv(n,e){const t=K(n),r=t.Eu.get(e);if(r&&r.lu)return ee().add(r.key);{let i=ee();const s=t.Tu.get(e);if(!s)return i;for(const a of s){const c=t.Pu.get(a);i=i.unionWith(c.view.tu)}return i}}function Td(n){const e=K(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=_d.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=fv.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=cv.bind(null,e),e.hu.J_=JE.bind(null,e.eventManager),e.hu.pu=XE.bind(null,e.eventManager),e}function pv(n){const e=K(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=uv.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lv.bind(null,e),e}class as{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Cs(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return yE(this.persistence,new mE,e.initialUser,this.serializer)}Du(e){return new ed(_a.Vi,this.serializer)}bu(e){return new RE}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}as.provider={build:()=>new as};class mv extends as{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){ie(this.persistence.referenceDelegate instanceof ss,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new eE(r,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?qe.withCacheSize(this.cacheSizeBytes):qe.DEFAULT;return new ed((r=>ss.Vi(r,t)),this.serializer)}}class Fo{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Qu(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=dv.bind(null,this.syncEngine),await GE(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new QE})()}createDatastore(e){const t=Cs(e.databaseInfo.databaseId),r=(function(s){return new kE(s)})(e.databaseInfo);return(function(s,a,c,h){return new VE(s,a,c,h)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,a,c){return new ME(r,i,s,a,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>Qu(this.syncEngine,t,0)),(function(){return qu.C()?new qu:new SE})())}createSyncEngine(e,t){return(function(i,s,a,c,h,m,p){const v=new tv(i,s,a,c,h,m);return p&&(v.fu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(i){const s=K(i);B(Sn,"RemoteStore shutting down."),s.Ia.add(5),await ti(s),s.Ea.shutdown(),s.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Fo.provider={build:()=>new Fo};class wd{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Ct("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const sn="FirestoreClient";class gv{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ue.UNAUTHENTICATED,this.clientId=ra.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async a=>{B(sn,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(B(sn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Rt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Ra(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function fo(n,e){n.asyncQueue.verifyOperationInProgress(),B(sn,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await td(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>{Yt("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{B("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((i=>{Yt("Terminating Firestore due to IndexedDb database deletion failed",i)}))})),n._offlineComponents=e}async function Xu(n,e){n.asyncQueue.verifyOperationInProgress();const t=await _v(n);B(sn,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>zu(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>zu(e.remoteStore,i))),n._onlineComponents=e}async function _v(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){B(sn,"Using user provided OfflineComponentProvider");try{await fo(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===M.FAILED_PRECONDITION||i.code===M.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Yt("Error using user provided cache. Falling back to memory cache: "+t),await fo(n,new as)}}else B(sn,"Using default OfflineComponentProvider"),await fo(n,new mv(void 0));return n._offlineComponents}async function Id(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(B(sn,"Using user provided OnlineComponentProvider"),await Xu(n,n._uninitializedComponentsProvider._online)):(B(sn,"Using default OnlineComponentProvider"),await Xu(n,new Fo))),n._onlineComponents}function yv(n){return Id(n).then((e=>e.syncEngine))}async function Ad(n){const e=await Id(n),t=e.eventManager;return t.onListen=nv.bind(null,e.syncEngine),t.onUnlisten=sv.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=rv.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=ov.bind(null,e.syncEngine),t}function Ev(n,e,t={}){const r=new Rt;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,c,h,m){const p=new wd({next:I=>{p.Ou(),a.enqueueAndForget((()=>dd(s,v)));const N=I.docs.has(c);!N&&I.fromCache?m.reject(new j(M.UNAVAILABLE,"Failed to get document because the client is offline.")):N&&I.fromCache&&h&&h.source==="server"?m.reject(new j(M.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(I)},error:I=>m.reject(I)}),v=new fd(la(c.path),p,{includeMetadataChanges:!0,ka:!0});return hd(s,v)})(await Ad(n),n.asyncQueue,e,t,r))),r.promise}function vv(n,e,t={}){const r=new Rt;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,c,h,m){const p=new wd({next:I=>{p.Ou(),a.enqueueAndForget((()=>dd(s,v))),I.fromCache&&h.source==="server"?m.reject(new j(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(I)},error:I=>m.reject(I)}),v=new fd(c,p,{includeMetadataChanges:!0,ka:!0});return hd(s,v)})(await Ad(n),n.asyncQueue,e,t,r))),r.promise}function Rd(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const Yu=new Map;const Sd="firestore.googleapis.com",Zu=!0;class el{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new j(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Sd,this.ssl=Zu}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Zu;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Zh;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Yy)throw new j(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}M_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Rd((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new j(M.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new j(M.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new j(M.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ds{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new el({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new j(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new j(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new el(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new b_;switch(r.type){case"firstParty":return new N_(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new j(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=Yu.get(t);r&&(B("ComponentProvider","Removing Datastore"),Yu.delete(t),r.terminate())})(this),Promise.resolve()}}function Tv(n,e,t,r={}){var i;n=kt(n,Ds);const s=Dt(e),a=n._getSettings(),c=Object.assign(Object.assign({},a),{emulatorOptions:n._getEmulatorOptions()}),h=`${e}:${t}`;s&&(fs(`https://${h}`),ps("Firestore",!0)),a.host!==Sd&&a.host!==h&&Yt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m=Object.assign(Object.assign({},a),{host:h,ssl:s,emulatorOptions:r});if(!In(m,c)&&(n._setSettings(m),r.mockUserToken)){let p,v;if(typeof r.mockUserToken=="string")p=r.mockUserToken,v=Ue.MOCK_USER;else{p=vl(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const I=r.mockUserToken.sub||r.mockUserToken.user_id;if(!I)throw new j(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");v=new Ue(I)}n._authCredentials=new P_(new hh(p,v))}}class Os{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Os(this.firestore,e,this._query)}}class Se{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Jt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Se(this.firestore,e,this._key)}toJSON(){return{type:Se._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Yr(t,Se._jsonSchema))return new Se(e,r||null,new $(he.fromString(t.referencePath)))}}Se._jsonSchemaVersion="firestore/documentReference/1.0",Se._jsonSchema={type:Ie("string",Se._jsonSchemaVersion),referencePath:Ie("string")};class Jt extends Os{constructor(e,t,r){super(e,t,la(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Se(this.firestore,null,new $(e))}withConverter(e){return new Jt(this.firestore,e,this._path)}}function Rw(n,e,...t){if(n=fe(n),fh("collection","path",e),n instanceof Ds){const r=he.fromString(e,...t);return pu(r),new Jt(n,null,r)}{if(!(n instanceof Se||n instanceof Jt))throw new j(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(he.fromString(e,...t));return pu(r),new Jt(n.firestore,null,r)}}function wv(n,e,...t){if(n=fe(n),arguments.length===1&&(e=ra.newId()),fh("doc","path",e),n instanceof Ds){const r=he.fromString(e,...t);return fu(r),new Se(n,null,new $(r))}{if(!(n instanceof Se||n instanceof Jt))throw new j(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(he.fromString(e,...t));return fu(r),new Se(n.firestore,n instanceof Jt?n.converter:null,new $(r))}}const tl="AsyncQueue";class nl{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new rd(this,"async_queue_retry"),this.oc=()=>{const r=ho();r&&B(tl,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const t=ho();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=ho();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new Rt;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!ar(e))throw e;B(tl,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((r=>{throw this.tc=r,this.nc=!1,Ct("INTERNAL UNHANDLED ERROR: ",rl(r)),r})).then((r=>(this.nc=!1,r))))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const i=Aa.createAndSchedule(this,e,t,r,(s=>this.lc(s)));return this.ec.push(i),i}ac(){this.tc&&W(47125,{hc:rl(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function rl(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class ur extends Ds{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new nl,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new nl(e),this._firestoreClient=void 0,await e}}}function Sw(n,e){const t=typeof n=="object"?n:ms(),r=typeof n=="string"?n:Yi,i=Kr(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=zo("firestore");s&&Tv(i,...s)}return i}function Ca(n){if(n._terminated)throw new j(M.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Iv(n),n._firestoreClient}function Iv(n){var e,t,r;const i=n._freezeSettings(),s=(function(c,h,m,p){return new G_(c,h,m,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Rd(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new gv(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&(function(c){const h=c?._online.build();return{_offline:c?._offline.build(h),_online:h}})(n._componentsProvider))}class Ze{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ze(Ve.fromBase64String(e))}catch(t){throw new j(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ze(Ve.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ze._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Yr(e,Ze._jsonSchema))return Ze.fromBase64String(e.bytes)}}Ze._jsonSchemaVersion="firestore/bytes/1.0",Ze._jsonSchema={type:Ie("string",Ze._jsonSchemaVersion),bytes:Ie("string")};class Vs{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new j(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Oe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class ka{constructor(e){this._methodName=e}}class gt{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new j(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new j(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Y(this._lat,e._lat)||Y(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:gt._jsonSchemaVersion}}static fromJSON(e){if(Yr(e,gt._jsonSchema))return new gt(e.latitude,e.longitude)}}gt._jsonSchemaVersion="firestore/geoPoint/1.0",gt._jsonSchema={type:Ie("string",gt._jsonSchemaVersion),latitude:Ie("number"),longitude:Ie("number")};class _t{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:_t._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Yr(e,_t._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new _t(e.vectorValues);throw new j(M.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}_t._jsonSchemaVersion="firestore/vectorValue/1.0",_t._jsonSchema={type:Ie("string",_t._jsonSchemaVersion),vectorValues:Ie("object")};const Av=/^__.*__$/;class Rv{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new cn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Zr(e,this.data,t,this.fieldTransforms)}}class bd{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new cn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Pd(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W(40011,{Ec:n})}}class Na{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Na(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return cs(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(Pd(this.Ec)&&Av.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class Sv{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Cs(e)}Dc(e,t,r,i=!1){return new Na({Ec:e,methodName:t,bc:r,path:Oe.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Cd(n){const e=n._freezeSettings(),t=Cs(n._databaseId);return new Sv(n._databaseId,!!e.ignoreUndefinedProperties,t)}function bv(n,e,t,r,i,s={}){const a=n.Dc(s.merge||s.mergeFields?2:0,e,t,i);Da("Data must be an object, but it was:",a,r);const c=kd(r,a);let h,m;if(s.merge)h=new Je(a.fieldMask),m=a.fieldTransforms;else if(s.mergeFields){const p=[];for(const v of s.mergeFields){const I=Bo(e,v,t);if(!a.contains(I))throw new j(M.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);Dd(p,I)||p.push(I)}h=new Je(p),m=a.fieldTransforms.filter((v=>h.covers(v.field)))}else h=null,m=a.fieldTransforms;return new Rv(new He(c),h,m)}class Ls extends ka{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ls}}function Pv(n,e,t,r){const i=n.Dc(1,e,t);Da("Data must be an object, but it was:",i,r);const s=[],a=He.empty();an(r,((h,m)=>{const p=Oa(e,h,t);m=fe(m);const v=i.gc(p);if(m instanceof Ls)s.push(p);else{const I=Ms(m,v);I!=null&&(s.push(p),a.set(p,I))}}));const c=new Je(s);return new bd(a,c,i.fieldTransforms)}function Cv(n,e,t,r,i,s){const a=n.Dc(1,e,t),c=[Bo(e,r,t)],h=[i];if(s.length%2!=0)throw new j(M.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<s.length;I+=2)c.push(Bo(e,s[I])),h.push(s[I+1]);const m=[],p=He.empty();for(let I=c.length-1;I>=0;--I)if(!Dd(m,c[I])){const N=c[I];let L=h[I];L=fe(L);const F=a.gc(N);if(L instanceof Ls)m.push(N);else{const x=Ms(L,F);x!=null&&(m.push(N),p.set(N,x))}}const v=new Je(m);return new bd(p,v,a.fieldTransforms)}function Ms(n,e){if(Nd(n=fe(n)))return Da("Unsupported field value:",e,n),kd(n,e);if(n instanceof ka)return(function(r,i){if(!Pd(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,i){const s=[];let a=0;for(const c of r){let h=Ms(c,i.yc(a));h==null&&(h={nullValue:"NULL_VALUE"}),s.push(h),a++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=fe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return _y(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=de.fromDate(r);return{timestampValue:is(i.serializer,s)}}if(r instanceof de){const s=new de(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:is(i.serializer,s)}}if(r instanceof gt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ze)return{bytesValue:Wh(i.serializer,r._byteString)};if(r instanceof Se){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.wc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:ma(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof _t)return(function(a,c){return{mapValue:{fields:{[wh]:{stringValue:Ih},[Zi]:{arrayValue:{values:a.toArray().map((m=>{if(typeof m!="number")throw c.wc("VectorValues must only contain numeric values.");return ha(c.serializer,m)}))}}}}}})(r,i);throw i.wc(`Unsupported field value: ${ia(r)}`)})(n,e)}function kd(n,e){const t={};return gh(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):an(n,((r,i)=>{const s=Ms(i,e.Vc(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function Nd(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof de||n instanceof gt||n instanceof Ze||n instanceof Se||n instanceof ka||n instanceof _t)}function Da(n,e,t){if(!Nd(t)||!ph(t)){const r=ia(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function Bo(n,e,t){if((e=fe(e))instanceof Vs)return e._internalPath;if(typeof e=="string")return Oa(n,e);throw cs("Field path arguments must be of type string or ",n,!1,void 0,t)}const kv=new RegExp("[~\\*/\\[\\]]");function Oa(n,e,t){if(e.search(kv)>=0)throw cs(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Vs(...e.split("."))._internalPath}catch{throw cs(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function cs(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let h="";return(s||a)&&(h+=" (found",s&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new j(M.INVALID_ARGUMENT,c+n+h)}function Dd(n,e){return n.some((t=>t.isEqual(e)))}class Od{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Se(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Nv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Vd("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Nv extends Od{data(){return super.data()}}function Vd(n,e){return typeof e=="string"?Oa(n,e):e instanceof Vs?e._internalPath:e._delegate._internalPath}function Dv(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new j(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ov{convertValue(e,t="none"){switch(nn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ye(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(tn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw W(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return an(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){var t,r,i;const s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[Zi].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map((a=>ye(a.doubleValue)));return new _t(s)}convertGeoPoint(e){return new gt(ye(e.latitude),ye(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=ws(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(jr(e));default:return null}}convertTimestamp(e){const t=en(e);return new de(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=he.fromString(e);ie(Yh(r),9688,{name:e});const i=new $r(r.get(1),r.get(3)),s=new $(r.popFirst(5));return i.isEqual(t)||Ct(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function Vv(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class Cr{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Tn extends Od{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new $i(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Vd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new j(M.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Tn._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Tn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Tn._jsonSchema={type:Ie("string",Tn._jsonSchemaVersion),bundleSource:Ie("string","DocumentSnapshot"),bundleName:Ie("string"),bundle:Ie("string")};class $i extends Tn{data(e={}){return super.data(e)}}class Qn{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Cr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new $i(this._firestore,this._userDataWriter,r.key,r,new Cr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new j(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map((c=>{const h=new $i(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Cr(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>s||c.type!==3)).map((c=>{const h=new $i(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Cr(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let m=-1,p=-1;return c.type!==0&&(m=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),p=a.indexOf(c.doc.key)),{type:Lv(c.type),doc:h,oldIndex:m,newIndex:p}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new j(M.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Qn._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ra.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Lv(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W(61501,{type:n})}}function bw(n){n=kt(n,Se);const e=kt(n.firestore,ur);return Ev(Ca(e),n._key).then((t=>Mv(e,n,t)))}Qn._jsonSchemaVersion="firestore/querySnapshot/1.0",Qn._jsonSchema={type:Ie("string",Qn._jsonSchemaVersion),bundleSource:Ie("string","QuerySnapshot"),bundleName:Ie("string"),bundle:Ie("string")};class Ld extends Ov{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ze(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Se(this.firestore,null,t)}}function Pw(n){n=kt(n,Os);const e=kt(n.firestore,ur),t=Ca(e),r=new Ld(e);return Dv(n._query),vv(t,n._query).then((i=>new Qn(e,r,n,i)))}function Cw(n,e,t,...r){n=kt(n,Se);const i=kt(n.firestore,ur),s=Cd(i);let a;return a=typeof(e=fe(e))=="string"||e instanceof Vs?Cv(s,"updateDoc",n._key,e,t,r):Pv(s,"updateDoc",n._key,e),Va(i,[a.toMutation(n._key,st.exists(!0))])}function kw(n){return Va(kt(n.firestore,ur),[new da(n._key,st.none())])}function Nw(n,e){const t=kt(n.firestore,ur),r=wv(n),i=Vv(n.converter,e);return Va(t,[bv(Cd(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,st.exists(!1))]).then((()=>r))}function Va(n,e){return(function(r,i){const s=new Rt;return r.asyncQueue.enqueueAndForget((async()=>av(await yv(r),i,s))),s.promise})(Ca(n),e)}function Mv(n,e,t){const r=t.docs.get(e._key),i=new Ld(n);return new Tn(n,i,e._key,r,new Cr(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){sr=i})(Pn),Xt(new St("firestore",((r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),c=new ur(new C_(r.getProvider("auth-internal")),new D_(a,r.getProvider("app-check-internal")),(function(m,p){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new j(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $r(m.options.projectId,p)})(a,i),a);return s=Object.assign({useFetchStreams:t},s),c._setSettings(s),c}),"PUBLIC").setMultipleInstances(!0)),et(cu,uu,e),et(cu,uu,"esm2017")})();var xv="firebase",Uv="11.10.0";et(xv,Uv,"app");const Md="firebasestorage.googleapis.com",xd="storageBucket",Fv=120*1e3,Bv=600*1e3;class _e extends at{constructor(e,t,r=0){super(po(e),`Firebase Storage: ${t} (${po(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,_e.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return po(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ge;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ge||(ge={}));function po(n){return"storage/"+n}function La(){const n="An unknown error occurred, please check the error payload for server response.";return new _e(ge.UNKNOWN,n)}function jv(n){return new _e(ge.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function $v(n){return new _e(ge.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function qv(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new _e(ge.UNAUTHENTICATED,n)}function Hv(){return new _e(ge.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function zv(n){return new _e(ge.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function Wv(){return new _e(ge.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Gv(){return new _e(ge.CANCELED,"User canceled the upload/download.")}function Kv(n){return new _e(ge.INVALID_URL,"Invalid URL '"+n+"'.")}function Qv(n){return new _e(ge.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Jv(){return new _e(ge.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+xd+"' property when initializing the app?")}function Xv(){return new _e(ge.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Yv(){return new _e(ge.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Zv(n){return new _e(ge.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function jo(n){return new _e(ge.INVALID_ARGUMENT,n)}function Ud(){return new _e(ge.APP_DELETED,"The Firebase app was deleted.")}function eT(n){return new _e(ge.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Mr(n,e){return new _e(ge.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Ir(n){throw new _e(ge.INTERNAL_ERROR,"Internal error: "+n)}class Xe{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=Xe.makeFromUrl(e,t)}catch{return new Xe(e,"")}if(r.path==="")return r;throw Qv(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(J){J.path.charAt(J.path.length-1)==="/"&&(J.path_=J.path_.slice(0,-1))}const a="(/(.*))?$",c=new RegExp("^gs://"+i+a,"i"),h={bucket:1,path:3};function m(J){J.path_=decodeURIComponent(J.path)}const p="v[A-Za-z0-9_]+",v=t.replace(/[.]/g,"\\."),I="(/([^?#]*).*)?$",N=new RegExp(`^https?://${v}/${p}/b/${i}/o${I}`,"i"),L={bucket:1,path:3},F=t===Md?"(?:storage.googleapis.com|storage.cloud.google.com)":t,x="([^?#]*)",Q=new RegExp(`^https?://${F}/${i}/${x}`,"i"),H=[{regex:c,indices:h,postModify:s},{regex:N,indices:L,postModify:m},{regex:Q,indices:{bucket:1,path:2},postModify:m}];for(let J=0;J<H.length;J++){const Ae=H[J],se=Ae.regex.exec(e);if(se){const S=se[Ae.indices.bucket];let E=se[Ae.indices.path];E||(E=""),r=new Xe(S,E),Ae.postModify(r);break}}if(r==null)throw Kv(e);return r}}class tT{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function nT(n,e,t){let r=1,i=null,s=null,a=!1,c=0;function h(){return c===2}let m=!1;function p(...x){m||(m=!0,e.apply(null,x))}function v(x){i=setTimeout(()=>{i=null,n(N,h())},x)}function I(){s&&clearTimeout(s)}function N(x,...Q){if(m){I();return}if(x){I(),p.call(null,x,...Q);return}if(h()||a){I(),p.call(null,x,...Q);return}r<64&&(r*=2);let H;c===1?(c=2,H=0):H=(r+Math.random())*1e3,v(H)}let L=!1;function F(x){L||(L=!0,I(),!m&&(i!==null?(x||(c=2),clearTimeout(i),v(0)):x||(c=1)))}return v(0),s=setTimeout(()=>{a=!0,F(!0)},t),F}function rT(n){n(!1)}function iT(n){return n!==void 0}function sT(n){return typeof n=="object"&&!Array.isArray(n)}function Ma(n){return typeof n=="string"||n instanceof String}function il(n){return xa()&&n instanceof Blob}function xa(){return typeof Blob<"u"}function sl(n,e,t,r){if(r<e)throw jo(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw jo(`Invalid value for '${n}'. Expected ${t} or less.`)}function Ua(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function Fd(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var wn;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(wn||(wn={}));function oT(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}class aT{constructor(e,t,r,i,s,a,c,h,m,p,v,I=!0,N=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=c,this.errorCallback_=h,this.timeout_=m,this.progressCallback_=p,this.connectionFactory_=v,this.retry=I,this.isUsingEmulator=N,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((L,F)=>{this.resolve_=L,this.reject_=F,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Ni(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=c=>{const h=c.loaded,m=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,m)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const c=s.getErrorCode()===wn.NO_ERROR,h=s.getStatus();if(!c||oT(h,this.additionalRetryCodes_)&&this.retry){const p=s.getErrorCode()===wn.ABORT;r(!1,new Ni(!1,null,p));return}const m=this.successCodes_.indexOf(h)!==-1;r(!0,new Ni(m,s))})},t=(r,i)=>{const s=this.resolve_,a=this.reject_,c=i.connection;if(i.wasSuccessCode)try{const h=this.callback_(c,c.getResponse());iT(h)?s(h):s()}catch(h){a(h)}else if(c!==null){const h=La();h.serverResponse=c.getErrorText(),this.errorCallback_?a(this.errorCallback_(c,h)):a(h)}else if(i.canceled){const h=this.appDelete_?Ud():Gv();a(h)}else{const h=Wv();a(h)}};this.canceled_?t(!1,new Ni(!1,null,!0)):this.backoffId_=nT(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&rT(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ni{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function cT(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function uT(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function lT(n,e){e&&(n["X-Firebase-GMPID"]=e)}function hT(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function dT(n,e,t,r,i,s,a=!0,c=!1){const h=Fd(n.urlParams),m=n.url+h,p=Object.assign({},n.headers);return lT(p,e),cT(p,t),uT(p,s),hT(p,r),new aT(m,n.method,p,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a,c)}function fT(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function pT(...n){const e=fT();if(e!==void 0){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(xa())return new Blob(n);throw new _e(ge.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function mT(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function gT(n){if(typeof atob>"u")throw Zv("base-64");return atob(n)}const ht={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class mo{constructor(e,t){this.data=e,this.contentType=t||null}}function _T(n,e){switch(n){case ht.RAW:return new mo(Bd(e));case ht.BASE64:case ht.BASE64URL:return new mo(jd(n,e));case ht.DATA_URL:return new mo(ET(e),vT(e))}throw La()}function Bd(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const s=r,a=n.charCodeAt(++t);r=65536|(s&1023)<<10|a&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function yT(n){let e;try{e=decodeURIComponent(n)}catch{throw Mr(ht.DATA_URL,"Malformed data URL.")}return Bd(e)}function jd(n,e){switch(n){case ht.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Mr(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case ht.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Mr(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=gT(e)}catch(i){throw i.message.includes("polyfill")?i:Mr(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class $d{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Mr(ht.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;r!=null&&(this.base64=TT(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function ET(n){const e=new $d(n);return e.base64?jd(ht.BASE64,e.rest):yT(e.rest)}function vT(n){return new $d(n).contentType}function TT(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class Ht{constructor(e,t){let r=0,i="";il(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(il(this.data_)){const r=this.data_,i=mT(r,e,t);return i===null?null:new Ht(i)}else{const r=new Uint8Array(this.data_.buffer,e,t-e);return new Ht(r,!0)}}static getBlob(...e){if(xa()){const t=e.map(r=>r instanceof Ht?r.data_:r);return new Ht(pT.apply(null,t))}else{const t=e.map(a=>Ma(a)?_T(ht.RAW,a).data:a.data_);let r=0;t.forEach(a=>{r+=a.byteLength});const i=new Uint8Array(r);let s=0;return t.forEach(a=>{for(let c=0;c<a.length;c++)i[s++]=a[c]}),new Ht(i,!0)}}uploadData(){return this.data_}}function qd(n){let e;try{e=JSON.parse(n)}catch{return null}return sT(e)?e:null}function wT(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function IT(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function Hd(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function AT(n,e){return e}class $e{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||AT}}let Di=null;function RT(n){return!Ma(n)||n.length<2?n:Hd(n)}function zd(){if(Di)return Di;const n=[];n.push(new $e("bucket")),n.push(new $e("generation")),n.push(new $e("metageneration")),n.push(new $e("name","fullPath",!0));function e(s,a){return RT(a)}const t=new $e("name");t.xform=e,n.push(t);function r(s,a){return a!==void 0?Number(a):a}const i=new $e("size");return i.xform=r,n.push(i),n.push(new $e("timeCreated")),n.push(new $e("updated")),n.push(new $e("md5Hash",null,!0)),n.push(new $e("cacheControl",null,!0)),n.push(new $e("contentDisposition",null,!0)),n.push(new $e("contentEncoding",null,!0)),n.push(new $e("contentLanguage",null,!0)),n.push(new $e("contentType",null,!0)),n.push(new $e("metadata","customMetadata",!0)),Di=n,Di}function ST(n,e){function t(){const r=n.bucket,i=n.fullPath,s=new Xe(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function bT(n,e,t){const r={};r.type="file";const i=t.length;for(let s=0;s<i;s++){const a=t[s];r[a.local]=a.xform(r,e[a.server])}return ST(r,n),r}function Wd(n,e,t){const r=qd(e);return r===null?null:bT(n,r,t)}function PT(n,e,t,r){const i=qd(e);if(i===null||!Ma(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const a=encodeURIComponent;return s.split(",").map(m=>{const p=n.bucket,v=n.fullPath,I="/b/"+a(p)+"/o/"+a(v),N=Ua(I,t,r),L=Fd({alt:"media",token:m});return N+L})[0]}function CT(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}class Gd{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Kd(n){if(!n)throw La()}function kT(n,e){function t(r,i){const s=Wd(n,i,e);return Kd(s!==null),s}return t}function NT(n,e){function t(r,i){const s=Wd(n,i,e);return Kd(s!==null),PT(s,i,n.host,n._protocol)}return t}function Qd(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=Hv():i=qv():t.getStatus()===402?i=$v(n.bucket):t.getStatus()===403?i=zv(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function DT(n){const e=Qd(n);function t(r,i){let s=e(r,i);return r.getStatus()===404&&(s=jv(n.path)),s.serverResponse=i.serverResponse,s}return t}function OT(n,e,t){const r=e.fullServerUrl(),i=Ua(r,n.host,n._protocol),s="GET",a=n.maxOperationRetryTime,c=new Gd(i,s,NT(n,t),a);return c.errorHandler=DT(e),c}function VT(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function LT(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=VT(null,e)),r}function MT(n,e,t,r,i){const s=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function c(){let H="";for(let J=0;J<2;J++)H=H+Math.random().toString().slice(2);return H}const h=c();a["Content-Type"]="multipart/related; boundary="+h;const m=LT(e,r,i),p=CT(m,t),v="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+p+`\r
--`+h+`\r
Content-Type: `+m.contentType+`\r
\r
`,I=`\r
--`+h+"--",N=Ht.getBlob(v,r,I);if(N===null)throw Xv();const L={name:m.fullPath},F=Ua(s,n.host,n._protocol),x="POST",Q=n.maxUploadRetryTime,q=new Gd(F,x,kT(n,t),Q);return q.urlParams=L,q.headers=a,q.body=N.uploadData(),q.errorHandler=Qd(e),q}class xT{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=wn.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=wn.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=wn.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i,s){if(this.sent_)throw Ir("cannot .send() more than once");if(Dt(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),s!==void 0)for(const a in s)s.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,s[a].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Ir("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Ir("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Ir("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Ir("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class UT extends xT{initXhr(){this.xhr_.responseType="text"}}function Jd(){return new UT}class bn{constructor(e,t){this._service=e,t instanceof Xe?this._location=t:this._location=Xe.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new bn(e,t)}get root(){const e=new Xe(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Hd(this._location.path)}get storage(){return this._service}get parent(){const e=wT(this._location.path);if(e===null)return null;const t=new Xe(this._location.bucket,e);return new bn(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw eT(e)}}function FT(n,e,t){n._throwIfRoot("uploadBytes");const r=MT(n.storage,n._location,zd(),new Ht(e,!0),t);return n.storage.makeRequestWithTokens(r,Jd).then(i=>({metadata:i,ref:n}))}function BT(n){n._throwIfRoot("getDownloadURL");const e=OT(n.storage,n._location,zd());return n.storage.makeRequestWithTokens(e,Jd).then(t=>{if(t===null)throw Yv();return t})}function jT(n,e){const t=IT(n._location.path,e),r=new Xe(n._location.bucket,t);return new bn(n.storage,r)}function $T(n){return/^[A-Za-z]+:\/\//.test(n)}function qT(n,e){return new bn(n,e)}function Xd(n,e){if(n instanceof Fa){const t=n;if(t._bucket==null)throw Jv();const r=new bn(t,t._bucket);return e!=null?Xd(r,e):r}else return e!==void 0?jT(n,e):n}function HT(n,e){if(e&&$T(e)){if(n instanceof Fa)return qT(n,e);throw jo("To use ref(service, url), the first argument must be a Storage instance.")}else return Xd(n,e)}function ol(n,e){const t=e?.[xd];return t==null?null:Xe.makeFromBucketSpec(t,n)}function zT(n,e,t,r={}){n.host=`${e}:${t}`;const i=Dt(e);i&&(fs(`https://${n.host}/b`),ps("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:vl(s,n.app.options.projectId))}class Fa{constructor(e,t,r,i,s,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=a,this._bucket=null,this._host=Md,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Fv,this._maxUploadRetryTime=Bv,this._requests=new Set,i!=null?this._bucket=Xe.makeFromBucketSpec(i,this._host):this._bucket=ol(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Xe.makeFromBucketSpec(this._url,e):this._bucket=ol(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){sl("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){sl("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Qe(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new bn(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new tT(Ud());{const a=dT(e,this._appId,r,i,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const al="@firebase/storage",cl="0.13.14";const Yd="storage";function Dw(n,e,t){return n=fe(n),FT(n,e,t)}function Ow(n){return n=fe(n),BT(n)}function Vw(n,e){return n=fe(n),HT(n,e)}function Lw(n=ms(),e){n=fe(n);const r=Kr(n,Yd).getImmediate({identifier:e}),i=zo("storage");return i&&WT(r,...i),r}function WT(n,e,t,r={}){zT(n,e,t,r)}function GT(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Fa(t,r,i,e,Pn)}function KT(){Xt(new St(Yd,GT,"PUBLIC").setMultipleInstances(!0)),et(al,cl,""),et(al,cl,"esm2017")}KT();const QT="type.googleapis.com/google.protobuf.Int64Value",JT="type.googleapis.com/google.protobuf.UInt64Value";function Zd(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function us(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>us(e));if(typeof n=="function"||typeof n=="object")return Zd(n,e=>us(e));throw new Error("Data cannot be encoded in JSON: "+n)}function nr(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case QT:case JT:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>nr(e)):typeof n=="function"||typeof n=="object"?Zd(n,e=>nr(e)):n}const Ba="functions";const ul={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ze extends at{constructor(e,t,r){super(`${Ba}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,ze.prototype)}}function XT(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function ls(n,e){let t=XT(n),r=t,i;try{const s=e&&e.error;if(s){const a=s.status;if(typeof a=="string"){if(!ul[a])return new ze("internal","internal");t=ul[a],r=a}const c=s.message;typeof c=="string"&&(r=c),i=s.details,i!==void 0&&(i=nr(i))}}catch{}return t==="ok"?null:new ze(t,r,i)}class YT{constructor(e,t,r,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Qe(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||i?.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:i}}}const $o="us-central1",ZT=/^data: (.*?)(?:\n|$)/;function ew(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new ze("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class tw{constructor(e,t,r,i,s=$o,a=(...c)=>fetch(...c)){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new YT(e,t,r,i),this.cancelAllRequests=new Promise(c=>{this.deleteService=()=>Promise.resolve(c())});try{const c=new URL(s);this.customDomain=c.origin+(c.pathname==="/"?"":c.pathname),this.region=$o}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function nw(n,e,t){const r=Dt(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(fs(n.emulatorOrigin),ps("Functions",!0))}function rw(n,e,t){const r=i=>sw(n,e,i,{});return r.stream=(i,s)=>aw(n,e,i,s),r}async function iw(n,e,t,r){t["Content-Type"]="application/json";let i;try{i=await r(n,{method:"POST",body:JSON.stringify(e),headers:t})}catch{return{status:0,json:null}}let s=null;try{s=await i.json()}catch{}return{status:i.status,json:s}}async function ef(n,e){const t={},r=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t}function sw(n,e,t,r){const i=n._url(e);return ow(n,i,t,r)}async function ow(n,e,t,r){t=us(t);const i={data:t},s=await ef(n,r),a=r.timeout||7e4,c=ew(a),h=await Promise.race([iw(e,i,s,n.fetchImpl),c.promise,n.cancelAllRequests]);if(c.cancel(),!h)throw new ze("cancelled","Firebase Functions instance was deleted.");const m=ls(h.status,h.json);if(m)throw m;if(!h.json)throw new ze("internal","Response is not valid JSON object.");let p=h.json.data;if(typeof p>"u"&&(p=h.json.result),typeof p>"u")throw new ze("internal","Response is missing data field.");return{data:nr(p)}}function aw(n,e,t,r){const i=n._url(e);return cw(n,i,t,r||{})}async function cw(n,e,t,r){var i;t=us(t);const s={data:t},a=await ef(n,r);a["Content-Type"]="application/json",a.Accept="text/event-stream";let c;try{c=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:a,signal:r?.signal})}catch(N){if(N instanceof Error&&N.name==="AbortError"){const F=new ze("cancelled","Request was cancelled.");return{data:Promise.reject(F),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(F)}}}}}}const L=ls(0,null);return{data:Promise.reject(L),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(L)}}}}}}let h,m;const p=new Promise((N,L)=>{h=N,m=L});(i=r?.signal)===null||i===void 0||i.addEventListener("abort",()=>{const N=new ze("cancelled","Request was cancelled.");m(N)});const v=c.body.getReader(),I=uw(v,h,m,r?.signal);return{stream:{[Symbol.asyncIterator](){const N=I.getReader();return{async next(){const{value:L,done:F}=await N.read();return{value:L,done:F}},async return(){return await N.cancel(),{done:!0,value:void 0}}}}},data:p}}function uw(n,e,t,r){const i=(a,c)=>{const h=a.match(ZT);if(!h)return;const m=h[1];try{const p=JSON.parse(m);if("result"in p){e(nr(p.result));return}if("message"in p){c.enqueue(nr(p.message));return}if("error"in p){const v=ls(0,p);c.error(v),t(v);return}}catch(p){if(p instanceof ze){c.error(p),t(p);return}}},s=new TextDecoder;return new ReadableStream({start(a){let c="";return h();async function h(){if(r?.aborted){const m=new ze("cancelled","Request was cancelled");return a.error(m),t(m),Promise.resolve()}try{const{value:m,done:p}=await n.read();if(p){c.trim()&&i(c.trim(),a),a.close();return}if(r?.aborted){const I=new ze("cancelled","Request was cancelled");a.error(I),t(I),await n.cancel();return}c+=s.decode(m,{stream:!0});const v=c.split(`
`);c=v.pop()||"";for(const I of v)I.trim()&&i(I.trim(),a);return h()}catch(m){const p=m instanceof ze?m:ls(0,null);a.error(p),t(p)}}},cancel(){return n.cancel()}})}const ll="@firebase/functions",hl="0.12.9";const lw="auth-internal",hw="app-check-internal",dw="messaging-internal";function fw(n){const e=(t,{instanceIdentifier:r})=>{const i=t.getProvider("app").getImmediate(),s=t.getProvider(lw),a=t.getProvider(dw),c=t.getProvider(hw);return new tw(i,s,a,c,r)};Xt(new St(Ba,e,"PUBLIC").setMultipleInstances(!0)),et(ll,hl,n),et(ll,hl,"esm2017")}function Mw(n=ms(),e=$o){const r=Kr(fe(n),Ba).getImmediate({identifier:e}),i=zo("functions");return i&&pw(r,...i),r}function pw(n,e,t){nw(fe(n),e,t)}function xw(n,e,t){return rw(fe(n),e)}fw();export{Vf as B,_w as _,yw as a,Sw as b,Lw as c,bw as d,wv as e,vw as f,Iw as g,Xl as h,om as i,Ew as j,kw as k,Nw as l,Rw as m,Pw as n,Tw as o,Dw as p,Ow as q,Vw as r,ww as s,Mw as t,Cw as u,xw as v};
