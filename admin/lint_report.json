[{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\Dashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\LoginPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\MyLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\authProvider.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\components\\AgentPdf.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\dataProvider.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'GetListParams' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'GetListResult' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'GetOneResult' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'GetManyResult' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'GetManyReferenceParams' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'GetManyReferenceResult' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CreateResult' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'UpdateResult' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'UpdateManyResult' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DeleteResult' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Event' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Consigne' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Agent' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":37},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'id' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":123,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":123,"endColumn":19}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type {\r\n    DataProvider,\r\n    GetListParams,\r\n    GetListResult,\r\n    GetOneParams,\r\n    GetOneResult,\r\n    GetManyParams,\r\n    GetManyResult,\r\n    GetManyReferenceParams,\r\n    GetManyReferenceResult,\r\n    CreateParams,\r\n    CreateResult,\r\n    UpdateParams,\r\n    UpdateResult,\r\n    UpdateManyParams,\r\n    UpdateManyResult,\r\n    DeleteParams,\r\n    DeleteResult\r\n} from 'react-admin';\r\nimport {\r\n    collection,\r\n    doc,\r\n    getDocs,\r\n    getDoc,\r\n    addDoc,\r\n    updateDoc,\r\n    deleteDoc\r\n} from 'firebase/firestore';\r\nimport { ref, uploadBytes, getDownloadURL } from 'firebase/storage';\r\nimport { db, storage } from './firebase';\r\nimport type { Event, Consigne, Agent } from '@mocyno/types';\r\n\r\ninterface FileUpload {\r\n    rawFile: File;\r\n    src?: string;\r\n    title?: string;\r\n}\r\n\r\nconst convertFileToUrl = async (file: string | FileUpload): Promise<string> => {\r\n    if (typeof file === 'string') return file;\r\n    if (!file || !file.rawFile) return '';\r\n\r\n    const storageRef = ref(storage, `agents/photos/${file.rawFile.name}`);\r\n    await uploadBytes(storageRef, file.rawFile);\r\n    const downloadURL = await getDownloadURL(storageRef);\r\n    return downloadURL;\r\n};\r\n\r\nconst dataProvider: DataProvider = {\r\n    getList: async (resource: string) => {\r\n        const querySnapshot = await getDocs(collection(db, resource));\r\n        const data = querySnapshot.docs.map(doc => ({\r\n            id: doc.id,\r\n            ...doc.data()\r\n        }));\r\n\r\n        return {\r\n            data,\r\n            total: data.length,\r\n        };\r\n    },\r\n\r\n    getOne: async (resource: string, params: GetOneParams) => {\r\n        const docRef = doc(db, resource, params.id.toString());\r\n        const docSnap = await getDoc(docRef);\r\n\r\n        if (docSnap.exists()) {\r\n            return {\r\n                data: {\r\n                    id: docSnap.id,\r\n                    ...docSnap.data()\r\n                }\r\n            };\r\n        }\r\n\r\n        throw new Error(`Document not found: ${resource}/${params.id}`);\r\n    },\r\n\r\n    getMany: async (resource: string, params: GetManyParams) => {\r\n        const querySnapshot = await getDocs(collection(db, resource));\r\n        const data = querySnapshot.docs\r\n            .filter(doc => params.ids.includes(doc.id))\r\n            .map(doc => ({\r\n                id: doc.id,\r\n                ...doc.data()\r\n            }));\r\n\r\n        return { data };\r\n    },\r\n\r\n    getManyReference: async (resource: string) => {\r\n        const querySnapshot = await getDocs(collection(db, resource));\r\n        const data = querySnapshot.docs.map(doc => ({\r\n            id: doc.id,\r\n            ...doc.data()\r\n        }));\r\n\r\n        return {\r\n            data,\r\n            total: data.length\r\n        };\r\n    },\r\n\r\n    create: async (resource: string, params: CreateParams) => {\r\n        const newItem = { ...params.data };\r\n\r\n        // Handle file upload for photoURL\r\n        if (newItem.photoURL) {\r\n            newItem.photoURL = await convertFileToUrl(newItem.photoURL);\r\n        }\r\n\r\n        const docRef = await addDoc(collection(db, resource), newItem);\r\n\r\n        return {\r\n            data: {\r\n                ...newItem,\r\n                id: docRef.id\r\n            }\r\n        };\r\n    },\r\n\r\n    update: async (resource: string, params: UpdateParams) => {\r\n        const { id, ...rest } = params.data;\r\n\r\n        // Handle file upload\r\n        if (rest.photoURL && typeof rest.photoURL !== 'string') {\r\n            rest.photoURL = await convertFileToUrl(rest.photoURL);\r\n        }\r\n\r\n        // Remove undefined values\r\n        const data: Record<string, unknown> = {};\r\n        Object.keys(rest).forEach(key => {\r\n            if (rest[key] !== undefined) {\r\n                data[key] = rest[key];\r\n            }\r\n        });\r\n\r\n        const docRef = doc(db, resource, params.id.toString());\r\n        await updateDoc(docRef, data);\r\n\r\n        return {\r\n            data: params.data\r\n        };\r\n    },\r\n\r\n    updateMany: async (resource: string, params: UpdateManyParams) => {\r\n        for (const id of params.ids) {\r\n            const docRef = doc(db, resource, id.toString());\r\n            await updateDoc(docRef, params.data);\r\n        }\r\n\r\n        return {\r\n            data: params.ids\r\n        };\r\n    },\r\n\r\n    delete: async (resource: string, params: DeleteParams) => {\r\n        const docRef = doc(db, resource, params.id.toString());\r\n        await deleteDoc(docRef);\r\n\r\n        return {\r\n            data: params.previousData\r\n        };\r\n    },\r\n\r\n    deleteMany: async (resource: string, params: DeleteManyParams) => {\r\n        for (const id of params.ids) {\r\n            const docRef = doc(db, resource, id.toString());\r\n            await deleteDoc(docRef);\r\n        }\r\n\r\n        return {\r\n            data: params.ids\r\n        };\r\n    }\r\n};\r\n\r\nexport default dataProvider;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\firebase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\hooks\\usePlanning.ts","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Declaration or statement expected.","line":79,"column":0}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useGetList } from 'react-admin';\r\nimport { useMemo } from 'react';\r\nconst { data: missions, isLoading: loadingMissions } = useGetList('planning');\r\nconst { data: agents, isLoading: loadingAgents } = useGetList('agents');\r\nconst { data: sites, isLoading: loadingSites } = useGetList('sites');\r\n\r\nconst events = useMemo(() => {\r\n    if (!missions || !agents || !sites) return [];\r\n\r\n    const calendarEvents: PlanningEvent[] = [];\r\n\r\n    (missions as Mission[]).forEach((mission: Mission) => {\r\n        if (!mission.agentAssignments) return;\r\n\r\n        const site = (sites as Site[]).find((s: Site) => s.id === mission.siteId);\r\n\r\n        mission.agentAssignments.forEach((assignment: AgentAssignment, assignmentIdx: number) => {\r\n            const agent = (agents as Agent[]).find((a: Agent) => a.id === assignment.agentId);\r\n\r\n            assignment.vacations.forEach((vacation: Vacation, vacationIdx: number) => {\r\n                const start = moment(`${vacation.date}T${vacation.start}`);\r\n                const end = moment(`${vacation.date}T${vacation.end}`);\r\n\r\n                // Handle overnight shifts\r\n                if (end.isBefore(start)) {\r\n                    end.add(1, 'day');\r\n                }\r\n\r\n                calendarEvents.push({\r\n                    id: `${mission.id}-${assignmentIdx}-${vacationIdx}`,\r\n                    title: site?.name || 'Site inconnu',\r\n                    start: start.toDate(),\r\n                    end: end.toDate(),\r\n                    agentId: assignment.agentId,\r\n                    agentName: agent ? `${agent.firstName} ${agent.lastName}` : assignment.agentName,\r\n                    missionId: mission.id,\r\n                    siteId: mission.siteId,\r\n                    siteName: site?.name || '',\r\n                    assignmentIdx,\r\n                    vacationIdx,\r\n                    color: agent?.status === 'active' ? '#1976d2' : '#9e9e9e',\r\n                    allDay: false\r\n                });\r\n            });\r\n        });\r\n    });\r\n\r\n    return calendarEvents;\r\n}, [missions, agents, sites]);\r\n\r\nconst schedules = useMemo(() => {\r\n    if (!agents || !events) return [];\r\n\r\n    return (agents as Agent[])\r\n        .filter((agent: Agent) => agent.role !== 'admin')\r\n        .map((agent: Agent) => {\r\n            const agentEvents = events.filter((e: PlanningEvent) => e.agentId === agent.id);\r\n            const totalHours = agentEvents.reduce((sum: number, event: PlanningEvent) => {\r\n                const duration = moment(event.end).diff(moment(event.start), 'hours', true);\r\n                return sum + duration;\r\n            }, 0);\r\n\r\n            return {\r\n                agent,\r\n                events: agentEvents,\r\n                totalHours\r\n            };\r\n        });\r\n}, [agents, events]);\r\n\r\nreturn {\r\n    events,\r\n    schedules: schedules as AgentSchedule[],\r\n    agents: (agents || []) as Agent[],\r\n    missions: (missions || []) as Mission[],\r\n    sites: (sites || []) as Site[],\r\n    isLoading: loadingMissions || loadingAgents || loadingSites\r\n};\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\pages\\Agents.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Declaration or statement expected.","line":10,"column":0}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport {\r\n    List, Datagrid, TextField, EmailField, DateField, Create, Edit, SimpleForm,\r\n    TextInput, required, useNotify, useRedirect, Title, SelectArrayInput,\r\n    FunctionField, SelectInput, TabbedForm, FormTab, DateInput, ImageField, ImageInput, TopToolbar,\r\n    FormDataConsumer, regex, useRefresh, useRecordContext\r\n} from 'react-admin';\r\nimport { getFunctions, httpsCallable } from 'firebase/functions';\r\nimport { PDFDownloadLink } from '@react-pdf/renderer';\r\n};\r\n\r\n// Validation for Dog ID: 250 268 780 869 046 (15 digits usually displayed in groups)\r\n// Regex: 15 digits, allowing spaces\r\nconst validateDogId = regex(/^\\d{3}\\s?\\d{3}\\s?\\d{3}\\s?\\d{3}\\s?\\d{3}$/, 'Format requis: 250 268 780 869 046 (15 chiffres)');\r\n\r\nconst GenerateMatriculeButton = () => {\r\n    const record = useRecordContext();\r\n    const refresh = useRefresh();\r\n    const notify = useNotify();\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    if (!record || record.matricule) return null;\r\n\r\n    const handleGenerate = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const functions = getFunctions(undefined, 'europe-west1');\r\n            const generateMatricule = httpsCallable(functions, 'generateMatricule');\r\n            await generateMatricule({ agentId: record.id });\r\n            notify('Matricule généré avec succès');\r\n            refresh();\r\n        } catch (error: unknown) {\r\n            const errorMessage = error instanceof Error ? error.message : 'Erreur inconnue';\r\n            console.error(error);\r\n            notify(`Erreur: ${errorMessage}`, { type: 'error' });\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            size=\"small\"\r\n            onClick={handleGenerate}\r\n            disabled={loading}\r\n            startIcon={<GenerateIcon />}\r\n            sx={{ mt: 2, mb: 2 }}\r\n        >\r\n            {loading ? 'Génération...' : 'Générer Matricule'}\r\n        </Button>\r\n    );\r\n};\r\n\r\nconst AgentDownloadButtons = () => {\r\n    const record = useRecordContext();\r\n    const [photoBase64, setPhotoBase64] = useState<string | null>(null);\r\n    const [logoBase64, setLogoBase64] = useState<string | null>(null);\r\n    const [loadingImages, setLoadingImages] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const loadImages = async () => {\r\n            if (!record) return;\r\n\r\n            // Avoid re-loading if already set\r\n            if (photoBase64 !== null && logoBase64 !== null) return;\r\n            if (loadingImages) return;\r\n\r\n            setLoadingImages(true);\r\n\r\n            // Safety timeout promise\r\n            const timeoutPromise = new Promise((_, reject) =>\r\n                setTimeout(() => reject(new Error('Image loading timed out')), 5000)\r\n            );\r\n\r\n            const loadProcess = async () => {\r\n                // 1. Load Agent Photo\r\n                let photoData = photoBase64;\r\n                if (record.photoURL && !photoData) {\r\n                    try {\r\n                        // Use the utility function which uses fetch (CORS now supported)\r\n                        // This avoids using getBlob which requires Buffer polyfill\r\n                        photoData = await imageUrlToPngBase64(record.photoURL);\r\n                        setPhotoBase64(photoData);\r\n                    } catch (err) {\r\n                        console.error(\"Failed to load agent photo:\", err);\r\n                        setPhotoBase64('');\r\n                    }\r\n                } else if (!photoData) {\r\n                    setPhotoBase64(''); // No URL, validly empty\r\n                }\r\n\r\n                // 2. Load Logo\r\n                let logoData = logoBase64;\r\n                if (!logoData) {\r\n                    try {\r\n                        logoData = await imageUrlToPngBase64('/mocyno-logo.png');\r\n                        setLogoBase64(logoData);\r\n                    } catch (err) {\r\n                        console.warn(\"Failed to load logo:\", err);\r\n                        setLogoBase64('');\r\n                    }\r\n                }\r\n            };\r\n\r\n            try {\r\n                // Race between loading and timeout\r\n                await Promise.race([loadProcess(), timeoutPromise]);\r\n            } catch (error) {\r\n                console.error(\"Error or timeout in loadImages:\", error);\r\n                // Ensure values are set to strings so UI unblocks\r\n                setPhotoBase64(prev => prev ?? '');\r\n                setLogoBase64(prev => prev ?? '');\r\n            } finally {\r\n                setLoadingImages(false);\r\n            }\r\n        };\r\n\r\n        loadImages();\r\n    }, [record, photoBase64, logoBase64, loadingImages]);\r\n\r\n    if (!record) return null;\r\n\r\n    const ready = !loadingImages && (logoBase64 !== null);\r\n\r\n    return (\r\n        <div style={{ display: 'flex', gap: 10 }}>\r\n            {ready ? (\r\n                <>\r\n                    <PDFDownloadLink\r\n                        document={<AgentBadgePdf agent={record} photoBase64={photoBase64} logoBase64={logoBase64} />}\r\n                        fileName={`Badge-${record.lastName || 'Agent'}.pdf`}\r\n                    >\r\n                        {({ loading }) => (\r\n                            <Button variant=\"contained\" color=\"primary\" startIcon={<DownloadIcon />} disabled={loading}>\r\n                                {loading ? <CircularProgress size={24} color=\"inherit\" /> : 'Badge Agent'}\r\n                            </Button>\r\n                        )}\r\n                    </PDFDownloadLink>\r\n\r\n                    <PDFDownloadLink\r\n                        document={<AgentProfilePdf agent={record} photoBase64={photoBase64} />}\r\n                        fileName={`Fiche-${record.lastName || 'Agent'}.pdf`}\r\n                    >\r\n                        {({ loading }) => (\r\n                            <Button variant=\"contained\" color=\"secondary\" startIcon={<DownloadIcon />} disabled={loading}>\r\n                                {loading ? <CircularProgress size={24} color=\"inherit\" /> : 'Fiche Renseignements'}\r\n                            </Button>\r\n                        )}\r\n                    </PDFDownloadLink>\r\n                </>\r\n            ) : (\r\n                <Button variant=\"contained\" disabled startIcon={<DownloadIcon />}>\r\n                    Chargement Images...\r\n                </Button>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport const AgentList = () => (\r\n    <List>\r\n        <Datagrid rowClick=\"edit\">\r\n            <FunctionField label=\"Photo\" render={(record: Agent) =>\r\n                record.photoURL ? <img src={record.photoURL} style={{ width: 40, height: 40, borderRadius: '50%', objectFit: 'cover' }} alt=\"\" /> : null\r\n            } />\r\n            <TextField source=\"matricule\" label=\"Matricule\" />\r\n            <TextField source=\"firstName\" label=\"Prénom\" />\r\n            <TextField source=\"lastName\" label=\"Nom\" />\r\n            <TextField source=\"professionalCardNumber\" label=\"Carte Pro\" />\r\n            <EmailField source=\"email\" />\r\n            <FunctionField label=\"Spécialités\" render={(record: Agent) => record.specialties ? record.specialties.join(', ') : ''} />\r\n            <TextField source=\"status\" />\r\n            <DateField source=\"createdAt\" label=\"Créé le\" />\r\n        </Datagrid>\r\n    </List>\r\n);\r\n\r\nconst UserEditActions = () => (\r\n    <TopToolbar>\r\n    </TopToolbar>\r\n);\r\n\r\nexport const AgentEdit = () => (\r\n    <Edit actions={<UserEditActions />}>\r\n        <Title title=\"Modifier l'Agent\" />\r\n        <TabbedForm>\r\n            <FormTab label=\"Identité\">\r\n                <TextInput source=\"id\" disabled />\r\n                <TextInput source=\"matricule\" disabled label=\"Matricule (Auto)\" />\r\n                <GenerateMatriculeButton />\r\n                <TextInput source=\"email\" disabled label=\"Email (Non modifiable)\" fullWidth />\r\n\r\n                <ImageInput source=\"photoURL\" label=\"Photo d'Identité\" accept={{ 'image/*': ['.png', '.jpg', '.jpeg'] }}>\r\n                    <ImageField source=\"src\" title=\"title\" />\r\n                </ImageInput>\r\n\r\n                <TextInput source=\"firstName\" label=\"Prénom\" validate={required()} fullWidth />\r\n                <TextInput source=\"lastName\" label=\"Nom\" validate={required()} fullWidth />\r\n\r\n                <DateInput source=\"birthDate\" label=\"Date de Naissance\" fullWidth />\r\n                <TextInput source=\"birthPlace\" label=\"Lieu de Naissance\" fullWidth />\r\n                <TextInput source=\"nationality\" label=\"Nationalité\" fullWidth />\r\n\r\n                <SelectInput source=\"gender\" label=\"Genre\" choices={[\r\n                    { id: 'M', name: 'Masculin' },\r\n                    { id: 'F', name: 'Féminin' },\r\n                ]} fullWidth />\r\n\r\n                <SelectInput source=\"bloodGroup\" label=\"Groupe Sanguin\" choices={[\r\n                    { id: 'A+', name: 'A+' }, { id: 'A-', name: 'A-' },\r\n                    { id: 'B+', name: 'B+' }, { id: 'B-', name: 'B-' },\r\n                    { id: 'AB+', name: 'AB+' }, { id: 'AB-', name: 'AB-' },\r\n                    { id: 'O+', name: 'O+' }, { id: 'O-', name: 'O-' },\r\n                ]} fullWidth />\r\n            </FormTab>\r\n\r\n            <FormTab label=\"Coordonnées\">\r\n                <TextInput source=\"address\" label=\"Adresse Postale\" fullWidth multiline />\r\n                <TextInput source=\"zipCode\" label=\"Code Postal\" fullWidth />\r\n                <TextInput source=\"city\" label=\"Ville\" fullWidth />\r\n                <TextInput source=\"phone\" label=\"Téléphone\" fullWidth />\r\n            </FormTab>\r\n\r\n            <FormTab label=\"Professionnel\">\r\n                <SelectArrayInput source=\"specialties\" label=\"Spécialités\" choices={[\r\n                    { id: 'ADS', name: 'Agent de Sécurité (ADS)' },\r\n                    { id: 'SSIAP1', name: 'SSIAP 1' },\r\n                    { id: 'SSIAP2', name: 'SSIAP 2' },\r\n                    { id: 'CYNO', name: 'Agent Cynophile' },\r\n                    { id: 'RONDIER', name: 'Rondier' },\r\n                    { id: 'VIDEO', name: 'Opérateur Vidéo' },\r\n                ]} fullWidth />\r\n\r\n                <FormDataConsumer>\r\n                    {({ formData, ...rest }) =>\r\n                        formData.specialties && formData.specialties.includes('CYNO') &&\r\n                        <TextInput\r\n                            source=\"dogIds\"\r\n                            label=\"Numéro(s) d'identification Chien (250...)\"\r\n                            validate={validateDogId}\r\n                            fullWidth\r\n                            helperText=\"15 chiffres (Ex: 250 268 780 869 046)\"\r\n                            {...rest}\r\n                        />\r\n                    }\r\n                </FormDataConsumer>\r\n\r\n                <TextInput source=\"professionalCardNumber\" label=\"Numéro de Carte Pro (Ex: CAR-083-2030-03-18-XXXXXXXXXXX)\" validate={validateCardPro} fullWidth />\r\n                <DateInput source=\"professionalCardObtainedAt\" label=\"Date d'Obtention Carte Pro\" fullWidth />\r\n                <FunctionField label=\"Date Validité (Calculée)\" render={(record: any) => {\r\n                    if (!record.professionalCardObtainedAt) return '-';\r\n                    const date = new Date(record.professionalCardObtainedAt);\r\n                    date.setFullYear(date.getFullYear() + 5);\r\n                    return date.toLocaleDateString();\r\n                }} />\r\n\r\n                <TextInput source=\"sstNumber\" label=\"Numéro SST\" fullWidth />\r\n                <DateInput source=\"sstObtainedAt\" label=\"Date Obtention SST\" fullWidth />\r\n                <DateInput source=\"sstExpiresAt\" label=\"Date Expiration SST\" fullWidth />\r\n\r\n                <SelectInput source=\"contractNature\" label=\"Nature du Contrat\" choices={[\r\n                    { id: 'CDI', name: 'CDI' },\r\n                    { id: 'CDD', name: 'CDD' },\r\n                    { id: 'SAISONNIER', name: 'Saisonnier' },\r\n                    { id: 'EXTRA', name: 'Extra / Vacation' },\r\n                    { id: 'INTERIM', name: 'Intérim' },\r\n                ]} fullWidth />\r\n\r\n                <SelectInput source=\"contractType\" label=\"Type de Contrat\" choices={[\r\n                    { id: 'FULL_TIME', name: 'Temps Plein (35h)' },\r\n                    { id: 'PART_TIME', name: 'Temps Partiel' },\r\n                ]} fullWidth />\r\n            </FormTab>\r\n\r\n            <FormTab label=\"Administratif & Documents\">\r\n                <TextInput source=\"socialSecurityNumber\" label=\"Numéro de Sécurité Sociale\" fullWidth />\r\n                <TextInput source=\"bankName\" label=\"Nom de la Banque\" fullWidth />\r\n                <TextInput source=\"iban\" label=\"IBAN\" fullWidth />\r\n                <TextInput source=\"bic\" label=\"BIC\" fullWidth />\r\n\r\n                <div style={{ marginTop: 20 }}>\r\n                    <h3>Téléchargements</h3>\r\n                    <AgentDownloadButtons />\r\n                </div>\r\n            </FormTab>\r\n\r\n            <FormTab label=\"Compte\">\r\n                <SelectInput source=\"status\" label=\"Statut Compte\" choices={[\r\n                    { id: 'active', name: 'Actif' },\r\n                    { id: 'inactive', name: 'Inactif' },\r\n                ]} defaultValue=\"active\" fullWidth />\r\n            </FormTab>\r\n        </TabbedForm>\r\n    </Edit>\r\n);\r\n\r\nexport const AgentCreate = () => {\r\n    const [, setLoading] = useState(false);\r\n    const notify = useNotify();\r\n    const redirect = useRedirect();\r\n\r\n    const save = async (data: any) => {\r\n        setLoading(true);\r\n        try {\r\n            // Handle Photo Upload Manually first\r\n            let photoUrl = null;\r\n            if (data.photoURL && data.photoURL.rawFile) {\r\n                const file = data.photoURL.rawFile;\r\n                const storageRef = ref(storage, `agents/photos/${file.name}`);\r\n                await uploadBytes(storageRef, file);\r\n                photoUrl = await getDownloadURL(storageRef);\r\n            }\r\n\r\n            const functions = getFunctions(undefined, 'europe-west1');\r\n            const createAgent = httpsCallable(functions, 'createAgent');\r\n\r\n            await createAgent({\r\n                ...data,\r\n                photoURL: photoUrl\r\n            });\r\n            notify('Agent créé avec succès');\r\n            redirect('/agents');\r\n        } catch (error: any) {\r\n            console.error(error);\r\n            notify(`Erreur: ${error.message}`, { type: 'error' });\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Create>\r\n            <SimpleForm onSubmit={save}>\r\n                <TextInput source=\"firstName\" label=\"Prénom\" validate={required()} fullWidth />\r\n                <TextInput source=\"lastName\" label=\"Nom\" validate={required()} fullWidth />\r\n                <TextInput source=\"email\" label=\"Email\" validate={[required()]} fullWidth type=\"email\" />\r\n\r\n                <ImageInput source=\"photoURL\" label=\"Photo d'Identité\" accept={{ 'image/*': ['.png', '.jpg', '.jpeg'] }}>\r\n                    <ImageField source=\"src\" title=\"title\" />\r\n                </ImageInput>\r\n\r\n                <SelectArrayInput source=\"specialties\" label=\"Spécialités\" choices={[\r\n                    { id: 'ADS', name: 'Agent de Sécurité (ADS)' },\r\n                    { id: 'SSIAP1', name: 'SSIAP 1' },\r\n                    { id: 'SSIAP2', name: 'SSIAP 2' },\r\n                    { id: 'CYNO', name: 'Agent Cynophile' },\r\n                    { id: 'RONDIER', name: 'Rondier' },\r\n                    { id: 'VIDEO', name: 'Opérateur Vidéo' },\r\n                ]} fullWidth />\r\n            </SimpleForm>\r\n        </Create>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\pages\\Consignes.tsx","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":29,"fix":{"range":[1168,1171],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1168,1171],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1168,1171],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\pages\\Events.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: JSX expressions must have one parent element.","line":1,"column":12}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"            <TextField source=\"authorEmail\" label=\"Agent\" />\r\n            <DateField source=\"timestamp\" showTime label=\"Date\" />\r\n            <TextField source=\"status\" label=\"Statut\" />\r\n        </Datagrid >\r\n    </List >\r\n);\r\n\r\nexport const EventShow = () => (\r\n    <Show>\r\n        <SimpleShowLayout>\r\n            <TextField source=\"type\" variant=\"h6\" />\r\n            <TextField source=\"title\" variant=\"h4\" />\r\n            <DateField source=\"timestamp\" showTime />\r\n            <TextField source=\"authorEmail\" label=\"Auteur\" />\r\n            <TextField source=\"description\" style={{ marginTop: '20px', whiteSpace: 'pre-wrap' }} />\r\n\r\n            <FunctionField\r\n                label=\"Preuve Photo\"\r\n                render={(record: Event) => {\r\n                    if (!record.photo) return null;\r\n                    return (\r\n                        <div style={{ marginTop: '20px' }}>\r\n                            <img src={record.photo} alt=\"Preuve\" style={{ maxWidth: '500px', borderRadius: '4px' }} />\r\n                        </div>\r\n                    );\r\n                }}\r\n            />\r\n        </SimpleShowLayout>\r\n    </Show>\r\n);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\pages\\Payroll.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Declaration or statement expected.","line":202,"column":0}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useMemo, useState } from 'react';\r\nimport { Button, Grid as Grid2, Typography, Box, Paper, Avatar, Divider, Chip, CircularProgress } from '@mui/material';\r\nimport { Title, useGetList, Loading, useNotify } from 'react-admin';\r\nimport DownloadIcon from '@mui/icons-material/Download';\r\nimport NightlightRoundIcon from '@mui/icons-material/NightlightRound';\r\nimport CalendarTodayIcon from '@mui/icons-material/CalendarToday';\r\nimport StarIcon from '@mui/icons-material/Star';\r\nconst { data: planning, isLoading: loadingPlanning } = useGetList('planning');\r\nconst notify = useNotify();\r\nconst [sendingEmail, setSendingEmail] = useState<string | null>(null);\r\n\r\nconst handleSendPlanning = async (agentId: string) => {\r\n    setSendingEmail(agentId);\r\n    try {\r\n        const functions = getFunctions(undefined, 'europe-west1');\r\n        const sendSummary = httpsCallable(functions, 'sendAgentPlanningSummary');\r\n        const result = await sendSummary({ agentId });\r\n\r\n        notify((result.data as { message?: string }).message || 'Planning renvoyé avec succès', { type: 'success' });\r\n    } catch (error: unknown) {\r\n        const errorMessage = error instanceof Error ? error.message : 'Erreur inconnue';\r\n        console.error(\"Error sending planning:\", error);\r\n        notify(`Erreur: ${errorMessage}`, { type: 'error' });\r\n    } finally {\r\n        setSendingEmail(null);\r\n    }\r\n};\r\n\r\nconst stats = useMemo(() => {\r\n    if (!agents || !planning) return [];\r\n\r\n    const agentStats: Record<string, PayrollStats> = {};\r\n\r\n    // Initialize agents\r\n    agents.filter((a: Agent) => a.role !== 'admin').forEach((agent: Agent) => {\r\n        agentStats[agent.id] = {\r\n            agent,\r\n            totalPlanned: 0,\r\n            totalDone: 0,\r\n            nightHours: 0,\r\n            sundayHours: 0,\r\n            holidayHours: 0,\r\n            futureHours: 0\r\n        };\r\n    });\r\n\r\n    const now = moment();\r\n\r\n    planning.forEach((mission: Mission) => {\r\n        if (!mission.agentAssignments) return;\r\n\r\n        mission.agentAssignments.forEach((assignment: AgentAssignment) => {\r\n            const agentId = assignment.agentId;\r\n            if (!agentStats[agentId]) return;\r\n\r\n            assignment.vacations.forEach((vacation: Vacation) => {\r\n                const start = moment(`${vacation.date}T${vacation.start}`);\r\n                const end = moment(`${vacation.date}T${vacation.end}`);\r\n\r\n                // Handle overnight shifts (end is next day)\r\n                if (end.isBefore(start)) {\r\n                    end.add(1, 'day');\r\n                }\r\n\r\n                const isDone = end.isBefore(now);\r\n\r\n                // Use shared utility for rigorous calculation\r\n                const vacationStats = calculateVacationStats(start, end);\r\n\r\n                // For totalDone/Planned, we can use the stats.total from shared util\r\n                if (isDone) {\r\n                    agentStats[agentId].totalDone += vacationStats.total;\r\n                } else {\r\n                    agentStats[agentId].futureHours += vacationStats.total;\r\n                }\r\n                agentStats[agentId].totalPlanned += vacationStats.total;\r\n\r\n                // Details from shared util\r\n                agentStats[agentId].nightHours += vacationStats.night;\r\n                agentStats[agentId].sundayHours += vacationStats.sunday;\r\n                agentStats[agentId].holidayHours += vacationStats.holiday;\r\n            });\r\n        });\r\n    });\r\n\r\n    return Object.values(agentStats);\r\n}, [agents, planning]);\r\n\r\nif (loadingAgents || loadingPlanning) return <Loading />;\r\n\r\nreturn (\r\n    <Box>\r\n        <Title title=\"RH & Paie\" />\r\n\r\n        <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\" mb={3}>\r\n            <Typography variant=\"h4\" sx={{ color: '#1a1a1a', fontWeight: 'bold' }}>\r\n                Suivi des Heures Agents\r\n            </Typography>\r\n            <Button\r\n                variant=\"contained\"\r\n                startIcon={<DownloadIcon />}\r\n                onClick={() => alert(\"csv export todo\")}\r\n                sx={{ backgroundColor: '#CD1A20' }}\r\n            >\r\n                Export Global CSV\r\n            </Button>\r\n        </Box>\r\n\r\n        <Grid2 container spacing={3}>\r\n            {stats.map(({ agent, totalDone, futureHours, nightHours, sundayHours, holidayHours }: PayrollStats) => (\r\n                <Grid2 xs={12} md={6} lg={4} key={agent.id}>\r\n                    <Paper elevation={2} sx={{ p: 3, borderRadius: 2, height: '100%' }}>\r\n                        <Box display=\"flex\" alignItems=\"center\" mb={2}>\r\n                            <Avatar sx={{ bgcolor: '#CD1A20', mr: 2 }}>\r\n                                {agent.firstName?.[0]}{agent.lastName?.[0]}\r\n                            </Avatar>\r\n                            <Box>\r\n                                <Typography variant=\"h6\">\r\n                                    {agent.firstName} {agent.lastName}\r\n                                </Typography>\r\n                                <Typography variant=\"body2\" color=\"textSecondary\">\r\n                                    {agent.email}\r\n                                </Typography>\r\n                            </Box>\r\n                            <Chip\r\n                                label={agent.status === 'active' ? 'Actif' : 'Inactif'}\r\n                                color={agent.status === 'active' ? 'success' : 'default'}\r\n                                size=\"small\"\r\n                                sx={{ ml: 'auto' }}\r\n                            />\r\n                        </Box>\r\n\r\n                        <Divider sx={{ my: 2 }} />\r\n\r\n                        <Grid2 container spacing={2}>\r\n                            { /* Total & Done */}\r\n                            <Grid2 xs={6}>\r\n                                <Box sx={{ p: 1.5, bgcolor: '#f5f5f5', borderRadius: 1, textAlign: 'center' }}>\r\n                                    <Typography variant=\"caption\" color=\"textSecondary\">Effectuées</Typography>\r\n                                    <Typography variant=\"h5\" color=\"success.main\" fontWeight=\"bold\">\r\n                                        {totalDone.toFixed(1)}h\r\n                                    </Typography>\r\n                                </Box>\r\n                            </Grid2>\r\n                            <Grid2 xs={6}>\r\n                                <Box sx={{ p: 1.5, bgcolor: '#f5f5f5', borderRadius: 1, textAlign: 'center' }}>\r\n                                    <Typography variant=\"caption\" color=\"textSecondary\">Planifiées (Futur)</Typography>\r\n                                    <Typography variant=\"h5\" color=\"primary.main\" fontWeight=\"bold\">\r\n                                        {futureHours.toFixed(1)}h\r\n                                    </Typography>\r\n                                </Box>\r\n                            </Grid2>\r\n\r\n                            { /* Details */}\r\n                            <Grid2 xs={12}>\r\n                                <Typography variant=\"subtitle2\" sx={{ mt: 1, mb: 1, fontWeight: 'bold' }}>\r\n                                    Majorations & Détails\r\n                                </Typography>\r\n                            </Grid2>\r\n\r\n                            <Grid2 xs={4}>\r\n                                <Box display=\"flex\" flexDirection=\"column\" alignItems=\"center\">\r\n                                    <NightlightRoundIcon color=\"action\" fontSize=\"small\" />\r\n                                    <Typography variant=\"caption\" mt={0.5}>Nuit</Typography>\r\n                                    <Typography fontWeight=\"bold\">{nightHours.toFixed(1)}h</Typography>\r\n                                </Box>\r\n                            </Grid2>\r\n                            <Grid2 xs={4}>\r\n                                <Box display=\"flex\" flexDirection=\"column\" alignItems=\"center\">\r\n                                    <CalendarTodayIcon color=\"action\" fontSize=\"small\" />\r\n                                    <Typography variant=\"caption\" mt={0.5}>Dimanche</Typography>\r\n                                    <Typography fontWeight=\"bold\">{sundayHours.toFixed(1)}h</Typography>\r\n                                </Box>\r\n                            </Grid2>\r\n                            <Grid2 xs={4}>\r\n                                <Box display=\"flex\" flexDirection=\"column\" alignItems=\"center\">\r\n                                    <StarIcon color=\"action\" fontSize=\"small\" />\r\n                                    <Typography variant=\"caption\" mt={0.5}>Férié</Typography>\r\n                                    <Typography fontWeight=\"bold\">{holidayHours.toFixed(1)}h</Typography>\r\n                                </Box>\r\n                            </Grid2>\r\n\r\n                            <Grid2 xs={12} sx={{ mt: 2 }}>\r\n                                <Button\r\n                                    fullWidth\r\n                                    variant=\"outlined\"\r\n                                    color=\"primary\"\r\n                                    startIcon={sendingEmail === agent.id ? <CircularProgress size={20} /> : <EmailIcon />}\r\n                                    onClick={() => handleSendPlanning(agent.id)}\r\n                                    disabled={!!sendingEmail}\r\n                                >\r\n                                    {sendingEmail === agent.id ? \"Envoi...\" : \"Renvoyer Planning\"}\r\n                                </Button>\r\n                            </Grid2>\r\n                        </Grid2>\r\n                    </Paper>\r\n                </Grid2>\r\n            ))}\r\n        </Grid2>\r\n    </Box>\r\n);\r\n};\r\n\r\nexport default Payroll;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\pages\\Planning.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Calendar' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'momentLocalizer' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'withDragAndDrop' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":70,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":64,"fix":{"range":[2566,2569],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2566,2569],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2566,2569],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":73,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":65,"fix":{"range":[2691,2694],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2691,2694],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2691,2694],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":74,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":74,"endColumn":52,"fix":{"range":[2773,2776],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2773,2776],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2773,2776],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":121,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":56,"fix":{"range":[4236,4239],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4236,4239],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4236,4239],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":136,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":136,"endColumn":42,"fix":{"range":[4714,4717],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4714,4717],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4714,4717],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":143,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":143,"endColumn":69,"fix":{"range":[4977,4980],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4977,4980],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4977,4980],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":145,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":145,"endColumn":47,"fix":{"range":[5051,5054],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5051,5054],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5051,5054],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":151,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":151,"endColumn":42,"fix":{"range":[5211,5214],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5211,5214],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5211,5214],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":155,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":155,"endColumn":37,"fix":{"range":[5315,5318],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5315,5318],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5315,5318],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":155,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":155,"endColumn":53,"fix":{"range":[5331,5334],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5331,5334],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5331,5334],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":155,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":155,"endColumn":66,"fix":{"range":[5344,5347],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5344,5347],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5344,5347],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":184,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":184,"endColumn":47,"fix":{"range":[6291,6294],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6291,6294],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6291,6294],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":227,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":227,"endColumn":45,"fix":{"range":[8069,8072],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8069,8072],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8069,8072],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":244,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":244,"endColumn":67,"fix":{"range":[8864,8867],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8864,8867],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8864,8867],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":248,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":248,"endColumn":69,"fix":{"range":[9101,9104],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9101,9104],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9101,9104],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":250,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":250,"endColumn":60,"fix":{"range":[9249,9252],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9249,9252],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9249,9252],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":277,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":277,"endColumn":55,"fix":{"range":[10395,10398],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10395,10398],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10395,10398],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":292,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":292,"endColumn":28,"fix":{"range":[10919,10922],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10919,10922],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10919,10922],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":299,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":299,"endColumn":40,"fix":{"range":[11186,11189],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11186,11189],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11186,11189],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":304,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":304,"endColumn":65,"fix":{"range":[11383,11386],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11383,11386],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11383,11386],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":310,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":310,"endColumn":54,"fix":{"range":[11591,11594],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11591,11594],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11591,11594],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":329,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":329,"endColumn":40,"fix":{"range":[12240,12243],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12240,12243],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12240,12243],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":395,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":395,"endColumn":57,"fix":{"range":[15143,15146],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15143,15146],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15143,15146],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":397,"column":98,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":397,"endColumn":101,"fix":{"range":[15334,15337],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15334,15337],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15334,15337],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":403,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":403,"endColumn":69,"fix":{"range":[15648,15651],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15648,15651],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15648,15651],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":427,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":427,"endColumn":57,"fix":{"range":[17206,17209],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17206,17209],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17206,17209],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":430,"column":92,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":430,"endColumn":95,"fix":{"range":[17469,17472],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17469,17472],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17469,17472],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":431,"column":119,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":431,"endColumn":122,"fix":{"range":[17611,17614],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17611,17614],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17611,17614],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":453,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":453,"endColumn":57,"fix":{"range":[19096,19099],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19096,19099],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19096,19099],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":457,"column":86,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":457,"endColumn":89,"fix":{"range":[19347,19350],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19347,19350],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19347,19350],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":458,"column":108,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":458,"endColumn":111,"fix":{"range":[19465,19468],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19465,19468],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19465,19468],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":512,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":512,"endColumn":54,"fix":{"range":[22169,22172],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22169,22172],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22169,22172],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":562,"column":99,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":562,"endColumn":102,"fix":{"range":[25191,25194],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25191,25194],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25191,25194],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":36,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":33,"fixableWarningCount":0,"source":"import { useState, useCallback } from 'react';\r\nimport { Calendar, momentLocalizer, Views } from 'react-big-calendar';\r\nimport withDragAndDrop from 'react-big-calendar/lib/addons/dragAndDrop';\r\nimport moment from 'moment';\r\n// @ts-expect-error - moment locale files don't have TypeScript declarations\r\n\r\n// Custom formats for 24h time\r\ninterface FormatRange {\r\n    start: Date;\r\n    end: Date;\r\n}\r\n\r\nconst formats = {\r\n    timeGutterFormat: 'HH:mm',\r\n    eventTimeRangeFormat: ({ start, end }: FormatRange, culture: string, local: typeof moment) =>\r\n        `${local(start).format('HH:mm')} - ${local(end).format('HH:mm')}`,\r\n    agendaTimeRangeFormat: ({ start, end }: FormatRange, culture: string, local: typeof moment) =>\r\n        `${local(start).format('HH:mm')} - ${local(end).format('HH:mm')}`,\r\n    dayHeaderFormat: 'dddd DD MMMM'\r\n};\r\n\r\nconst Planning = () => {\r\n    const { data: events, isLoading } = useGetList('planning');\r\n    const { data: sites } = useGetList('sites');\r\n    const { data: agents } = useGetList('agents');\r\n    const [create] = useCreate();\r\n    const [update] = useUpdate();\r\n    const notify = useNotify();\r\n\r\n    // Dialog State\r\n    const [openDialog, setOpenDialog] = useState(false);\r\n    const [editMode, setEditMode] = useState(false);\r\n    const [selectedMissionId, setSelectedMissionId] = useState<string | null>(null);\r\n\r\n    // Form Data\r\n    const [missionData, setMissionData] = useState({\r\n        siteId: '',\r\n        notes: ''\r\n    });\r\n    const [agentAssignments, setAgentAssignments] = useState<AgentAssignment[]>([{\r\n        agentId: '',\r\n        agentName: '',\r\n        specialty: '',\r\n        vacations: [{\r\n            date: moment().format('YYYY-MM-DD'),\r\n            start: '08:00',\r\n            end: '16:00'\r\n        }]\r\n    }]);\r\n\r\n    const [tabValue, setTabValue] = useState(0);\r\n\r\n    const handleTabChange = (_event: React.SyntheticEvent, newValue: number) => {\r\n        setTabValue(newValue);\r\n    };\r\n\r\n    // Helper to calculate start and end dates handling cross-day shifts\r\n    const getEventRange = (date: string, startStr: string, endStr: string) => {\r\n        const start = new Date(`${date}T${startStr}`);\r\n        let end = new Date(`${date}T${endStr}`);\r\n\r\n        // If end time is earlier than start time, it means it ends the next day\r\n        if (end < start) {\r\n            end = new Date(end.getTime() + 24 * 60 * 60 * 1000);\r\n        }\r\n        return { start, end };\r\n    };\r\n\r\n    // Transform missions to calendar events\r\n    const calendarEvents = (events || []).flatMap((mission: any) => {\r\n        if (!mission.agentAssignments) return [];\r\n\r\n        return mission.agentAssignments.flatMap((assignment: any, assignmentIdx: number) => {\r\n            return assignment.vacations.map((v: any, vacIdx: number) => {\r\n                const { start, end } = getEventRange(v.date, v.start, v.end);\r\n                return {\r\n                    id: `${mission.id}-${assignmentIdx}-${vacIdx}`,\r\n                    missionId: mission.id,\r\n                    start,\r\n                    end,\r\n                    title: `${mission.siteName} - ${assignment.agentName} (${assignment.specialty})`,\r\n                    resource: { mission, assignment, vacation: v }\r\n                };\r\n            });\r\n        });\r\n    });\r\n\r\n    const onEventResize = useCallback(\r\n        () => {\r\n            notify('Modification via drag non implémentée pour le nouveau modèle', { type: 'info' });\r\n        },\r\n        [notify]\r\n    );\r\n\r\n    const onEventDrop = useCallback(\r\n        () => {\r\n            notify('Modification via drag non implémentée pour le nouveau modèle', { type: 'info' });\r\n        },\r\n        [notify]\r\n    );\r\n\r\n    const resetForm = () => {\r\n        setMissionData({\r\n            siteId: '',\r\n            notes: ''\r\n        });\r\n        setAgentAssignments([{\r\n            agentId: '',\r\n            agentName: '',\r\n            specialty: '',\r\n            vacations: [{\r\n                date: moment().format('YYYY-MM-DD'),\r\n                start: '08:00',\r\n                end: '16:00'\r\n            }]\r\n        }]);\r\n        setEditMode(false);\r\n        setSelectedMissionId(null);\r\n    };\r\n\r\n    const handleSelectSlot = useCallback((slotInfo: any) => {\r\n        resetForm();\r\n        setAgentAssignments([{\r\n            agentId: '',\r\n            agentName: '',\r\n            specialty: '',\r\n            vacations: [{\r\n                date: moment(slotInfo.start).format('YYYY-MM-DD'),\r\n                start: moment(slotInfo.start).format('HH:mm'),\r\n                end: moment(slotInfo.end).format('HH:mm')\r\n            }]\r\n        }]);\r\n        setOpenDialog(true);\r\n    }, []);\r\n\r\n    const handleEditClick = (mission: any) => {\r\n        setEditMode(true);\r\n        setSelectedMissionId(mission.id);\r\n        setMissionData({\r\n            siteId: mission.siteId,\r\n            notes: mission.notes || ''\r\n        });\r\n        const assignmentsCopy = mission.agentAssignments.map((a: any) => ({\r\n            ...a,\r\n            vacations: a.vacations.map((v: any) => ({ ...v }))\r\n        }));\r\n        setAgentAssignments(assignmentsCopy);\r\n        setOpenDialog(true);\r\n    };\r\n\r\n    const handleSelectEvent = (event: any) => {\r\n        handleEditClick(event.resource.mission);\r\n    };\r\n\r\n    const handleRowClick = (_id: any, _resource: any, record: any): false => {\r\n        handleEditClick(record);\r\n        return false;\r\n    };\r\n\r\n    const handleCloseDialog = () => {\r\n        setOpenDialog(false);\r\n        resetForm();\r\n    };\r\n\r\n    const handleAddAgent = () => {\r\n        const lastAssignment = agentAssignments[agentAssignments.length - 1];\r\n        setAgentAssignments([...agentAssignments, {\r\n            agentId: '',\r\n            agentName: '',\r\n            specialty: '',\r\n            vacations: lastAssignment.vacations.map(v => ({ ...v }))\r\n        }]);\r\n    };\r\n\r\n    const handleRemoveAgent = (index: number) => {\r\n        if (agentAssignments.length > 1) {\r\n            setAgentAssignments(agentAssignments.filter((_, i) => i !== index));\r\n        }\r\n    };\r\n\r\n    const handleAgentChange = (assignmentIdx: number, field: string, value: string) => {\r\n        const updated = [...agentAssignments];\r\n        if (field === 'agentId') {\r\n            const agent = agents?.find((a: any) => a.id === value);\r\n            updated[assignmentIdx] = {\r\n                ...updated[assignmentIdx],\r\n                agentId: value,\r\n                agentName: agent ? `${agent.firstName} ${agent.lastName}` : ''\r\n            };\r\n        } else {\r\n            updated[assignmentIdx] = { ...updated[assignmentIdx], [field]: value };\r\n        }\r\n        setAgentAssignments(updated);\r\n    };\r\n\r\n    const handleAddVacation = (assignmentIdx: number) => {\r\n        const updated = [...agentAssignments];\r\n        const lastVacation = updated[assignmentIdx].vacations[updated[assignmentIdx].vacations.length - 1];\r\n        const nextDate = moment(lastVacation.date).add(1, 'day').format('YYYY-MM-DD');\r\n        updated[assignmentIdx].vacations.push({\r\n            date: nextDate,\r\n            start: lastVacation.start,\r\n            end: lastVacation.end\r\n        });\r\n        setAgentAssignments(updated);\r\n    };\r\n\r\n    const handleRemoveVacation = (assignmentIdx: number, vacationIdx: number) => {\r\n        const updated = [...agentAssignments];\r\n        if (updated[assignmentIdx].vacations.length > 1) {\r\n            updated[assignmentIdx].vacations = updated[assignmentIdx].vacations.filter((_, i) => i !== vacationIdx);\r\n            setAgentAssignments(updated);\r\n        }\r\n    };\r\n\r\n    const handleVacationChange = (assignmentIdx: number, vacationIdx: number, field: keyof Vacation, value: string) => {\r\n        const updated = [...agentAssignments];\r\n        updated[assignmentIdx].vacations[vacationIdx] = {\r\n            ...updated[assignmentIdx].vacations[vacationIdx],\r\n            [field]: value\r\n        };\r\n        setAgentAssignments(updated);\r\n    };\r\n\r\n    const handleSaveMission = async () => {\r\n        try {\r\n            const site = sites?.find((s: any) => s.id === missionData.siteId);\r\n            if (!site) {\r\n                notify('Site introuvable', { type: 'error' });\r\n                return;\r\n            }\r\n\r\n            for (const assignment of agentAssignments) {\r\n                if (!assignment.agentId || !assignment.specialty) {\r\n                    notify('Tous les agents doivent être sélectionnés avec une spécialité', { type: 'error' });\r\n                    return;\r\n                }\r\n            }\r\n\r\n            for (const assignment of agentAssignments) {\r\n                for (const vacation of assignment.vacations) {\r\n                    const { start: vacationStart, end: vacationEnd } = getEventRange(vacation.date, vacation.start, vacation.end);\r\n\r\n                    const hasConflict = events?.some((mission: any) => {\r\n                        if (editMode && mission.id === selectedMissionId) return false;\r\n\r\n                        if (!mission.agentAssignments) return false;\r\n                        return mission.agentAssignments.some((a: any) => {\r\n                            if (a.agentId !== assignment.agentId) return false;\r\n                            return a.vacations.some((v: any) => {\r\n                                const { start: eventStart, end: eventEnd } = getEventRange(v.date, v.start, v.end);\r\n                                return (vacationStart < eventEnd && vacationEnd > eventStart);\r\n                            });\r\n                        });\r\n                    });\r\n\r\n                    if (hasConflict) {\r\n                        notify(`Conflit détecté pour ${assignment.agentName} le ${vacation.date}`, { type: 'warning' });\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n\r\n            const payloadData = {\r\n                siteId: missionData.siteId,\r\n                siteName: site.name,\r\n                agentAssignments: agentAssignments,\r\n                assignedAgentIds: agentAssignments.map(a => a.agentId),\r\n                notes: missionData.notes || '',\r\n                updatedAt: new Date()\r\n            };\r\n\r\n            if (editMode && selectedMissionId) {\r\n                await update('planning', {\r\n                    id: selectedMissionId,\r\n                    data: payloadData,\r\n                    previousData: events?.find((e: any) => e.id === selectedMissionId)\r\n                });\r\n                notify('Mission mise à jour avec succès !');\r\n            } else {\r\n                await create('planning', {\r\n                    data: {\r\n                        ...payloadData,\r\n                        status: 'scheduled',\r\n                        createdAt: new Date()\r\n                    }\r\n                });\r\n                notify('Mission créée avec succès !');\r\n            }\r\n\r\n            handleCloseDialog();\r\n        } catch (error: any) {\r\n            notify(`Erreur: ${error.message}`, { type: 'error' });\r\n        }\r\n    };\r\n\r\n    const getAgentsForAssignment = (specialty: string | null) => {\r\n        if (!missionData.siteId || !sites || !agents) return [];\r\n        const site = sites.find((s: any) => s.id === missionData.siteId);\r\n\r\n        let potentialAgents = agents;\r\n\r\n        if (site?.requiredSpecialties?.length > 0) {\r\n            potentialAgents = potentialAgents.filter((agent: any) =>\r\n                agent.specialties?.some((s: string) => site.requiredSpecialties.includes(s))\r\n            );\r\n        }\r\n\r\n        if (specialty) {\r\n            return potentialAgents.filter((agent: any) =>\r\n                agent.specialties?.includes(specialty)\r\n            );\r\n        }\r\n\r\n        return potentialAgents;\r\n    };\r\n\r\n    const getApplicableSpecialties = () => {\r\n        const allSpecialties = [\r\n            { id: 'ADS', name: 'Agent de Sécurité (ADS)' },\r\n            { id: 'SSIAP1', name: 'SSIAP 1' },\r\n            { id: 'SSIAP2', name: 'SSIAP 2' },\r\n            { id: 'CYNO', name: 'Agent Cynophile' },\r\n            { id: 'RONDIER', name: 'Rondier' },\r\n            { id: 'VIDEO', name: 'Opérateur Vidéo' },\r\n        ];\r\n\r\n        if (!missionData.siteId || !sites) return allSpecialties;\r\n        const site = sites.find((s: any) => s.id === missionData.siteId);\r\n\r\n        if (site?.requiredSpecialties?.length > 0) {\r\n            return allSpecialties.filter(s => site.requiredSpecialties.includes(s.id));\r\n        }\r\n\r\n        return allSpecialties;\r\n    };\r\n\r\n    if (isLoading) return <Loading />;\r\n\r\n    return (\r\n        <Card>\r\n            <Title title=\"Planning Mo'Cyno\" />\r\n            <CardHeader\r\n                title=\"Gestion des Missions\"\r\n                action={\r\n                    <Button variant=\"contained\" color=\"primary\" onClick={() => { resetForm(); setOpenDialog(true); }}>\r\n                        Créer une Mission\r\n                    </Button>\r\n                }\r\n            />\r\n            <CardContent>\r\n                <Box sx={{ borderBottom: 1, borderColor: 'divider', mb: 2 }}>\r\n                    <Tabs value={tabValue} onChange={handleTabChange} aria-label=\"planning views\">\r\n                        <Tab label=\"Vue Calendrier\" />\r\n                        <Tab label=\"Liste des Missions\" />\r\n                    </Tabs>\r\n                </Box>\r\n\r\n                <div role=\"tabpanel\" hidden={tabValue !== 0}>\r\n                    {tabValue === 0 && (\r\n                        <div style={{ height: '80vh' }}>\r\n                            <DnDCalendar\r\n                                defaultView={Views.WEEK}\r\n                                events={calendarEvents}\r\n                                localizer={localizer}\r\n                                formats={formats}\r\n                                onEventDrop={onEventDrop}\r\n                                onEventResize={onEventResize}\r\n                                onSelectSlot={handleSelectSlot}\r\n                                onSelectEvent={handleSelectEvent}\r\n                                selectable\r\n                                resizable\r\n                                style={{ height: '100%' }}\r\n                                messages={{\r\n                                    next: \"Suivant\",\r\n                                    previous: \"Précédent\",\r\n                                    today: \"Aujourd'hui\",\r\n                                    month: \"Mois\",\r\n                                    week: \"Semaine\",\r\n                                    day: \"Jour\"\r\n                                }}\r\n                            />\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <div role=\"tabpanel\" hidden={tabValue !== 1}>\r\n                    {tabValue === 1 && (\r\n                        <List actions={false} title=\" \">\r\n                            <Datagrid bulkActionButtons={false} rowClick={handleRowClick}>\r\n                                <RaTextField source=\"siteName\" label=\"Site\" />\r\n\r\n                                <FunctionField\r\n                                    label=\"Période\"\r\n                                    render={(record: any) => {\r\n                                        if (!record.agentAssignments) return '-';\r\n                                        const allVacations = record.agentAssignments.flatMap((a: any) => a.vacations);\r\n                                        if (allVacations.length === 0) return '-';\r\n\r\n                                        const starts: number[] = [];\r\n                                        const ends: number[] = [];\r\n\r\n                                        allVacations.forEach((v: any) => {\r\n                                            const { start, end } = getEventRange(v.date, v.start, v.end);\r\n                                            starts.push(start.getTime());\r\n                                            ends.push(end.getTime());\r\n                                        });\r\n\r\n                                        const minStart = new Date(Math.min(...starts));\r\n                                        const maxEnd = new Date(Math.max(...ends));\r\n\r\n                                        return (\r\n                                            <Box>\r\n                                                <Typography variant=\"body2\" component=\"div\">\r\n                                                    Du {minStart.toLocaleDateString()} {minStart.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                                                </Typography>\r\n                                                <Typography variant=\"body2\" component=\"div\">\r\n                                                    Au {maxEnd.toLocaleDateString()} {maxEnd.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                                                </Typography>\r\n                                            </Box>\r\n                                        );\r\n                                    }}\r\n                                />\r\n\r\n                                <FunctionField\r\n                                    label=\"Agents & Heures\"\r\n                                    render={(record: any) => {\r\n                                        return (\r\n                                            <Box sx={{ display: 'flex', flexDirection: 'column', gap: 0.5 }}>\r\n                                                {record.agentAssignments?.map((assignment: any, idx: number) => {\r\n                                                    const totalMinutes = assignment.vacations.reduce((acc: number, v: any) => {\r\n                                                        const { start, end } = getEventRange(v.date, v.start, v.end);\r\n                                                        const duration = (end.getTime() - start.getTime()) / (1000 * 60);\r\n                                                        return acc + duration;\r\n                                                    }, 0);\r\n                                                    const hours = Math.floor(totalMinutes / 60);\r\n                                                    const mins = totalMinutes % 60;\r\n                                                    const timeStr = mins > 0 ? `${hours}h${mins}` : `${hours}h`;\r\n\r\n                                                    return (\r\n                                                        <Typography key={idx} variant=\"body2\" noWrap>\r\n                                                            • <strong>{assignment.agentName}</strong>: {timeStr}\r\n                                                        </Typography>\r\n                                                    );\r\n                                                })}\r\n                                            </Box>\r\n                                        );\r\n                                    }}\r\n                                />\r\n\r\n                                <FunctionField\r\n                                    label=\"Total Mission\"\r\n                                    render={(record: any) => {\r\n                                        if (!record.agentAssignments) return '-';\r\n                                        let totalMinutesMission = 0;\r\n\r\n                                        record.agentAssignments.forEach((assignment: any) => {\r\n                                            const agentMins = assignment.vacations.reduce((acc: number, v: any) => {\r\n                                                const { start, end } = getEventRange(v.date, v.start, v.end);\r\n                                                const duration = (end.getTime() - start.getTime()) / (1000 * 60);\r\n                                                return acc + duration;\r\n                                            }, 0);\r\n                                            totalMinutesMission += agentMins;\r\n                                        });\r\n\r\n                                        const hours = Math.floor(totalMinutesMission / 60);\r\n                                        const mins = totalMinutesMission % 60;\r\n\r\n                                        return (\r\n                                            <Typography variant=\"body1\" fontWeight=\"bold\">\r\n                                                {mins > 0 ? `${hours}h${mins}` : `${hours}h`}\r\n                                            </Typography>\r\n                                        );\r\n                                    }}\r\n                                />\r\n\r\n                                <RaTextField source=\"notes\" label=\"Notes\" />\r\n                                <DeleteButton />\r\n                            </Datagrid>\r\n                        </List>\r\n                    )}\r\n                </div>\r\n\r\n            </CardContent>\r\n\r\n            <Dialog open={openDialog} onClose={handleCloseDialog} maxWidth=\"lg\" fullWidth>\r\n                <DialogTitle>{editMode ? 'Modifier la Mission' : 'Créer une Mission Multi-Agents'}</DialogTitle>\r\n                <DialogContent>\r\n                    <TextField\r\n                        select\r\n                        label=\"Site\"\r\n                        value={missionData.siteId}\r\n                        onChange={(e) => {\r\n                            setMissionData({ ...missionData, siteId: e.target.value });\r\n                            if (!editMode) {\r\n                                setAgentAssignments([{\r\n                                    agentId: '',\r\n                                    agentName: '',\r\n                                    specialty: '',\r\n                                    vacations: [{\r\n                                        date: moment().format('YYYY-MM-DD'),\r\n                                        start: '08:00',\r\n                                        end: '16:00'\r\n                                    }]\r\n                                }]);\r\n                            }\r\n                        }}\r\n                        fullWidth\r\n                        margin=\"normal\"\r\n                        required\r\n                    >\r\n                        {(sites || []).map((site: any) => (\r\n                            <MenuItem key={site.id} value={site.id}>\r\n                                {site.name}\r\n                            </MenuItem>\r\n                        ))}\r\n                    </TextField>\r\n\r\n                    <Box sx={{ mt: 3 }}>\r\n                        <Typography variant=\"h6\" gutterBottom>\r\n                            Agents Affectés\r\n                            <IconButton color=\"primary\" onClick={handleAddAgent} size=\"small\" sx={{ ml: 1 }}>\r\n                                <PersonAddIcon />\r\n                            </IconButton>\r\n                        </Typography>\r\n\r\n                        {agentAssignments.map((assignment, assignmentIdx) => (\r\n                            <Box key={assignmentIdx} sx={{ mb: 3, p: 2, border: '1px solid #ddd', borderRadius: 1 }}>\r\n                                <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\r\n                                    <Typography variant=\"subtitle1\">Agent {assignmentIdx + 1}</Typography>\r\n                                    {agentAssignments.length > 1 && (\r\n                                        <IconButton color=\"error\" onClick={() => handleRemoveAgent(assignmentIdx)} size=\"small\">\r\n                                            <DeleteIcon />\r\n                                        </IconButton>\r\n                                    )}\r\n                                </Box>\r\n\r\n                                <Box sx={{ display: 'flex', gap: 2, mb: 2 }}>\r\n                                    <TextField\r\n                                        select\r\n                                        label=\"Spécialité\"\r\n                                        value={assignment.specialty}\r\n                                        onChange={(e) => handleAgentChange(assignmentIdx, 'specialty', e.target.value)}\r\n                                        fullWidth\r\n                                        required\r\n                                        disabled={!missionData.siteId}\r\n                                    >\r\n                                        {getApplicableSpecialties().map(s => (\r\n                                            <MenuItem key={s.id} value={s.id}>{s.name}</MenuItem>\r\n                                        ))}\r\n                                    </TextField>\r\n\r\n                                    <TextField\r\n                                        select\r\n                                        label=\"Agent\"\r\n                                        value={assignment.agentId}\r\n                                        onChange={(e) => handleAgentChange(assignmentIdx, 'agentId', e.target.value)}\r\n                                        fullWidth\r\n                                        required\r\n                                        disabled={!missionData.siteId}\r\n                                    >\r\n                                        {getAgentsForAssignment(assignment.specialty).map((agent: any) => (\r\n                                            <MenuItem key={agent.id} value={agent.id}>\r\n                                                {agent.firstName} {agent.lastName} ({agent.specialties?.join(', ') || 'N/A'})\r\n                                            </MenuItem>\r\n                                        ))}\r\n                                    </TextField>\r\n                                </Box>\r\n\r\n                                <Typography variant=\"subtitle2\" sx={{ mt: 2, mb: 1 }}>\r\n                                    Vacations\r\n                                    <IconButton color=\"primary\" onClick={() => handleAddVacation(assignmentIdx)} size=\"small\">\r\n                                        <AddIcon />\r\n                                    </IconButton>\r\n                                </Typography>\r\n\r\n                                {assignment.vacations.map((vacation, vacationIdx) => (\r\n                                    <Box key={vacationIdx} sx={{ display: 'flex', gap: 1, mb: 1, alignItems: 'center' }}>\r\n                                        <TextField\r\n                                            label=\"Date\"\r\n                                            type=\"date\"\r\n                                            value={vacation.date}\r\n                                            onChange={(e) => handleVacationChange(assignmentIdx, vacationIdx, 'date', e.target.value)}\r\n                                            InputLabelProps={{ shrink: true }}\r\n                                            size=\"small\"\r\n                                            required\r\n                                        />\r\n                                        <TextField\r\n                                            label=\"Début\"\r\n                                            type=\"time\"\r\n                                            value={vacation.start}\r\n                                            onChange={(e) => handleVacationChange(assignmentIdx, vacationIdx, 'start', e.target.value)}\r\n                                            InputLabelProps={{ shrink: true }}\r\n                                            size=\"small\"\r\n                                            required\r\n                                        />\r\n                                        <TextField\r\n                                            label=\"Fin\"\r\n                                            type=\"time\"\r\n                                            value={vacation.end}\r\n                                            onChange={(e) => handleVacationChange(assignmentIdx, vacationIdx, 'end', e.target.value)}\r\n                                            InputLabelProps={{ shrink: true }}\r\n                                            size=\"small\"\r\n                                            required\r\n                                        />\r\n                                        {assignment.vacations.length > 1 && (\r\n                                            <IconButton\r\n                                                color=\"error\"\r\n                                                onClick={() => handleRemoveVacation(assignmentIdx, vacationIdx)}\r\n                                                size=\"small\"\r\n                                            >\r\n                                                <DeleteIcon fontSize=\"small\" />\r\n                                            </IconButton>\r\n                                        )}\r\n                                    </Box>\r\n                                ))}\r\n                            </Box>\r\n                        ))}\r\n                    </Box>\r\n\r\n                    <TextField\r\n                        label=\"Notes / Instructions Générales\"\r\n                        value={missionData.notes}\r\n                        onChange={(e) => setMissionData({ ...missionData, notes: e.target.value })}\r\n                        fullWidth\r\n                        margin=\"normal\"\r\n                        multiline\r\n                        rows={3}\r\n                    />\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={handleCloseDialog}>Annuler</Button>\r\n                    <Button onClick={handleSaveMission} variant=\"contained\" color=\"primary\">\r\n                        {editMode ? 'Mettre à jour' : 'Créer Mission'}\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        </Card>\r\n    );\r\n};\r\n\r\nexport default Planning;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\pages\\Profile.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":32,"fix":{"range":[1147,1150],"text":"unknown"},"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1147,1150],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1147,1150],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { Card, CardContent, CardHeader, Button, TextField } from '@mui/material';\r\nimport { Title, useNotify } from 'react-admin';\r\nimport { auth } from '../firebase';\r\nimport { updatePassword } from 'firebase/auth';\r\n\r\nconst Profile = () => {\r\n    const [password, setPassword] = useState('');\r\n    const [confirm, setConfirm] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n    const notify = useNotify();\r\n\r\n    const handleSubmit = async () => {\r\n        if (password !== confirm) {\r\n            notify(\"Les mots de passe ne correspondent pas\", { type: 'warning' });\r\n            return;\r\n        }\r\n        if (password.length < 6) {\r\n            notify(\"Le mot de passe doit faire au moins 6 caractères\", { type: 'warning' });\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        const user = auth.currentUser;\r\n\r\n        if (user) {\r\n            try {\r\n                await updatePassword(user, password);\r\n                notify(\"Mot de passe mis à jour avec succès\");\r\n                setPassword('');\r\n                setConfirm('');\r\n            } catch (error: any) {\r\n                notify(\"Erreur: \" + error.message, { type: 'error' });\r\n            }\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    return (\r\n        <Card>\r\n            <Title title=\"Mon Profil\" />\r\n            <CardHeader title=\"Gestion du Compte Admin\" />\r\n            <CardContent>\r\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem', maxWidth: '400px' }}>\r\n                    <h3>Changer mon mot de passe</h3>\r\n                    <TextField\r\n                        label=\"Nouveau mot de passe\"\r\n                        type=\"password\"\r\n                        value={password}\r\n                        onChange={e => setPassword(e.target.value)}\r\n                    />\r\n                    <TextField\r\n                        label=\"Confirmer mot de passe\"\r\n                        type=\"password\"\r\n                        value={confirm}\r\n                        onChange={e => setConfirm(e.target.value)}\r\n                    />\r\n                    <Button\r\n                        variant=\"contained\"\r\n                        color=\"primary\"\r\n                        onClick={handleSubmit}\r\n                        disabled={loading}\r\n                    >\r\n                        {loading ? \"Mise à jour...\" : \"Mettre à jour\"}\r\n                    </Button>\r\n                </div>\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n};\r\n\r\nexport default Profile;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\pages\\Sites.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: JSX expressions must have one parent element.","line":1,"column":12}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"            <TextField source=\"clientContact\" label=\"Contact Client\" />\r\n            <FunctionField label=\"Spécialités Requises\" render={(record: Site) => record.requiredSpecialties ? record.requiredSpecialties.join(', ') : ''} />\r\n            <DeleteButton />\r\n        </Datagrid >\r\n    </List >\r\n);\r\n\r\nconst SiteForm = () => (\r\n    <SimpleForm sanitizeEmptyValues>\r\n        <TextInput source=\"name\" label=\"Nom du Site\" validate={required()} fullWidth />\r\n        <TextInput source=\"address\" label=\"Adresse (pour GPS)\" fullWidth />\r\n        <TextInput source=\"clientContact\" label=\"Nom du Contact / Téléphone\" fullWidth />\r\n        <TextInput source=\"email\" label=\"Email de contact\" type=\"email\" fullWidth />\r\n\r\n        <SelectArrayInput source=\"requiredSpecialties\" label=\"Spécialités Requises sur site\" choices={[\r\n            { id: 'ADS', name: 'Agent de Sécurité (ADS)' },\r\n            { id: 'SSIAP1', name: 'SSIAP 1' },\r\n            { id: 'SSIAP2', name: 'SSIAP 2' },\r\n            { id: 'CYNO', name: 'Agent Cynophile' },\r\n            { id: 'RONDIER', name: 'Rondier' },\r\n        ]} fullWidth />\r\n\r\n        <TextInput source=\"notes\" label=\"Notes internes\" multiline fullWidth />\r\n    </SimpleForm>\r\n);\r\n\r\nexport const SiteCreate = () => (\r\n    <Create title=\"Nouveau Site Client\">\r\n        <SiteForm />\r\n    </Create>\r\n);\r\n\r\nexport const SiteEdit = () => (\r\n    <Edit title=\"Modifier Site\">\r\n        <SiteForm />\r\n    </Edit>\r\n);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\theme.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\types\\models.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\utils\\imageUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\utils\\planningUtils.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\src\\utils\\planningUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abdel\\Desktop\\Mocyno3\\mocyno2\\admin\\vitest.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]